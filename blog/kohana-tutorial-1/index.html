<!DOCTYPE html>
<html prefix="
og: https://ogp.me/ns#
article: https://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="max-age=43200">
<meta http-equiv="ETag" content="b'2864e0750e0914fb7ea57f1000e152d2d49eb37b'">
<title>Kohana: Tutorial 1 | MagMax Blog</title>
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="/assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="/assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/magmax">
<link rel="canonical" href="http://magmax.org/blog/kohana-tutorial-1/">
<link rel="icon" href="/favicon_330.png" sizes="330x330">
<link rel="icon" href="/favicon.png" sizes="128x128">
<link rel="icon" href="/favicon.ico" sizes="16x16">
<meta name="author" content="Miguel Ángel García">
<link rel="prev" href="/blog/critica-drupal/" title="Crítica a Drupal" type="text/html">
<link rel="next" href="/blog/modulo-kohana/" title="Módulo Kohana" type="text/html">
<meta property="og:site_name" content="MagMax Blog">
<meta property="og:title" content="Kohana: Tutorial 1">
<meta property="og:url" content="http://magmax.org/blog/kohana-tutorial-1/">
<meta property="og:description" content='Con este artículo comienzo una serie de tutoriales de Kohana.
Kohana es un Framework PHP, es decir: un entorno de trabajo "prefabricado" que ya nos soluciona algunos de los problemas más típicos de la'>
<meta property="og:type" content="article">
<meta property="article:author" content="Miguel Ángel García">
<meta property="article:published_time" content="2010-12-09T00:00:00+00:00">
<meta property="article:updated" content="2010-12-09T00:00:00">
<meta property="article:tag" content="kohana">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@magmax_en">
<meta name="twitter:creator" content="@magmax">
<meta name="twitter:title" content="MagMax Blog">
<meta name="twitter:description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ...">
<meta name="twitter:url" content="http://magmax.org//blog/kohana-tutorial-1/">
<meta name="twitter:image" content="http://magmax.org/favicon.png">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://magmax.org/">

        <span id="blog-title">MagMax Blog</span>
      </a>
    </div>
<!-- /.navbar-header -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav">
<li>
<a href="/">Inicio</a>
                </li>
<li>
<a href="/archive.html">Archivo</a>
                </li>
<li>
<a href="/categories">Categorías</a>
                </li>
<li>
<a href="/projects">Proyectos</a>
                </li>
<li>
<a href="/news">Posts Externos</a>

        
      </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
<form class="navbar-form navbar-left" role="search" action="http://google.com/search" method="get">
<div class="form-group">
<input type="hidden" name="sitesearch" value="magmax.org"><input type="text" name="q" class="form-control" placeholder="Search / Buscar">
</div>
</form>
</li>

        <li style="margin-left:0">
          <a href="http://feeds.feedburner.com/magmax">
            <img src="/assets/images/rss.png" style="width:22px;height:22px"></a>
        </li>

        
      </ul>
</div>
<!-- /.navbar-collapse -->
  </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
  <div class="body-content">
    <div class="row">
      <div class="page-content col-md-9">
        
        <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="https://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="/blog/kohana-tutorial-1/" class="u-url">Kohana: Tutorial 1</a></h1>
            <div class="metadata text-muted">
              <i class="glyphicon glyphicon-calendar"></i>
              <p class="dateline">
                <time class="published dt-published" datetime="2010-12-09T00:00:00+00:00" title="2010-12-09">2010-12-09</time>
                // <time class="updated dt-updated" datetime="2010-12-09T00:00:00" title="2010-12-09">2010-12-09</time></p>
              <p class="commentline">            <a href="/blog/kohana-tutorial-1/#disqus_thread" data-disqus-identifier="cache/posts/kohana-tutorial-1.html">Comments</a>

</p>
              <address class="vcard author"><a class="url fn" href="https://magmax.org">Miguel Ángel García</a></address>
            </div>
            <br></header><div class="e-content entry-content" itemprop="articleBody text">
            <div>
<p>Con este artículo comienzo una serie de tutoriales de Kohana.</p>
<p>Kohana es un Framework PHP, es decir: un entorno de trabajo "prefabricado" que ya nos soluciona algunos de los problemas más típicos de la programación.</p>
<p>Como me gusta avanzar programando, programaremos desde la primera línea. Para ello vamos a tener como objetivo la creación de un "ToDoList Manager", es decir: vamos a crear una web que nos permita gestionar tareas.</p>
<p>En el ejemplo se accederá a base de datos. Debo decir que me ha costado mucho encontrar ejemplos válidos que accedan a base de datos.</p>
<!-- TEASER_END -->
<div class="section" id="prerrequisitos">
<h2>Prerrequisitos</h2>
<p>Voy a utilizar Kohana versión 3.0.8. Seguramente sea compatible con las siguientes.</p>
</div>
<div class="section" id="un-poquito-de-teoria">
<h2>Un poquito de teoría</h2>
<p>Kohana sigue un patrón Modelo-Vista-Controlador (MVC). Hay mucho escrito sobre este patrón, por lo que no me extenderé demasiado:</p>
<ul class="simple">
<li>Modelo: Los datos tal cual se guardan.</li>
<li>Vista: La representación en la pantalla.</li>
<li>Controlador: La lógica de negocio.</li>
</ul>
</div>
<div class="section" id="configuracion">
<h2>Configuración</h2>
<p>Vamos a configurar Kohana. Hemos desplegado el framework y vamos al fichero <code>application/bootstrap.php</code>, en el que vamos a habilitar algunas cosas. No podéis copiar a ciegas; aquí sólo os doy un ejemplo de lo que tengo yo puesto. Tened también en cuenta que no lo pego entero, ya que nos valen la mayor parte de los valores por defecto:</p>
<pre class="code php"><a name="rest_code_fe14468a799a407fbdc290a72d393102-1"></a><span class="cp">&lt;?php</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-2"></a><span class="nx">Kohana</span><span class="o">::</span><span class="na">init</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-3"></a>  <span class="s1">'base_url'</span>   <span class="o">=&gt;</span> <span class="s1">'/~miguel/kohana'</span><span class="p">,</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-4"></a>  <span class="s1">'index_file'</span> <span class="o">=&gt;</span> <span class="s1">'index.php'</span><span class="p">,</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-5"></a><span class="p">));</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-6"></a>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-7"></a><span class="nx">Kohana</span><span class="o">::</span><span class="na">modules</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-8"></a>  <span class="s1">'database'</span>   <span class="o">=&gt;</span> <span class="nx">MODPATH</span><span class="o">.</span><span class="s1">'database'</span><span class="p">,</span>   <span class="c1">// Database access</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-9"></a>  <span class="s1">'orm'</span>        <span class="o">=&gt;</span> <span class="nx">MODPATH</span><span class="o">.</span><span class="s1">'orm'</span><span class="p">,</span>        <span class="c1">// Object Relationship Mapping</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-10"></a>  <span class="p">));</span>
<a name="rest_code_fe14468a799a407fbdc290a72d393102-11"></a><span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>Como es sencillo, voy rápido: Le decimos a Kohana dónde está nuestra aplicación y cuál es el archivo que va a renderizar las cosas. Como véis, yo lo tengo en <em>'/~miguel/kohana'</em>. Después habilitamos algunos módulos, que servirán para acceder a base de datos.</p>
<p>Si sois tan pijos como yo y os gustan las URL's limpias, mejor si indicáis el "index_file" de la manera que se indica arriba y después creáis un <code>.htaccess</code> como el siguiente:</p>
<pre class="code text"><a name="rest_code_a215420bd352429e898841bbfb2bfbfc-1"></a># Turn on URL rewriting
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-2"></a>RewriteEngine On
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-3"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-4"></a># Installation directory
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-5"></a>RewriteBase /~miguel/kohana/
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-6"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-7"></a># Protect hidden files from being viewed
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-8"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-9"></a>  Order Deny,Allow
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-10"></a>  Deny From All
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-11"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-12"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-13"></a># Protect application and system files from being viewed
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-14"></a>RewriteRule ^(?:application|modules|system)\\b.* index.php/$0 [L]
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-15"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-16"></a># Allow any files or directories that exist to be displayed directly
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-17"></a>RewriteCond %{REQUEST_FILENAME} !-f
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-18"></a>RewriteCond %{REQUEST_FILENAME} !-d
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-19"></a>
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-20"></a># Rewrite all other URLs to index.php/URL
<a name="rest_code_a215420bd352429e898841bbfb2bfbfc-21"></a>RewriteRule .* index.php/$0 [PT]
</pre>
<p>Finalmente, configuramos la base de datos en el archivo <code>modules/database/config/database.php</code>. Ya tenéis un patrón y es autoexplicativo. Centraros en 'default' y olvidaros de 'alternate' (o borradlo si queréis).</p>
</div>
<div class="section" id="el-modelo">
<h2>El modelo</h2>
<p>El modelo es lo que existe en la base de datos, básicamente. Así que comenzamos por crear una base de datos:</p>
<pre class="code sql"><a name="rest_code_09586385e825494799c39e1eca935283-1"></a><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">tasks</span><span class="o">`</span> <span class="p">(</span>
<a name="rest_code_09586385e825494799c39e1eca935283-2"></a>  <span class="s1">'id'</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<a name="rest_code_09586385e825494799c39e1eca935283-3"></a>  <span class="s1">'title'</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_09586385e825494799c39e1eca935283-4"></a>  <span class="s1">'description'</span> <span class="n">longtext</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_09586385e825494799c39e1eca935283-5"></a>  <span class="s1">'created'</span> <span class="n">datetime</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_09586385e825494799c39e1eca935283-6"></a>  <span class="s1">'duedate'</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_09586385e825494799c39e1eca935283-7"></a>  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="s1">'id'</span><span class="p">),</span>
<a name="rest_code_09586385e825494799c39e1eca935283-8"></a>  <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="s1">'title'</span> <span class="p">(</span><span class="s1">'title'</span><span class="p">)</span>
<a name="rest_code_09586385e825494799c39e1eca935283-9"></a><span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">MyISAM</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">17</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span>
</pre>
<p>Ahora tenemos que decirle a Kohana que use esta tabla. Para ello basta crear el archivo <code>application/classes/model/task.php</code>:</p>
<pre class="code php"><a name="rest_code_30ce19494fa943c38824e8a8eaec568a-1"></a><span class="cp">&lt;?php</span> <span class="nb">defined</span><span class="p">(</span><span class="s2">"SYSPATH"</span><span class="p">)</span> <span class="k">OR</span> <span class="k">die</span><span class="p">(</span><span class="s2">"No Direct Script Access"</span><span class="p">);</span>
<a name="rest_code_30ce19494fa943c38824e8a8eaec568a-2"></a><span class="k">class</span> <span class="nc">Model_Task</span> <span class="k">extends</span> <span class="nx">ORM</span>
<a name="rest_code_30ce19494fa943c38824e8a8eaec568a-3"></a><span class="p">{</span>
<a name="rest_code_30ce19494fa943c38824e8a8eaec568a-4"></a><span class="p">}</span>
<a name="rest_code_30ce19494fa943c38824e8a8eaec568a-5"></a><span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>Bien. Paremos. ¿Para qué queremos un archivo vacío?</p>
<p>Realmente no está vacío. Para empezar, estamos restringiendo el acceso. Todos nuestros archivos PHP salvo las vistas deberían comenzar así, por seguridad. Además, estamos heredando de ORM, y esta clase padre ya nos dará todo lo que necesitamos: accederá a la base de datos y verá qué campos necesitamos aquí.</p>
<p>Personalmente, tanto automatismo no me gusta demasiado y prefiero indicarle qué tabla es la que quiero emplear:</p>
<pre class="code php"><a name="rest_code_39807eb45cf44f559ac91657010ce434-1"></a><span class="cp">&lt;?php</span> <span class="nb">defined</span><span class="p">(</span><span class="s2">"SYSPATH"</span><span class="p">)</span> <span class="k">OR</span> <span class="k">die</span><span class="p">(</span><span class="s2">"No Direct Script Access"</span><span class="p">);</span>
<a name="rest_code_39807eb45cf44f559ac91657010ce434-2"></a><span class="k">class</span> <span class="nc">Model_Task</span> <span class="k">extends</span> <span class="nx">ORM</span>
<a name="rest_code_39807eb45cf44f559ac91657010ce434-3"></a><span class="p">{</span>
<a name="rest_code_39807eb45cf44f559ac91657010ce434-4"></a>  <span class="k">public</span> <span class="nv">$_table_name</span> <span class="o">=</span> <span class="s2">"tasks"</span><span class="p">;</span>
<a name="rest_code_39807eb45cf44f559ac91657010ce434-5"></a><span class="p">}</span>
<a name="rest_code_39807eb45cf44f559ac91657010ce434-6"></a><span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>Y hemos terminado el modelo. Fácil, ¿no?</p>
</div>
<div class="section" id="el-controlador">
<h2>El Controlador</h2>
<p>Creamos el archivo <code>application/classes/controller/task.php</code>:</p>
<pre class="code php"><a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-1"></a><span class="cp">&lt;?php</span> <span class="nb">defined</span><span class="p">(</span><span class="s1">'SYSPATH'</span><span class="p">)</span> <span class="k">OR</span> <span class="k">die</span><span class="p">(</span><span class="s1">'No Direct Script Access'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-2"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-3"></a><span class="k">class</span> <span class="nc">Controller_Task</span> <span class="k">extends</span> <span class="nx">Controller</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-4"></a><span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-5"></a>  <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">Kohana_Request</span> <span class="nv">$request</span><span class="p">)</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-6"></a>  <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-7"></a>    <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-8"></a>  <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-9"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-10"></a>  <span class="k">public</span> <span class="k">function</span> <span class="nf">action_index</span> <span class="p">()</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-11"></a>  <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-12"></a>    <span class="nv">$vista</span> <span class="o">=</span> <span class="nx">View</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">'task_index'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-13"></a>    <span class="nv">$vista</span><span class="o">-&gt;</span><span class="na">set</span> <span class="p">(</span><span class="s1">'task_list'</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_tasklist</span><span class="p">());</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-14"></a>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">response</span> <span class="o">=</span> <span class="nv">$vista</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-15"></a>  <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-16"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-17"></a>  <span class="k">public</span> <span class="k">function</span> <span class="nf">action_add</span> <span class="p">()</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-18"></a>  <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-19"></a>    <span class="nv">$vista</span> <span class="o">=</span> <span class="nx">View</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">'task_add'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-20"></a>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">response</span> <span class="o">=</span> <span class="nv">$vista</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-21"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-22"></a>    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">)</span> <span class="k">OR</span> <span class="o">!</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">))</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-23"></a>      <span class="k">return</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-24"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-25"></a>    <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">create_task</span> <span class="p">()</span> <span class="p">)</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-26"></a>      <span class="nv">$vista</span><span class="o">-&gt;</span><span class="na">set</span> <span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="s1">'Task added'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-27"></a>    <span class="k">else</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-28"></a>      <span class="nv">$vista</span><span class="o">-&gt;</span><span class="na">set</span> <span class="p">(</span><span class="s1">'message'</span><span class="p">,</span> <span class="s1">'Error al añadir'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-29"></a>  <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-30"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-31"></a>  <span class="k">private</span> <span class="k">function</span> <span class="nf">create_task</span> <span class="p">()</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-32"></a>  <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-33"></a>    <span class="nv">$newtask</span> <span class="o">=</span> <span class="nx">ORM</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">'task'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-34"></a>    <span class="nv">$newtask</span><span class="o">-&gt;</span><span class="na">title</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'title'</span><span class="p">];</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-35"></a>    <span class="nv">$newtask</span><span class="o">-&gt;</span><span class="na">description</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'description'</span><span class="p">];</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-36"></a>    <span class="nv">$newtask</span><span class="o">-&gt;</span><span class="na">created</span> <span class="o">=</span> <span class="nb">strftime</span><span class="p">(</span><span class="s1">'%Y-%m-%d %H.%M.%S'</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-37"></a>    <span class="nv">$newtask</span><span class="o">-&gt;</span><span class="na">duedate</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getAsDate</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'duedate'</span><span class="p">]);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-38"></a>    <span class="nv">$newtask</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">();</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-39"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-40"></a>    <span class="k">return</span> <span class="nv">$newtask</span><span class="o">-&gt;</span><span class="na">saved</span><span class="p">();</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-41"></a>  <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-42"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-43"></a>  <span class="k">private</span> <span class="k">function</span> <span class="nf">getAsDate</span> <span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-44"></a>  <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-45"></a>    <span class="nv">$result</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-46"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span> <span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-47"></a>      <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$value</span><span class="o">.</span><span class="s2">" 00.00.00"</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-48"></a>    <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-49"></a>    <span class="nb">print_r</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-50"></a>    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-51"></a>  <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-52"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-53"></a>  <span class="k">private</span> <span class="k">function</span> <span class="nf">get_tasklist</span> <span class="p">()</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-54"></a>  <span class="p">{</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-55"></a>    <span class="nv">$tasks</span> <span class="o">=</span> <span class="nx">ORM</span><span class="o">::</span><span class="na">factory</span><span class="p">(</span><span class="s1">'task'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">find_all</span><span class="p">();</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-56"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-57"></a>    <span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-58"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-59"></a>    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$tasks</span> <span class="k">as</span> <span class="nv">$task</span><span class="p">)</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-60"></a>      <span class="nv">$result</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$task</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-61"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-62"></a>    <span class="k">return</span> <span class="nv">$result</span><span class="p">;</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-63"></a>  <span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-64"></a>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-65"></a><span class="p">}</span>
<a name="rest_code_e8b537ed34dd4cfa8ac89606c3804104-66"></a><span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>Analicemos un poco este código.</p>
<p>Lo primero de todo es la seguridad, por lo que evitamos el acceso directo.</p>
<p>A continuación se crea una clase <code>Controller_Task</code> que hereda de <code>Controller</code>. El nombre de la clase está sujeto a una "convención de nombres":<a class="reference external" href="http://kohanaframework.org/guide/about.conventions">http://kohanaframework.org/guide/about.conventions</a>, y heredamos de Controller porque somos un controlador :D</p>
<p>El constructor no tiene mucho misterio: tenemos que implementarlo y llamamos al constructor padre. No tenemos nada más que inicializar, por lo que podemos terminar.</p>
<p>La función <code>action_index</code> es, como el nombre indica, una acción. Será la acción por defecto que se ejecute cuando alguien realice una solicitud sobre el controlador. Si simplificamos su código hasta un simple <code>echo 'hola';</code>, podremos comprobar que todo funciona accediendo a la misma dirección que pusimos en la configuración, en 'base_url', seguido del nombre básico del controlador, es decir, 'task'. En mi caso, la dirección es <em>`http://localhost:/~miguel/kohana/task`</em>. Si no habéis activado las URLs limpias, tendréis que indicar quién debe renderizar esa página, accediendo a algo como <em>`http://localhost:/~miguel/kohana/index.php/task`</em>.</p>
<p>Como vemos, la acción <code>action_index</code> crea una vista a partir de una plantilla y la devuelve como respuesta. Veremos más sobre estas vistas en el apartado siguiente.</p>
<p>La acción <code>action_add</code> va a tratar de crear una tarea nueva. Además, voy a reutilizar esta función. Si viene sin datos, sólo mostrará la ventana. Si viene con datos, creará una nueva tarea. Por ello, lo primero que hago es crear la vista que voy a devolver, ya que es común a ambos casos de uso, y después trato de insertarla, guardándome un mensaje en cada caso.</p>
<p>La función <code>create_task</code> es quien realmente crea la tarea. Para ello hace uso del ORM, obteniendo los valores de la variable <code>$_POST</code>. Las fechas tengo que modificarlas a mano para que tengan el formato esperado por mysql ("YYYY-MM-DD hh.mm.ss").</p>
<p>La función <code>get_tasklist</code> serializa la lista de tareas para pasársela a la vista.</p>
</div>
<div class="section" id="cosas-importantes">
<h2>Cosas importantes</h2>
<p>Aquí hay dos cosas importantes: el uso de la base de datos y el paso de parámetros con la vista.</p>
<p>Para usar la base de datos, estamos usando el ORM. Éste está "bastante bien documentado":<a class="reference external" href="http://kohanaframework.org/guide/api/ORM">http://kohanaframework.org/guide/api/ORM</a>.</p>
<p>Para obtener datos de la vista, los obtenemos de la variable <code>$_POST</code>, ya que éste ha sido el método que he decido utilizar para el envío de datos (y suele ser el más recomendable). Los nombres de los campos son los que he puesto en la vista y que veremos más adelante.</p>
<p>Para enviar datos a la vista, lo que hago es establecerlos al objeto "View" con la función "set". Esto funcionará como una tabla Hash cuando esté en la vista.</p>
</div>
<div class="section" id="las-vistas">
<h2>Las vistas</h2>
<p>Antes de entrar en materia, como no me gusta repetirme, crearemos un par de archivos. Todas las vistas deben ir en <code>application/views</code>.</p>
<p>Los dos archivos a crear no tienen mayor misterio y no entraré a describirlos:</p>
<div class="section" id="header-php">
<h3>header.php</h3>
<pre class="code html"><a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-1"></a><span class="cp">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-2"></a>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-3"></a><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span><span class="nt">&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-4"></a><span class="nt">&lt;head&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-5"></a>  <span class="nt">&lt;title&gt;</span>Vista para Kohana PHP
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-6"></a>  <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"Content-Type"</span> <span class="na">content=</span><span class="s">"text/html; charset=UTF-8"</span> <span class="nt">/&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-7"></a>  <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">"http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span><span class="nt">/&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-8"></a>    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-9"></a>    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-10"></a>  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-11"></a>    <span class="nb">Date</span><span class="p">.</span><span class="nx">firstDayOfWeek</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-12"></a>    <span class="nb">Date</span><span class="p">.</span><span class="nx">format</span> <span class="o">=</span> <span class="s1">'yyyy/mm/dd'</span><span class="p">;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-13"></a>      <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-14"></a>        <span class="nx">$</span><span class="p">(</span><span class="s2">".date"</span><span class="p">).</span><span class="nx">datepicker</span><span class="p">({</span> <span class="nx">dateFormat</span><span class="o">:</span> <span class="s1">'yy-mm-dd'</span><span class="p">,</span> <span class="nx">firstDay</span><span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-15"></a>      <span class="p">});</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-16"></a>  <span class="nt">&lt;/script&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-17"></a><span class="nt">&lt;/head&gt;</span>
<a name="rest_code_9ed5c80b25974ccb8f96b801f6e18170-18"></a><span class="nt">&lt;body&gt;</span>
</pre>
</div>
<div class="section" id="footer-php">
<h3>footer.php</h3>
<pre class="code html"><a name="rest_code_614a7476eeee496d84977a9c3b3a101a-1"></a><span class="nt">&lt;/body&gt;</span>
<a name="rest_code_614a7476eeee496d84977a9c3b3a101a-2"></a><span class="nt">&lt;/html&gt;</span>
</pre>
<p>Sí, hago algo de uso de jquery, pero no os asustéis que sólo es para la inserción de fechas. El resto de la aplicación será horrible :-P</p>
<p>Vamos con el índice:</p>
</div>
<div class="section" id="task-index-php">
<h3>task_index.php</h3>
<pre class="code php"><a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-1"></a><span class="cp">&lt;?php</span> <span class="k">include</span> <span class="s1">'header.php'</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-2"></a>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-3"></a><span class="x">&lt;table&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-4"></a><span class="x">  &lt;thead&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-5"></a><span class="x">    &lt;tr&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-6"></a><span class="x">      &lt;th&gt;Title</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-7"></a><span class="x">      &lt;th&gt;Creation</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-8"></a><span class="x">      &lt;th&gt;Due date</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-9"></a><span class="x">      &lt;th&gt;Planned date</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-10"></a><span class="x">      &lt;th&gt;Completed</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-11"></a><span class="x">    &lt;/tr&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-12"></a><span class="x">  &lt;/thead&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-13"></a><span class="x">  &lt;tbody&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-14"></a><span class="x">  </span><span class="cp">&lt;?php</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-15"></a>  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$task_list</span> <span class="k">as</span> <span class="nv">$task</span><span class="p">)</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-16"></a>  <span class="p">{</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-17"></a>    <span class="k">echo</span> <span class="s2">""</span><span class="p">;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-18"></a>    <span class="k">echo</span> <span class="s1">''</span><span class="o">.</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="na">title</span><span class="o">.</span><span class="s2">""</span><span class="p">;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-19"></a>    <span class="k">echo</span> <span class="s2">""</span><span class="o">.</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="na">created</span><span class="o">.</span><span class="s2">""</span><span class="p">;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-20"></a>    <span class="k">echo</span> <span class="s2">""</span><span class="o">.</span><span class="nv">$task</span><span class="o">-&gt;</span><span class="na">duedate</span><span class="o">.</span><span class="s2">""</span><span class="p">;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-21"></a>    <span class="k">echo</span> <span class="s2">""</span><span class="p">;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-22"></a>  <span class="p">}</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-23"></a>  <span class="cp">?&gt;</span><span class="x"></span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-24"></a><span class="x">  &lt;/tbody&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-25"></a><span class="x">&lt;/table&gt;</span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-26"></a>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-27"></a><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">""</span><span class="o">.</span><span class="nx">html</span><span class="o">::</span><span class="na">anchor</span><span class="p">(</span><span class="s2">"task/add"</span><span class="p">,</span><span class="s2">"Add new task"</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-28"></a>
<a name="rest_code_97064bfe15ad4be6988f1282c4b63a11-29"></a><span class="cp">&lt;?php</span> <span class="k">include</span> <span class="s2">"footer.php"</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>Como en la función del controlador "action_index" insertamos la variable <code>$task_list</code>, ahora podemos recuperarla y recorrerla. De esta manera creamos una vista horrible. Dejo como tarea ponerla bonita, ya que eso no es el tema de este tutorial.</p>
<p>Nos queda poder añadir tareas (<em>task_add.php</em>):</p>
<pre class="code php"><a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-1"></a><span class="cp">&lt;?php</span> <span class="k">include</span> <span class="s1">'header.php'</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-2"></a><span class="cp">&lt;?php</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-3"></a>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-4"></a><span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$message</span><span class="p">))</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-5"></a><span class="p">{</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-6"></a>  <span class="k">print</span> <span class="nv">$message</span><span class="p">;</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-7"></a><span class="p">}</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-8"></a>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-9"></a><span class="k">print</span> <span class="nx">html</span><span class="o">::</span><span class="na">anchor</span><span class="p">(</span><span class="s1">'task'</span><span class="p">,</span><span class="s1">'List of tasks'</span><span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-10"></a>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-11"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">open</span><span class="p">();</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-12"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'Título'</span><span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-13"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">input</span><span class="p">(</span><span class="s1">'title'</span><span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-14"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">textarea</span><span class="p">(</span><span class="s1">'description'</span><span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-15"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">label</span><span class="p">(</span><span class="s1">'duedate'</span><span class="p">,</span> <span class="s1">'Due Date:'</span><span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-16"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">input</span><span class="p">(</span><span class="s1">'duedate'</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span> <span class="p">(</span><span class="s1">'class'</span><span class="o">=&gt;</span><span class="s1">'date'</span><span class="p">)</span> <span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-17"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">submit</span><span class="p">(</span><span class="s1">'submit'</span><span class="p">,</span> <span class="s1">'Send'</span><span class="p">);</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-18"></a><span class="k">print</span> <span class="nx">form</span><span class="o">::</span><span class="na">close</span><span class="p">();</span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-19"></a><span class="cp">?&gt;</span><span class="x"></span>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-20"></a>
<a name="rest_code_e17404d1ca13443a851a6dab1033ebf8-21"></a><span class="cp">&lt;?php</span> <span class="k">include</span> <span class="s1">'footer.php'</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre>
<p>En este caso he creado un formulario utilizando las funciones de Kohana. Como véis, los nombres de los campos se corresponden con los que utilicé en la función "create_task".</p>
</div>
</div>
<div class="section" id="fin">
<h2>Fin</h2>
<p>Como decían en en 1,2,3... "hasta aquí puedo leer". Como primera aplicación me parece mucho más interesante que el triste "hola mundo", ya que tiene todos los componentes de una aplicación real: modelo, vista y controlador (el "hola mundo" no tiene más que controlador), acceso a bases de datos, etc.</p>
<p>No he entrado con el "update_task" ya que no es más complicado que el "create_task". Lo dejo como ejercicio.</p>
<p>Habrá segunda parte de este tutorial.</p>
</div>
<div class="section" id="referencias">
<h2>Referencias</h2>
<p>No hay mucha documentación de "Kohana":<a class="reference external" href="http://kohanaframework.org/">http://kohanaframework.org/</a>. Sin embargo, el "ORM de Kohana":<a class="reference external" href="http://kohanaframework.org/guide/tutorials.orm">http://kohanaframework.org/guide/tutorials.orm</a> sí está bien documentado y no creo que tengáis mayor problema con esa parte. Siempre prefiero utilizar sistemas que me eviten el SQL a mano, ya que éste puede tener "sql-injection".</p>
<p>Acordáos de seguir las "convenciones":<a class="reference external" href="http://kohanaframework.org/guide/about.conventions">http://kohanaframework.org/guide/about.conventions</a>. También podéis echar un vistazo a otros tutoriales, como el de "Ajaxman":<a class="reference external" href="http://www.ajaxman.net/category/kohana">http://www.ajaxman.net/category/kohana</a> o el de "Christian Gilè":<a class="reference external" href="http://net.tutsplus.com/tutorials/php/kohana-the-swift-php-framework/">http://net.tutsplus.com/tutorials/php/kohana-the-swift-php-framework/</a>, sin contar los "tutoriales de la propia página de Kohana":<a class="reference external" href="http://kohanaframework.org/guide/tutorials.helloworld">http://kohanaframework.org/guide/tutorials.helloworld</a>.</p>
<p>Espero que os haya resultado interesante.</p>
</div>
</div>
          </div>
          <br><div>
            <nav><span class="author">
                <span class="glyphicon glyphicon-user"></span> 
                <span>Publicado:Miguel Ángel García</span>
              </span>
               

              
              <span class="dateline">
                <span class="glyphicon glyphicon-calendar"></span> 
                <time class="published dt-published" datetime="2010-12-09T00:00:00+00:00" title="2010-12-09">2010-12-09</time></span>
               
              <span class="tags">
                <span class="glyphicon glyphicon-tags"></span> 
                <a class="label label-primary p-category" href="/categories/kohana/" rel="tag">kohana</a>
              </span>
                      <ul class="pager">
<li class="previous">
              <a href="/blog/critica-drupal/" rel="prev" title="Crítica a Drupal">
                <span class="glyphicon glyphicon-arrow-left"></span>
                Publicación anterior
              </a>
            </li>
            <li class="next">
              <a href="/blog/modulo-kohana/" rel="next" title="Módulo Kohana">
                Siguiente publicación
                <span class="glyphicon glyphicon-arrow-right"></span>
              </a>
            </li>
        </ul></nav>
</div>
          <section class="comments"><h2>Comentarios</h2>
                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="magmax",
            disqus_url="http://magmax.org/blog/kohana-tutorial-1/",
        disqus_title="Kohana: Tutorial 1",
        disqus_identifier="cache/posts/kohana-tutorial-1.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


          </section></article><script>var disqus_shortname="magmax";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
      <aside class="sidebar col-md-3"><div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">Last comments</h3>
  </div>
  <div class="panel-body">
    <div id="disqus_last_comments" class="dsq-widget">
      <script type="text/javascript" src="https://magmax.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=32&amp;excerpt_length=150">
      </script>
</div>
  </div>
</section>
</div>
          <div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="panel-body">
    <ul id="gh_repos" class="list-unstyled">
<li class="loading">Status updating…</li>
    </ul>
</div>
  <div class="panel-footer">
    <a href="https://github.com/magmax">@magmax</a> on GitHub
  </div>
</section>
</div>
      </aside>
</div>

    <footer>
      Contents © 2009-2020 <a href="mailto:">Miguel Ángel García</a> 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/es/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;width:80px;height:15px;vertical-align:middle" src="https://i.creativecommons.org/l/by-nc-sa/2.5/es/80x15.png"></a>; Using <a href="/stories/credits/">a lot of free software</a>
      
    </footer>
</div>
</div>




<script data-main="/assets/js/main" src="/assets/js/libs/require/require.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9308241-3', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
