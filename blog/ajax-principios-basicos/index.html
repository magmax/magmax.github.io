<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="max-age=43200">
<meta http-equiv="ETag" content="b'adb158dbc724060983dd702f3f7e291089e1bd11'">
<title>Ajax, principios básicos | MagMax Blog</title>
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="/assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="/assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/magmax">
<link rel="canonical" href="http://magmax.org/blog/ajax-principios-basicos/">
<link rel="icon" href="/favicon.ico" sizes="16x16">
<link rel="icon" href="/favicon_330.png" sizes="330x330">
<link rel="icon" href="/favicon.png" sizes="128x128">
<meta name="author" content="Miguel Ángel García">
<link rel="prev" href="/blog/django-tests/" title="Django: Test del modelo y Fixtures" type="text/html">
<link rel="next" href="/blog/tarta-queso/" title="Cocina: Tarta de queso" type="text/html">
<meta property="og:site_name" content="MagMax Blog">
<meta property="og:title" content="Ajax, principios básicos">
<meta property="og:url" content="http://magmax.org/blog/ajax-principios-basicos/">
<meta property="og:description" content="Todo el mundo habla de Ajax, pero... ¿qué es esta nueva y revolucionaria teconología?
Realmente es una técnica para sustituir una parte de nuestra página web por datos obtenidos del servidor. Conviene">
<meta property="og:type" content="article">
<meta property="article:author" content="Miguel Ángel García">
<meta property="article:published_time" content="2011-08-22T00:00:00+00:00">
<meta property="article:updated" content="2011-08-22T00:00:00">
<meta property="article:tag" content="ajax">
<meta property="article:tag" content="javascript">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@magmax_en">
<meta name="twitter:creator" content="@magmax">
<meta name="twitter:title" content="MagMax Blog">
<meta name="twitter:description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ...">
<meta name="twitter:url" content="http://magmax.org//blog/ajax-principios-basicos/">
<meta name="twitter:image" content="http://magmax.org/favicon.png">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://magmax.org/">

        <span id="blog-title">MagMax Blog</span>
      </a>
    </div>
<!-- /.navbar-header -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav">
<li>
<a href="/">Inicio</a>
                </li>
<li>
<a href="/archive.html">Archivo</a>
                </li>
<li>
<a href="/categories">Categorías</a>
                </li>
<li>
<a href="/projects">Proyectos</a>
                </li>
<li>
<a href="/news">Posts Externos</a>

        
      </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
<form class="navbar-form navbar-left" role="search" action="http://google.com/search" method="get">
<div class="form-group">
<input type="hidden" name="sitesearch" value="magmax.org"><input type="text" name="q" class="form-control" placeholder="Search / Buscar">
</div>
</form>
</li>

        <li style="margin-left:0">
          <a href="http://feeds.feedburner.com/magmax">
            <img src="/assets/images/rss.png" style="width:22px;height:22px"></a>
        </li>

        
      </ul>
</div>
<!-- /.navbar-collapse -->
  </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
  <div class="body-content">
    <div class="row">
      <div class="page-content col-md-9">
        
        <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="/blog/ajax-principios-basicos/" class="u-url">Ajax, principios básicos</a></h1>
            <div class="metadata text-muted">
              <i class="glyphicon glyphicon-calendar"></i>
              <p class="dateline">
                <time class="published dt-published" datetime="2011-08-22T00:00:00+00:00" title="2011-08-22">2011-08-22</time>
                // <time class="updated dt-updated" datetime="2011-08-22T00:00:00" title="2011-08-22">2011-08-22</time></p>
              <p class="commentline">            <a href="/blog/ajax-principios-basicos/#disqus_thread" data-disqus-identifier="cache/posts/ajax-principios-basicos.html">Comments</a>

</p>
              <address class="vcard author"><a class="url fn" href="http://magmax.org">Miguel Ángel García</a></address>
            </div>
            <br></header><div class="e-content entry-content" itemprop="articleBody text">
            <div>
<p>Todo el mundo habla de Ajax, pero... ¿qué es esta nueva y revolucionaria teconología?</p>
<p>Realmente es una técnica para sustituir una parte de nuestra página web por datos obtenidos del servidor. Conviene no equivocarse: sustituir una parte de nuestra página web por otros datos es JavaScript; lo que incorpora Ajax es la posibilidad de que esos datos se obtengan del servidor.</p>
<!-- TEASER_END -->
<div class="section" id="palabrotas-basicas">
<h2>Palabrotas básicas</h2>
<p>Cuando hablamos de una página HTML entendemos un archivo con extensión HTML y un montón de "tags". Al hablar de Ajax no queda más remedio que referirnos al DOM, que consiste en la representación interna que tiene el Browser del archivo HTML que estamos mostrando.</p>
<p>La diferencia fundamental es que un archivo HTML es muy probable que no cambie en circunstancias normales. El DOM puede evolucionar dinámicamente. Además, cuando el resultado lo genera un servlet o servicio, es probable que el archivo HTML ni siquiera exista como tal, sino que se ha construido de forma dinámica.</p>
</div>
<div class="section" id="sustitucion-de-objetos-en-el-dom">
<h2>Sustitución de objetos en el DOM</h2>
<p>Sustituir unos datos en el DOM por otros es algo muy sencillo:</p>
<pre class="code javascript"><a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-1"></a><span class="o">&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-2"></a>  <span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-3"></a>    <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-4"></a>      <span class="kd">function</span> <span class="nx">sustituye</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-5"></a>        <span class="kd">var</span> <span class="nx">mensaje</span> <span class="o">=</span> <span class="s2">"Ha elegido: "</span> <span class="o">+</span> <span class="nx">param</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">param</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-6"></a>        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"mensaje"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">mensaje</span><span class="p">;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-7"></a>      <span class="p">};</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-8"></a>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-9"></a>    <span class="o">&lt;</span><span class="err">/script&gt;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-10"></a>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-11"></a><span class="o">&lt;</span><span class="err">/head&gt;</span>
<a name="rest_code_b2ed275aa00d4837b2de08abfbc0cd5e-12"></a><span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
</pre>
<p>Como véis, basta con obtener el elemento ("document.getElementById") y asignar un valor a su propiedad innerHTML. Y ya está :D</p>
<p>Esto es un poquitín de JavaScript, pero nada de Ajax.</p>
</div>
<div class="section" id="herramientas-proporcionadas-por-ajax">
<h2>Herramientas proporcionadas por AJAX</h2>
<p>Ajax incorpora una clase a nuestro repertorio JavaScript. Esta clase es <em>XMLHttpRequest</em>, que tiene 2 métodos principales:
* <em>open(método, ruta, asíncrono)</em>, que abre una conexión
* <em>send()</em>, que envía una petición</p>
<p>También tiene tres atributos muy interesantes, que son:</p>
<ul class="simple">
<li>
<em>onreadystatechange</em>, que permite establecer la acción asíncrona a realizar (luego lo vemos)</li>
<li>
<em>readyState</em>, que nos permite comprobar en qué estado se encuentra nuestra petición.</li>
<li>
<em>responseText</em>, donde se devolverá la respuesta del servidor</li>
</ul>
<p>Y eso es casi todo Ajax. Es probable que no necesitéis nada más.</p>
</div>
<div class="section" id="creando-un-objeto-xmlhttprequest">
<h2>Creando un objeto XMLHttpRequest</h2>
<p>Para crear un objeto XMLHttpRequest basta con hacer:</p>
<pre class="code javascript"><a name="rest_code_736991c144a445ccbcb31aedba8db027-1"></a><span class="nx">xmlhttp</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</pre>
<p>Pero nuestros "amigos" de Microsoft, siempre innovadores, nos complican un poquito la creación de un objeto XMLHttpRequest, ya que en IE5 y 6 la cosa cambia mucho. Por eso recomiendo el uso de una función como ésta:</p>
<pre class="code js"><a name="rest_code_06831934042b4429ac81ab65afe7d1ed-1"></a><span class="kd">function</span> <span class="nx">getAjaxObject</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-2"></a>      <span class="kd">var</span> <span class="nx">xmlhttp</span><span class="p">;</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-3"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">)</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-4"></a>      <span class="p">{</span><span class="c1">// code for IE7+, Firefox, Chrome, Opera, Safari</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-5"></a>         <span class="nx">xmlhttp</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-6"></a>      <span class="p">}</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-7"></a>      <span class="k">else</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-8"></a>      <span class="p">{</span><span class="c1">// code for IE6, IE5</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-9"></a>         <span class="nx">xmlhttp</span><span class="o">=</span><span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">);</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-10"></a>      <span class="p">}</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-11"></a>      <span class="k">return</span> <span class="nx">xmlhttp</span><span class="p">;</span>
<a name="rest_code_06831934042b4429ac81ab65afe7d1ed-12"></a><span class="p">};</span>
</pre>
<p>De esta manera tendremos un constructor adecuado a nuestro navegador.</p>
<div class="section" id="ejemplo-basico">
<h3>Ejemplo básico</h3>
<p>Ya sabemos todo lo que necesitamos. Vamos a construir un ejemplo.</p>
<p>Va a ser muy sencillo: un combobox que, al seleccionar una provincia, mostrará algunos pueblos. Por no liarlo, tendremos dos provincias y 4 pueblos cada una.</p>
<p>Vamos primero con el HTML con el que sustituiremos una zona de nuestro DOM:</p>
<p>Archivo <em>ciudadreal.html</em>:</p>
<pre class="code html"><a name="rest_code_693f87347bfe44578c9ecceff6b3a511-1"></a>Seleccione población:
<a name="rest_code_693f87347bfe44578c9ecceff6b3a511-2"></a><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"poblacion"</span><span class="nt">&gt;</span>
<a name="rest_code_693f87347bfe44578c9ecceff6b3a511-3"></a>  <span class="nt">&lt;option&gt;</span>Ciudad Real<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_693f87347bfe44578c9ecceff6b3a511-4"></a>  <span class="nt">&lt;option&gt;</span>Miguelturra<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_693f87347bfe44578c9ecceff6b3a511-5"></a>  <span class="nt">&lt;option&gt;</span>Malagón<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_693f87347bfe44578c9ecceff6b3a511-6"></a>  <span class="nt">&lt;option&gt;</span>Tomelloso<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_693f87347bfe44578c9ecceff6b3a511-7"></a><span class="nt">&lt;/select&gt;</span>
</pre>
<p>Archivo <em>toledo.html</em>:</p>
<pre class="code html"><a name="rest_code_21b6de273347453ba885c10866165fdd-1"></a>Seleccione población:
<a name="rest_code_21b6de273347453ba885c10866165fdd-2"></a><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"poblacion"</span><span class="nt">&gt;</span>
<a name="rest_code_21b6de273347453ba885c10866165fdd-3"></a>  <span class="nt">&lt;option&gt;</span>Toledo<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_21b6de273347453ba885c10866165fdd-4"></a>  <span class="nt">&lt;option&gt;</span>Sonseca<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_21b6de273347453ba885c10866165fdd-5"></a>  <span class="nt">&lt;option&gt;</span>Torrijos<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_21b6de273347453ba885c10866165fdd-6"></a>  <span class="nt">&lt;option&gt;</span>Talavera<span class="nt">&lt;/option&gt;</span>
<a name="rest_code_21b6de273347453ba885c10866165fdd-7"></a><span class="nt">&lt;/select&gt;</span>
</pre>
<p>Y ahora vamos con el principal (index.html, por ejemplo):</p>
<pre class="code html"><a name="rest_code_46acd74f97894049aa91c9314f0292f4-1"></a><span class="nt">&lt;html&gt;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-2"></a>  <span class="nt">&lt;head&gt;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-3"></a>    <span class="nt">&lt;title&gt;</span>Ejemplo Ajax<span class="nt">&lt;/title&gt;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-4"></a>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-5"></a>    <span class="nt">&lt;script&gt;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-6"></a>      <span class="kd">function</span> <span class="nx">getAjaxObject</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-7"></a>      <span class="kd">var</span> <span class="nx">xmlhttp</span><span class="p">;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-8"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">XMLHttpRequest</span><span class="p">)</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-9"></a>      <span class="p">{</span><span class="c1">// code for IE7+, Firefox, Chrome, Opera, Safari</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-10"></a>         <span class="nx">xmlhttp</span><span class="o">=</span><span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-11"></a>      <span class="p">}</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-12"></a>      <span class="k">else</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-13"></a>      <span class="p">{</span><span class="c1">// code for IE6, IE5</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-14"></a>         <span class="nx">xmlhttp</span><span class="o">=</span><span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="p">);</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-15"></a>      <span class="p">}</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-16"></a>      <span class="k">return</span> <span class="nx">xmlhttp</span><span class="p">;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-17"></a>      <span class="p">};</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-18"></a>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-19"></a>      <span class="kd">function</span> <span class="nx">provinciaModificada</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-20"></a>        <span class="kd">var</span> <span class="nx">address</span> <span class="o">=</span>  <span class="nx">param</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">param</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-21"></a>        <span class="nx">conn</span> <span class="o">=</span> <span class="nx">getAjaxObject</span><span class="p">();</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-22"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="nx">address</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-23"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-24"></a>        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"lugar"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">conn</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-25"></a>      <span class="p">};</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-26"></a>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-27"></a>    <span class="nt">&lt;/script&gt;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-28"></a>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-29"></a><span class="nt">&lt;/head&gt;</span>
<a name="rest_code_46acd74f97894049aa91c9314f0292f4-30"></a><span class="nt">&lt;body&gt;</span>
</pre>
<div class="section" id="un-poquito-de-por-favor">
<h4>Un poquito de por favor!!!</h4>
<p>Vale, no os asustéis, que tampoco es tanto :D</p>
<p>Olvidemos el JavaScript por un momento. Los puntos calientes son la operación "onChange" del "select" y también el "div" de nombre "provincia". Todo lo demás es HTML estándar y no hay mucho que contar.</p>
<p>Con esas instrucciones sabemos que cuando cambie el "select" se debe llamar a la función "provinciaModificada". El identificador del "div" es para poder seleccionarlo después mediante "<em>document.getElementById</em>".</p>
<p>Vamos con el javascript. Lo primero es una función que nos permite obtener el objeto XMLHttpRequest independientemente del browser utilizado. Ya lo explicamos antes.</p>
<p>Después es donde está la chicha. Lo copio de nuevo:</p>
<pre class="code javascript"><a name="rest_code_223a4430899642b096254416a2c65635-1"></a><span class="kd">function</span> <span class="nx">provinciaModificada</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_223a4430899642b096254416a2c65635-2"></a>        <span class="kd">var</span> <span class="nx">address</span> <span class="o">=</span>  <span class="nx">param</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">param</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
<a name="rest_code_223a4430899642b096254416a2c65635-3"></a>        <span class="nx">conn</span> <span class="o">=</span> <span class="nx">getAjaxObject</span><span class="p">();</span>
<a name="rest_code_223a4430899642b096254416a2c65635-4"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="nx">address</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
<a name="rest_code_223a4430899642b096254416a2c65635-5"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<a name="rest_code_223a4430899642b096254416a2c65635-6"></a>        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"lugar"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">conn</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
<a name="rest_code_223a4430899642b096254416a2c65635-7"></a>      <span class="p">};</span>
</pre>
<p>En la línea 2 obtenemos el valor seleccionado. Si miramos las opciones, veremos que los valores indican el HTML a cargar. Eso es un truco que he utilizado para facilitarme la vida.</p>
<p>En la línea 3, obtenemos el objeto Request.</p>
<p>En la línea 4, abrimos una conexión mediante GET (en este caso nos daba igual POST) que no es asíncrona.</p>
<p>En la línea 5 realizamos la comunicación propiamente dicha.</p>
<p>Finalmente, en la línea 6 sustituimos el HTML por el obtenido.</p>
</div>
</div>
<div class="section" id="comunicaciones-asincronas">
<h3>Comunicaciones asíncronas</h3>
<p>En las comunicaciones asíncronas basta con utilizar el atributo onreadystatechange:</p>
<pre class="code javascript"><a name="rest_code_1b9105627179450e9643bf596fdf1757-1"></a><span class="kd">function</span> <span class="nx">provinciaModificada</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-2"></a>        <span class="kd">var</span> <span class="nx">address</span> <span class="o">=</span>  <span class="nx">param</span><span class="p">.</span><span class="nx">options</span><span class="p">[</span><span class="nx">param</span><span class="p">.</span><span class="nx">selectedIndex</span><span class="p">].</span><span class="nx">value</span><span class="p">;</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-3"></a>        <span class="nx">conn</span> <span class="o">=</span> <span class="nx">getAjaxObject</span><span class="p">();</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-4"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-5"></a>          <span class="k">if</span> <span class="p">(</span><span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">readyState</span><span class="o">==</span><span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="nx">xmlhttp</span><span class="p">.</span><span class="nx">status</span><span class="o">==</span><span class="mi">200</span><span class="p">)</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-6"></a>          <span class="p">{</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-7"></a>             <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"lugar"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">conn</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-8"></a>          <span class="p">}</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-9"></a>        <span class="p">};</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-10"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">"GET"</span><span class="p">,</span> <span class="nx">address</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-11"></a>        <span class="nx">conn</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
<a name="rest_code_1b9105627179450e9643bf596fdf1757-12"></a>      <span class="p">};</span>
</pre>
<p>No os olvidéis de cambiar el tercer parámetro del open, que ahora vale <em>true</em>.</p>
<p>En este caso, la función se ejecutará cuando el objeto ya se haya obtenido. En nuestro caso, que es una tontería, da igual asíncrono que síncrono, pero si hay que acceder a BBDD entre medias, la diferencia puede ser crucial.</p>
<p>Enlaces:</p>
<p>La propia W3C proporciona un montón de ejemplos de Ajax, así como un buen tutorial.</p>
<p>A disfrutar!!!</p>
</div>
</div>
</div>
          </div>
          <br><div>
            <nav><span class="author">
                <span class="glyphicon glyphicon-user"></span> 
                <span>Publicado:Miguel Ángel García</span>
              </span>
               

              
              <span class="dateline">
                <span class="glyphicon glyphicon-calendar"></span> 
                <time class="published dt-published" datetime="2011-08-22T00:00:00+00:00" title="2011-08-22">2011-08-22</time></span>
               
              <span class="tags">
                <span class="glyphicon glyphicon-tags"></span> 
                <a class="label label-primary p-category" href="/categories/ajax/" rel="tag">ajax</a>
                <a class="label label-primary p-category" href="/categories/javascript/" rel="tag">javascript</a>
              </span>
                      <ul class="pager">
<li class="previous">
              <a href="/blog/django-tests/" rel="prev" title="Django: Test del modelo y Fixtures">
                <span class="glyphicon glyphicon-arrow-left"></span>
                Publicación anterior
              </a>
            </li>
            <li class="next">
              <a href="/blog/tarta-queso/" rel="next" title="Cocina: Tarta de queso">
                Siguiente publicación
                <span class="glyphicon glyphicon-arrow-right"></span>
              </a>
            </li>
        </ul>
<div style="margin-left: auto; margin-right: auto;">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-1887364423515042" data-ad-slot="4236077264"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>
            </nav>
</div>
          <section class="comments"><h2>Comentarios</h2>
                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="magmax",
            disqus_url="http://magmax.org/blog/ajax-principios-basicos/",
        disqus_title="Ajax, principios b\u00e1sicos",
        disqus_identifier="cache/posts/ajax-principios-basicos.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


          </section></article><script>var disqus_shortname="magmax";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
      <aside class="sidebar col-md-3"><div>
<section class="panel panel-default"><div class="panel-body">
    <div id="recentcomments" class="dsq-widget">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:180px;height:150px" data-ad-client="ca-pub-1887364423515042" data-ad-slot="7479875641"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
</div>
  </div>
</section>
</div>
          <div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">Last comments</h3>
  </div>
  <div class="panel-body">
    <div id="disqus_last_comments" class="dsq-widget">
      <script type="text/javascript" src="http://magmax.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=32&amp;excerpt_length=150">
      </script>
</div>
  </div>
</section>
</div>
          <div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="panel-body">
    <ul id="gh_repos" class="list-unstyled">
<li class="loading">Status updating…</li>
    </ul>
</div>
  <div class="panel-footer">
    <a href="https://github.com/magmax">@magmax</a> on GitHub
  </div>
</section>
</div>
      </aside>
</div>

    <footer>
      Contents © 2009-2020 <a href="mailto:">Miguel Ángel García</a> 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/es/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;width:80px;height:15px;vertical-align:middle" src="https://i.creativecommons.org/l/by-nc-sa/2.5/es/80x15.png"></a>; Using <a href="/stories/credits/">a lot of free software</a>
      
    </footer>
</div>
</div>




<a href="http://www.addthis.com/bookmark.php?v=250" id="addthisbox" class="addthis_button" src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" border="0" alt="Share">
<script data-main="/assets/js/main" src="/assets/js/libs/require/require.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9308241-3', 'auto');
  ga('send', 'pageview');

</script></a>
</body>
</html>
