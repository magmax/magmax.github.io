<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Apache: Autenticación básica - El blog de MagMax</title><meta name="Description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ..."><meta property="og:title" content="Apache: Autenticación básica" />
<meta property="og:description" content="Este artículo va a tratar de responder a una pregunta que me hicieron hace poco. Como bien sabéis, estoy dispuesto a responder vuestras preguntas, aunque puedo tardar un poco.
Por eso en esta ocasión veremos un tema un poco anticuado pero igualmente útil: cómo evitar el acceso a un directorio mediante una contraseña.
Hay dos soluciones básicas: la primera, mediante un archivo .htaccess. La segunda, modificando la forma de acceso." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/apache-auth/" />
<meta property="og:image" content="https://magmax.org/icons/favicon.png"/>
<meta property="article:published_time" content="2012-02-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="Apache: Autenticación básica"/>
<meta name="twitter:description" content="Este artículo va a tratar de responder a una pregunta que me hicieron hace poco. Como bien sabéis, estoy dispuesto a responder vuestras preguntas, aunque puedo tardar un poco.
Por eso en esta ocasión veremos un tema un poco anticuado pero igualmente útil: cómo evitar el acceso a un directorio mediante una contraseña.
Hay dos soluciones básicas: la primera, mediante un archivo .htaccess. La segunda, modificando la forma de acceso."/>
<meta name="application-name" content="El blog de MagMax">
<meta name="apple-mobile-web-app-title" content="El blog de MagMax"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/apache-auth/" /><link rel="prev" href="https://magmax.org/blog/tuenti-un-mes/" /><link rel="next" href="https://magmax.org/blog/alternativas/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Apache: Autenticación básica",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/apache-auth\/"
        },"genre": "posts","keywords": "apache","wordcount":  578 ,
        "url": "https:\/\/magmax.org\/blog\/apache-auth\/","datePublished": "2012-02-13T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Miguel Ángel"},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/apache-auth/" selected>Español</option></select>
                    </a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/apache-auth/" selected>Español</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Apache: Autenticación básica</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Miguel Ángel</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="13 Feb 2012">13 Feb 2012</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;578 palabras&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;3 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#autenticación">Autenticación</a>
      <ul>
        <li><a href="#htaccess">.htaccess</a>
          <ul>
            <li><a href="#htgroups">htgroups</a></li>
            <li><a href="#seguridad">Seguridad</a></li>
            <li><a href="#mod_rewrite">mod_rewrite</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#más-información">Más información</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Este artículo va a tratar de responder a una pregunta que me hicieron hace poco. Como bien sabéis, estoy dispuesto a responder vuestras preguntas, aunque puedo tardar un poco.</p>
<p>Por eso en esta ocasión veremos un tema un poco anticuado pero igualmente útil: cómo evitar el acceso a un directorio mediante una contraseña.</p>
<p>Hay dos soluciones básicas: la primera, mediante un archivo <code>.htaccess</code>. La segunda, modificando la forma de acceso.</p>
<figure>
    <img src="/images/apache-http-server.jpg"
         alt="Apache HTTP Server"/> 
</figure>

<h2 id="autenticación">Autenticación</h2>
<h3 id="htaccess">.htaccess</h3>
<p>En el directorio que queráis restringir el acceso, creáis un archivo llamado <code>.htaccess</code>. Este archivo contendrá algo similar a lo siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cfg" data-lang="cfg"><span class="na">AuthUserFile /home/magmax/.htpasswd</span>
<span class="na">AuthGroupFile /dev/null</span>
<span class="na">AuthName MagMax page</span>
<span class="na">AuthType Basic</span>
<span class="na">require valid-user</span>
</code></pre></td></tr></table>
</div>
</div><p>De esta manera le decimos a <em>apache</em> que debe pedir una contraseña, mostrando el
mensaje indicado en <code>AuthName</code>, y que el usuario debe coincidir con alguno de
los que se encuentran en el fichero indicado por <code>AuthUserFile</code>.</p>
<p>Ahora es cuando se crea el archivo indicado por <code>AuthUserFile</code>, que sería algo así:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ htpasswd -c /home/magmax/.htpasswd magmax
New password:
Re-type new password:
Adding password <span class="k">for</span> user magmax
$
</code></pre></td></tr></table>
</div>
</div><p>Tened cuidado con la opción <code>-c</code>, ya que crea el archivo, eliminando lo que hubiera anteriormente. Si queréis añadir más usuarios sólo tenéis que quitar esa opción. El resultado será un fichero como el que sigue:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat file
magmax:<span class="nv">$apr1$lqzJHMvm$XPYqylsRK7q2gmThL</span>..gy1
</code></pre></td></tr></table>
</div>
</div><h4 id="htgroups">htgroups</h4>
<p>Es posible que queráis tener un archivo con todas las contraseñas y limitar el
acceso a un directorio sólo para una parte de estos usuarios. Para ello podéis
usar la opción <code>AuthGroupFile</code> que en el ejemplo puse a <code>/dev/null</code>.</p>
<p>El formato de este archivo sería el que sigue:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cfg" data-lang="cfg"><span class="na">amigos: magmax tiouron pollo</span>
</code></pre></td></tr></table>
</div>
</div><p>Y ahora hay que realizar dos pequeñas modificaciones al fichero de configuración:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cfg" data-lang="cfg"><span class="na">AuthUserFile /home/magmax/.htpasswd</span>
<span class="na">AuthGroupFile /home/magmax/.htgroups</span>
<span class="na">AuthName MagMax page</span>
<span class="na">AuthType Basic</span>
<span class="na">require group amigos</span>
</code></pre></td></tr></table>
</div>
</div><p>Creo que no requiere más explicaciones.</p>
<h4 id="seguridad">Seguridad</h4>
<p>Por cuestiones de seguridad es mejor que los archivos <code>.htpasswd</code> y <code>.htgroups</code> (al menos el primero) estén en algún lugar no compartido, es decir, fuera de nuestra web. En teoría, al empezar por un punto no son accesibles, pero si están fuera de nuestra web, seguro que no son accesibles XD</p>
<h4 id="mod_rewrite">mod_rewrite</h4>
<p><code>mod_rewrite</code> es un <em>plugin</em> para <em>apache</em>. En este caso tendréis que hacer uso de expresiones regulares, lo que puede complicar el temilla y&hellip; fallar. Como dijo Jamie Zawinski:</p>
<blockquote>
<p>Some people, when confronted with a problem, think &ldquo;I know, I&rsquo;ll use regular expressions.&rdquo; Now they have two problems.</p>
</blockquote>
<blockquote>
<p>Hay gente que, cuando se enfrenta a un problema, piensa &ldquo;Ya sé, usaré expresiones regulares&rdquo;. Ahora tienen dos problemas.</p>
</blockquote>
<p>De todas maneras, es una opción a evaluar:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cfg" data-lang="cfg"><span class="na">RewriteRule ^[a-z0-9_-]*-f([0-9]+)/?(p([0-9]+)\.html)?$ /viewforum.php?f</span><span class="o">=</span><span class="s">$1&amp;start=$3 [QSA,L,NC]</span>
</code></pre></td></tr></table>
</div>
</div><p>Si os sentís cómodos con algo así, os invito a que miréis la documentación de <em>rewrite</em> para ver qué significa cada cosa.</p>
<p>He decidido comentar esto porque si usáis <a href="https://nginx.com/" target="_blank" rel="noopener noreffer">nginx</a> , un servidor web que está bastante de moda hoy día, no tendréis el módulo <code>mod_rewrite</code> y no podréis usar la primera opción. Claro, que la segunda tampoco porque las expresiones regulares son diferentes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cfg" data-lang="cfg"><span class="na">rewrite ^/[a-z0-9_-]*-f([0-9]+)/?(p([0-9]+)\.html)?$ /viewforum.php?f</span><span class="o">=</span><span class="s">$1&amp;start=$3 last;</span>
</code></pre></td></tr></table>
</div>
</div><p>Y esto es algo que os cuento, pero de lo que no tengo ni idea. Tan sólo lo he copiado para dar una visión más completa del tema. Yo siempre utilizo un archivo <em>.htaccess</em></p>
<h2 id="más-información">Más información</h2>
<p>No hay nada que no haya sacado de Google, en concreto de <a href="https://www.euronet.nl/~arnow/htpasswd/documentation.html" target="_blank" rel="noopener noreffer">aquí</a>.</p>
<p>La parte del rewrite la he sacado de <a href="https://serverfault.com/questions/24243/nginx-support-for-htaccess-rewrite-rules-differences-from-apache" target="_blank" rel="noopener noreffer">serverfault</a>.</p>
<p>Espero que os sea de alguna utilidad.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/apache-auth/" data-title="Apache: Autenticación básica" data-hashtags="apache"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/apache-auth/" data-hashtag="apache"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/apache-auth/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/apache-auth/" data-title="Apache: Autenticación básica" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/apache-auth/" data-title="Apache: Autenticación básica" data-tags="apache"><i class="fab fa-tumblr fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/apache-auth/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/apache-auth/" data-title="Apache: Autenticación básica" data-description=""><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Compartir en Digg" data-sharer="digg" data-url="https://magmax.org/blog/apache-auth/"><i class="fab fa-digg fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/apache-auth/" data-title="Apache: Autenticación básica" data-description=""><i class="fab fa-blogger fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/apache/">apache</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/tuenti-un-mes/" class="prev" rel="prev" title="Tuenti, un mes después"><i class="fas fa-angle-left fa-fw"></i>Tuenti, un mes después</a>
            <a href="/blog/alternativas/" class="next" rel="next" title="Alternativas">Alternativas<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Provisto por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
