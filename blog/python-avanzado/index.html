<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Python avanzado - El blog de MagMax</title><meta name="Description" content="Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender"><meta property="og:title" content="Python avanzado" />
<meta property="og:description" content="Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/python-avanzado/" />
<meta property="og:image" content="https://magmax.org/icons/favicon.png"/>
<meta property="article:published_time" content="2013-09-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="Python avanzado"/>
<meta name="twitter:description" content="Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender"/>
<meta name="application-name" content="El blog de MagMax">
<meta name="apple-mobile-web-app-title" content="El blog de MagMax"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/python-avanzado/" /><link rel="prev" href="https://magmax.org/blog/python-basico/" /><link rel="next" href="https://magmax.org/blog/java-en-awesome-wm/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Python avanzado",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/python-avanzado\/"
        },"genre": "posts","keywords": "python","wordcount":  2553 ,
        "url": "https:\/\/magmax.org\/blog\/python-avanzado\/","datePublished": "2013-09-30T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Miguel Ángel"},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": "Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender"
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/python-avanzado/" selected>Español</option></select>
                    </a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/python-avanzado/" selected>Español</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Python avanzado</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Miguel Ángel</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="30 Sep 2013">30 Sep 2013</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2553 palabras&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;12 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#métodos-mágicos">Métodos mágicos</a>
      <ul>
        <li><a href="#atributos-bajo-demanda">Atributos bajo demanda</a></li>
        <li><a href="#diccionarios-que-se-comportan-como-objetos">Diccionarios que se comportan como objetos</a></li>
        <li><a href="#objetos-iguales">Objetos iguales</a></li>
        <li><a href="#singleton">Singleton</a></li>
      </ul>
    </li>
    <li><a href="#decoradores">Decoradores</a>
      <ul>
        <li><a href="#staticmethod-y-classmethod">@staticmethod y @classmethod</a></li>
      </ul>
    </li>
    <li><a href="#propiedades">Propiedades</a>
      <ul>
        <li><a href="#properties-y-decorators">Properties y decorators</a></li>
      </ul>
    </li>
    <li><a href="#generadores">Generadores</a></li>
    <li><a href="#with">With</a></li>
    <li><a href="#partials">Partials</a></li>
    <li><a href="#archivos-autoejecutables">Archivos autoejecutables</a></li>
    <li><a href="#diversión">Diversión</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Tras el post de <a href="https://magmax.org/blog/python-basico/" title="Tutorial básico de Python" rel="">Python básico</a> viene el de Python avanzado. Sin embargo, la diferencia entre uno y otro es bastante grande. Advierto a los novatos que esta parte es mucho más difícil. Me he planteado hacer un &ldquo;Python intermedio&rdquo;, pero creo que esa parte la dará la experiencia. Recomiendo practicar haciendo pequeños programas en Python antes de intentar abordar esta parte.</p>
<p>Si alguien tiene dudas, siempre puede volver a consultar el artículo de <a href="https://magmax.org/blog/python-basico/" title="Tutorial básico de Python" rel="">Python básico</a>.</p>
<p>Espero haber cubierto suficiente materia como para que queden claros los conceptos principales.</p>
<figure>
    <img src="/images/python.png"
         alt="Python"/> 
</figure>

<h2 id="métodos-mágicos">Métodos mágicos</h2>
<p>Existen algunos métodos que nos permiten alterar el comportamiento habitual de nuestras clases. Por ejemplo, está el método <code>__getattr__</code>, que se ejecutará cuando tratemos de acceder a un atributo que no exista y, por lo tanto, podremos alterar el comportamiento habitual que consiste en lanzar una excepción:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Example1</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>    <span class="k">pass</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Example2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
<span class="o">...</span>       <span class="k">print</span> <span class="s1">&#39;Invalid attribute:&#39;</span><span class="p">,</span> <span class="n">attr</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e1</span> <span class="o">=</span> <span class="n">Example1</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e1</span><span class="o">.</span><span class="n">whatever</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&#34;&lt;stdin&gt;&#34;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;Example1&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;whatever&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e2</span> <span class="o">=</span> <span class="n">Example2</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e2</span><span class="o">.</span><span class="n">whatever</span>
<span class="n">Invalid</span> <span class="n">attribute</span><span class="p">:</span> <span class="n">whatever</span>
</code></pre></td></tr></table>
</div>
</div><p>Algunos de estos métodos mágicos son:</p>
<ul>
<li><code>__getattr__</code> se ejecuta al acceder a un atributo inexistente.</li>
<li><code>__setattr__</code> se ejecuta al intentar modificar un atributo inexistente.</li>
<li><code>__delattr__</code> se ejecuta al eliminar el atributo.</li>
<li><code>__getattribute__</code>se ejecuta antes de intentar acceder a cualquier atributo.</li>
<li><code>__new__</code> se llama antes de crear un objeto de la clase, cuando el objeto aún no existe.</li>
<li><code>__init__</code> se llama justo después de crear el objeto. Es el equivalente a un constructor.</li>
<li><code>__del__</code> se llama justo antes de destruir el objeto. Sin embargo, la destrucción de un objeto puede no realizarse al invocar al método <code>del</code>.</li>
<li><code>__repr__</code> debe devolver una representación del objeto, ya que se llamará por <code>repr()</code>.</li>
<li><code>__str__</code> es una representación &ldquo;informal&rdquo; del objeto, y se llamará con <code>str()</code> o con <code>print()</code></li>
<li><code>__lt__</code>, <code>__le__</code>, <code>__eq__</code>, <code>__ne__</code>, <code>__gt__</code>, <code>__ge__</code> permiten sobreescribir las comparaciones, aunque también se puede utilizar:</li>
<li><code>__cmp__</code>, para realizar comparaciones</li>
<li><code>__hash__</code> debe devolver un identificador único para el objeto</li>
</ul>
<p>Otros métodos mágicos nos sirven para permitir que nuestras clases se comporten como listas o diccionarios:</p>
<ul>
<li><code>__len__</code> se consulta al ejecutar <code>len()</code></li>
<li><code>__getitem__</code> llamado al evaluar <code>self[key]</code></li>
<li><code>__setitem__</code> llamado al asignar a <code>self[key]</code></li>
<li><code>__delitem__</code> llamado con <code>del(self[key])</code></li>
<li><code>__iter__</code> solicita un iterador.</li>
<li><code>__reversed__</code> iterador inverso.</li>
</ul>
<p>Hay muchos, MUCHOS métodos mágicos. Algunos son para secuencias, otros para contenedores, y otros para operaciones matemáticas. Podéis consultar la lista completa en el <a href="https://docs.python.org/2/reference/datamodel.html" title="Python Data Model" target="_blank" rel="noopener noreffer">Python Data Model</a></p>
<p>Veamos ahora el uso práctico que pueden tener algunos de ellos:</p>
<h3 id="atributos-bajo-demanda">Atributos bajo demanda</h3>
<p>En python todo funciona como si fuera una tabla <em>Hash</em> o, en nomenclatura más <em>pythónica</em>, un diccionario. Existe un método mágico llamado <code>__dict__</code>, que es un atributo de sólo lectura que contine los valores del resto de atributos de un objeto.</p>
<p>Y podemos aprovecharnos de esta propiedad para hacer objetos que &ldquo;mutan&rdquo; de acuerdo a su inicialización:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>El ejemplo actual crea una clase cuyos objetos contendrán como atributos cualquier cosa que se haya pasado como atributos nombrados:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">var2</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var1</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var2</span>
<span class="s1">&#39;hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="diccionarios-que-se-comportan-como-objetos">Diccionarios que se comportan como objetos</h3>
<p>Otra característica que puede sernos de utilidad es tener un diccionario que se comporta como un objeto, es decir, que permite acceder a sus elementos como atributos. Esta característica puede hacer nuestro código más fácil de leer:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">DictObject</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></td></tr></table>
</div>
</div><p>Ahora podemos acceder al objeto como diccionario u objeto:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">DictObject</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">one</span>
<span class="s1">&#39;hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span>
<span class="s1">&#39;hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Esto tiene una limitación: como los nombres de variables no pueden comenzar por números, contener espacios ni otros signos de puntuación, es posible que nunca podamos acceder a algunos valores:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">DictObject</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="s1">&#39;hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="mi">1</span>
<span class="ne">SyntaxError</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">syntax</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="objetos-iguales">Objetos iguales</h3>
<p>La igualdad entre objetos es relativa. En una ocasión necesité (haciendo un pequeño entorno de pruebas) un objeto que me permitiera insertar cualquier cosa. La solución habitual es ésta:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ANYTHING</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ANYTHING</span><span class="p">,</span> <span class="s1">&#39;hola&#39;</span><span class="p">):</span> <span class="k">pass</span> <span class="c1"># some stuff</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Sin embargo hay otra forma más bonita de hacer las cosas:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">MatchEverything</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="bp">True</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ANYTHING</span> <span class="o">=</span> <span class="n">MatchEverything</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">ANYTHING</span><span class="p">:</span> <span class="k">pass</span> <span class="c1"># some stuff</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>En este segundo caso no es necesario comprobar si vale un valor concreto, ya que la propia comparación resolverá el problema. Limpio y sencillo.</p>
<p>Esta solución permite crear otro tipo de objetos interesantes, como <code>StringContaining</code>, <code>PositiveNumber</code> y otros objetos curiosos:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">StringContaining</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">_pattern</span> <span class="o">=</span> <span class="n">pattern</span>

   <span class="k">def</span> <span class="fm">__cmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pattern</span> <span class="ow">in</span> <span class="n">other</span>

<span class="n">called_me</span> <span class="o">=</span> <span class="n">StringContaining</span><span class="p">(</span><span class="s1">&#39;MagMax&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">called_me</span><span class="p">(</span><span class="s1">&#39;Hello, MagMax&#39;</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;What do you want?&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="singleton">Singleton</h3>
<p>Estos métodos mágicos también pueden utilizarse para implementar <a href="https://magmax.org/blog/patron-singleton/" title="Patrón Singleton" rel="">el patrón Singleton</a>. Este patrón es bastante controvertido, ya que las probabilidades de usarlo bien son más bien reducidas.</p>
<p>Es precisamente por esa razón que no lo explicaré aquí.</p>
<h2 id="decoradores">Decoradores</h2>
<p>Existe la posibilidad de crear funciones que se ejecutarán con otras funciones. A esto se le denomina <em>decorators</em>. Tanto en Python como en Java comienzan por una arroba (<code>@</code>).</p>
<p>Hay distintas maneras de crear un <em>decorator</em>. La más sencilla es crear una función que devuelve una función:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">timed</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;ellapsed:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inner</span>

<span class="nd">@timed</span>
<span class="k">def</span> <span class="nf">example</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">example</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>En este pequeño programa se crea un <em>decorator</em> llamado <code>timed</code>. Posteriormente se crea un método <code>example</code> empleando el <em>decorator</em>. La salida de la llamada final será:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">5</span>
<span class="n">ellapsed</span><span class="p">:</span> <span class="mf">0.000157833099365</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Conviene fijarse en ciertos aspectos:</p>
<ul>
<li>No confío en el número de argumentos que puedan llegar al <em>decorator</em>. Habitualmente se procederá así.</li>
<li>No confío en que el método no lance excepciones, y las dejo pasar.</li>
<li>No interfiero en el resultado del método.</li>
</ul>
<p>Los decoradores son muy potentes, pero hay que manejarlos con cabeza, ya que pueden tener demasiada &ldquo;magia&rdquo;. Un ejemplo de lo que <strong>NO DEBE HACERSE BAJO NINGÚN CONCEPTO</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">catch_pokemon</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">inner</span>
</code></pre></td></tr></table>
</div>
</div><p>Estoy convencido que, si habéis llegado hasta aquí, sabéis por qué no debe hacerse. A este error se le suele denominar &ldquo;catch pokémon&rdquo;, y cometerlo en un decorador puede ser terriblemente difícil de encontrar. Ya sabéis: un gran poder conlleva una gran responsabilidad.</p>
<h3 id="staticmethod-y-classmethod">@staticmethod y @classmethod</h3>
<p>Hay algunos decoradores definidos en la librería estándar, como son <code>@staticmethod</code> y <code>@classmethod</code>. ¿Cuándo se debe usar cada uno de ellos?</p>
<p>El primero, <code>@staticmethod</code>, se utiliza para crear métodos que no requieren nada de la clase principal.</p>
<p>El segundo, <code>@classmethod</code>, recibirá la clase como primer argumento, por si se necesita utilizar para algo. Se suele llamar <code>cls</code> por convención.</p>
<p>Como norma general, no los utilicéis. He aquí una regla con los métodos estáticos: si tienes un método estático que llama a otro método estático, plantéate que puedes estar haciéndolo mal (habrá casos justificados, claro está).</p>
<p>Ambos tienen un uso muy interesante a la hora de crear <em>Factories</em>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">MySqlConnection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># ...</span>
<span class="k">class</span> <span class="nc">InMemmoryConnection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># ...</span>
<span class="k">class</span> <span class="nc">DBConnection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_connection</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="o">*</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mysql&#39;</span><span class="p">:</span> <span class="n">MySqlConnection</span><span class="p">,</span> <span class="s1">&#39;memory&#39;</span><span class="p">:</span> <span class="n">InMemoryConnection</span><span class="p">}</span>
        <span class="n">clazz</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">clazz</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown database type&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">clazz</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>A veces también nos pueden valer para crear <em>Builders</em>, pero no debería ser lo habitual:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">Wheel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># ...</span>
<span class="k">class</span> <span class="nc">Engine</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># ...</span>
<span class="k">class</span> <span class="nc">Car</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># ...</span>
<span class="k">class</span> <span class="nc">CarMaker</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_seat_127</span><span class="p">():</span>
        <span class="n">car</span> <span class="o">=</span> <span class="n">Car</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">wheel</span> <span class="o">=</span> <span class="n">Wheel</span><span class="p">()</span>
            <span class="c1"># set here wheel parameters</span>
            <span class="n">car</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">wheel</span><span class="p">)</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">Engine</span><span class="p">()</span>
        <span class="c1"># set here engine parameters</span>
        <span class="n">car</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
        <span class="c1"># ...</span>
        <span class="k">return</span> <span class="n">car</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="propiedades">Propiedades</h2>
<p>Hay lenguajes que animan a construir modelos anémicos, es decir, clases que sólo contienen <em>getters</em> y <em>setters</em>. En Python esto está completamente desaconsejado, ya que tenemos as <em>properties</em>.</p>
<p>Básicamente, una <em>property</em> consiste en un <em>getter</em> y/o <em>setter</em> que se maneja como un atributo. Esto permite transformar un atributo en una <em>property</em> en el momento en que es necesario, de manera que el uso siga siendo el mismo.</p>
<p>Veamos un ejemplo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Supongamos que tenemos la clase <code>Example</code> con el atributo <code>var</code>. Por requisitos del programa, queremos que <code>var</code> devuelva siempre el doble de su valor. Eso es un problema, ya que es un atributo&hellip; o no:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_var</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">get_var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">set_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_var</span> <span class="o">=</span> <span class="n">value</span>
<span class="o">...</span>     <span class="n">var</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_var</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Aquí han ocurrido varias cosas: lo primero hemos renombrado la variable <code>var</code> para que sea diferente. A menudo se empleará un <em>underscore</em> para indicar que es una variable privada (aunque en Python no hay nada privado realmente, es sólo notación). A continuación se crea la función con el <em>getter</em> y, finalmente, se crea la <em>property</em> con el nombre que tenía antes la variable.</p>
<p>Desde ese momento se ejecutará el <em>getter</em> cuando se intente acceder a la propiedad.</p>
<p>La función <em>builtin</em> <code>property</code> tiene los siguientes argumentos:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="nb">property</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span> <span class="n">setter</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>De manera que nos permite sobreescribir el <em>getter</em>, <em>setter</em>, el destructor o la documentación.</p>
<h3 id="properties-y-decorators">Properties y decorators</h3>
<p>Existe otra manera más sencilla de hacer lo mismo pero con <em>decorators</em>. Así, éste es el mismo ejemplo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_var</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">...</span>     <span class="nd">@property</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var</span>
<span class="o">...</span>     <span class="nd">@var.setter</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_var</span> <span class="o">=</span> <span class="n">value</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">example</span><span class="o">.</span><span class="n">var</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Los métodos del decorador serían <code>setter</code>, <code>getter</code> y <code>deleter</code>, por lo que podemos hacer lo mismo que con <code>property</code>.</p>
<h2 id="generadores">Generadores</h2>
<p>Finalmente, y como concepto avanzado, aquí están los generadores. Consisten en funciones que producen elementos, pero la función queda en memoria para poder producir más elementos. Es el caso de la función <code>range</code> (en versiones anteriores a la 3.0 era <code>xrange</code>), que podría implementarse así:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">my_range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">current</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">a</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">a</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">b</span>

    <span class="k">while</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">current</span>
        <span class="n">current</span> <span class="o">+=</span> <span class="n">step</span>
</code></pre></td></tr></table>
</div>
</div><p>Veamos un ejemplo más sencillo aún: lo mismo, pero sin enrevesar los argumentos:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">my_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">start</span>

    <span class="k">while</span> <span class="n">current</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">current</span>
        <span class="n">current</span> <span class="o">+=</span> <span class="n">step</span>
</code></pre></td></tr></table>
</div>
</div><p>Como puede observarse, se utiliza la cláusula <code>yield</code>. Ésta es como un <code>return</code>, pero la función no termina. De esta manera se pueden recorrer todos los elementos. Puede haber elementos infinitos.</p>
<p>Esto, junto con algunos principios más, da lugar a la programación funcional.</p>
<h2 id="with">With</h2>
<p>Existe un elemento más muy curioso: <code>with</code>. A menudo resulta difícil de entender cuando es muy sencillo: simplemente invoca a los métodos <code>__enter__</code> y <code>__exit__</code> al comienzo y final del bloque, respectivamente. Esto da lugar a situaciones muy divertidas.</p>
<p>Por ejemplo, el método <code>open</code> abre un archivo, pero el objeto que devuelve soporta estas operaciones. Por eso podemos abrir un archivo de la siguiente manera, con la seguridad de que siempre se cerrará:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><p>El equivalente (más o menos) sin el <code>with</code> sería algo así:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Como puede observarse, mucho más complejo.</p>
<h2 id="partials">Partials</h2>
<p>A menudo es necesario escribir el mismo método varias veces cambiando únicamente un parámetro. En estos casos, podemos sobreescribirlo de una manera mucho más sencilla, creando una función igual pero con uno de los parámetros fijos. A esto es a lo que se conoce como <em>partial method</em>.</p>
<p>Esta utilidad se encuentra en el módulo <a href="https://docs.python.org/2/library/functools.html" title="Higher-order functions and operations on callable objects" target="_blank" rel="noopener noreffer">functool</a>. Veamos un ejemplo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">print</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,)</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">functools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="p">()</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,)</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Como se ve en el ejemplo, <code>b</code> es una función parcial de <code>f</code>, en la que tenemos algunos métodos predefinidos. Es decir, sería equivalente a:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
   <span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="archivos-autoejecutables">Archivos autoejecutables</h2>
<p><a href="https://python.org/" title="Web oficial de Python" target="_blank" rel="noopener noreffer">Python</a> dispone de un fuerte soporte para archivos comprimidos <a href="https://es.wikipedia.org/wiki/Formato_de_compresi%C3%B3n_ZIP" title="Formato de compresión Zip (wikipedia)" target="_blank" rel="noopener noreffer">Zip</a>. Podemos hacer la siguiente prueba: Escribid en un archivo llamado <em>__main__.py</em> la línea <code>print &quot;hello world&quot;</code>. Ahora podemos comprimirlo con <code>zip</code> y tratamos de ejecutarlo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat __main__.py
print <span class="s2">&#34;hello, world&#34;</span>
$ zip example __main__.py
  adding: __main__.py <span class="o">(</span>stored 0%<span class="o">)</span>
$ python example.zip
hello, world
$
</code></pre></td></tr></table>
</div>
</div><p>¡Magia! El archivo se ha ejecutado como si fuera un único archivo python.</p>
<h2 id="diversión">Diversión</h2>
<p>Python se desarrolla por la comunidad, y a la comunidad le gusta divertirse&hellip; Por eso hay escondidos algunos &ldquo;Easter Eggs&rdquo;.</p>
<p>El primero de ellos sirve para mostrar &ldquo;El Zen de Python&rdquo;. Basta con ejecutar:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ python -m this
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren<span class="s1">&#39;t special enough to break the rules.
</span><span class="s1">Although practicality beats purity.
</span><span class="s1">Errors should never pass silently.
</span><span class="s1">Unless explicitly silenced.
</span><span class="s1">In the face of ambiguity, refuse the temptation to guess.
</span><span class="s1">There should be one-- and preferably only one --obvious way to do it.
</span><span class="s1">Although that way may not be obvious at first unless you&#39;</span>re Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it<span class="s1">&#39;s a bad idea.
</span><span class="s1">If the implementation is easy to explain, it may be a good idea.
</span><span class="s1">Namespaces are one honking great idea -- let&#39;</span>s <span class="k">do</span> more of those!
</code></pre></td></tr></table>
</div>
</div><p>El segundo surgió de una broma de XKCD, donde se mencionaba Python. Si veis la broma entenderéis por qué se lanza así:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ python -m antigravity
</code></pre></td></tr></table>
</div>
</div><h1 id="más-información">Más información</h1>
<p>El mejor sitio para obtener información básica de este lenguaje sigue siendo la propia documentación de Python.</p>
<p>Y vuelvo a recomendar los libros <a href="https://www.diveintopython.net/" target="_blank" rel="noopener noreffer">Dive into Python</a>, de Mark Pilgrim, que es gratuíto y se puede descargar de esa misma dirección y también <a href="https://propython.com/" target="_blank" rel="noopener noreffer">Pro Python</a>, de <a href="https://martyalchin.com/" target="_blank" rel="noopener noreffer">Marty Alchin</a>.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/python-avanzado/" data-title="Python avanzado" data-hashtags="python"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/python-avanzado/" data-hashtag="python"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/python-avanzado/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/python-avanzado/" data-title="Python avanzado" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/python-avanzado/" data-title="Python avanzado" data-caption="Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender" data-tags="python"><i class="fab fa-tumblr fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/python-avanzado/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/python-avanzado/" data-title="Python avanzado" data-description="Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender"><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Compartir en Digg" data-sharer="digg" data-url="https://magmax.org/blog/python-avanzado/"><i class="fab fa-digg fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/python-avanzado/" data-title="Python avanzado" data-description="Estructuras Python más avanzadas, incluyendo decorators, generators, y otras estructuras difíciles de comprender"><i class="fab fa-blogger fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/python/">python</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/python-basico/" class="prev" rel="prev" title="Python básico"><i class="fas fa-angle-left fa-fw"></i>Python básico</a>
            <a href="/blog/java-en-awesome-wm/" class="next" rel="next" title="Micro-receta: Java en Awesome WM">Micro-receta: Java en Awesome WM<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Provisto por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-9308241-3', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-9308241-3" async></script></body>
</html>
