<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="max-age=43200">
<meta http-equiv="ETag" content="b'2c87e47779fbd58d747b6211986592a22beba19d'">
<title>Do not comment. Assert it! | MagMax Blog</title>
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="/assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="/assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/magmax">
<link rel="canonical" href="http://magmax.org/en/blog/asegura/">
<link rel="icon" href="/favicon_330.png" sizes="330x330">
<link rel="icon" href="/favicon.png" sizes="128x128">
<link rel="icon" href="/favicon.ico" sizes="16x16">
<meta name="author" content="Miguel Ángel García">
<link rel="prev" href="/en/blog/netbeans-and-templates/" title="Netbeans and Templates" type="text/html">
<link rel="next" href="/en/blog/django-sitio-basico/" title="Django: Building a basic site with Admin" type="text/html">
<meta property="og:site_name" content="MagMax Blog">
<meta property="og:title" content="Do not comment. Assert it!">
<meta property="og:url" content="http://magmax.org/en/blog/asegura/">
<meta property="og:description" content="Today I have discovered lots of things about this great unknown assert.
It happens that I had a very strong debugging tool too close from myself and I hadn't used it.
Trying to fix this problem, I wri">
<meta property="og:type" content="article">
<meta property="article:author" content="Miguel Ángel García">
<meta property="article:published_time" content="2011-08-14T00:00:00+00:00">
<meta property="article:updated" content="2011-08-14T00:00:00">
<meta property="article:tag" content="agile">
<meta property="article:tag" content="engineering">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@magmax_en">
<meta name="twitter:creator" content="@magmax">
<meta name="twitter:title" content="MagMax Blog">
<meta name="twitter:description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ...">
<meta name="twitter:url" content="http://magmax.org//en/blog/asegura/">
<meta name="twitter:image" content="http://magmax.org/favicon.png">
<link rel="alternate" hreflang="es" href="/blog/asegura/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://magmax.org/en/">

        <span id="blog-title">MagMax Blog</span>
      </a>
    </div>
<!-- /.navbar-header -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav">
<li>
<a href="/">Home</a>
                </li>
<li>
<a href="/archive.html">Archives</a>
                </li>
<li>
<a href="/categories">Tags</a>
                </li>
<li>
<a href="/projects">Projects</a>
                </li>
<li>
<a href="/news">External Posts</a>

        
      </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
<form class="navbar-form navbar-left" role="search" action="http://google.com/search" method="get">
<div class="form-group">
<input type="hidden" name="sitesearch" value="magmax.org"><input type="text" name="q" class="form-control" placeholder="Search / Buscar">
</div>
</form>
</li>

        <li style="margin-left:0">
          <a href="http://feeds.feedburner.com/magmax">
            <img src="/assets/images/rss.png" style="width:22px;height:22px"></a>
        </li>

        
      </ul>
</div>
<!-- /.navbar-collapse -->
  </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
  <div class="body-content">
    <div class="row">
      <div class="page-content col-md-9">
        
        <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="/en/blog/asegura/" class="u-url">Do not comment. Assert it!</a></h1>
            <div class="metadata text-muted">
              <i class="glyphicon glyphicon-calendar"></i>
              <p class="dateline">
                <time class="published dt-published" datetime="2011-08-14T00:00:00+00:00" title="2011-08-14">2011-08-14</time>
                // <time class="updated dt-updated" datetime="2011-08-14T00:00:00" title="2011-08-14">2011-08-14</time></p>
              <p class="commentline">            <a href="/en/blog/asegura/#disqus_thread" data-disqus-identifier="cache/posts/asegura.html">Comments</a>

</p>
              <address class="vcard author"><a class="url fn" href="http://magmax.org">Miguel Ángel García</a></address>
            </div>
            <br><div class="metadata posttranslations translations">
              <h3 class="posttranslations-intro">Also available in:</h3>
              <p><a href="/blog/asegura/" rel="alternate" hreflang="es"><img src="/images/es.png"> Español</a></p>
            </div>
          </header><div class="e-content entry-content" itemprop="articleBody text">
            <div>
<p>Today I have discovered lots of things about this great unknown <em>assert</em>.</p>
<p>It happens that I had a very strong debugging tool too close from myself and I hadn't used it.</p>
<p>Trying to fix this problem, I write this article, but I am not going to write anything that is not already written at <a class="reference external" href="http://download.oracle.com/javase/6/docs/technotes/guides/language/assert.html">Java Assert Documentation</a>  or <a class="reference external" href="http://docs.python.org/release/2.5.2/ref/assert.html">Python Documentation</a> .</p>
<!-- TEASER_END -->
<div class="section" id="the-more-basic">
<h2>The more basic</h2>
<p>First step is to know how to use it. You can use it in two ways: with one or two parameters. The second one will be a text to be shown with the exception when the first one do not match.</p>
<p>Using python:</p>
<pre class="code python"><a name="rest_code_f5340dbca00e4052b3ec2f21a67a2f2c-1"></a><span class="k">assert</span> <span class="n">expression</span>
<a name="rest_code_f5340dbca00e4052b3ec2f21a67a2f2c-2"></a><span class="k">assert</span> <span class="n">expression1</span><span class="p">,</span> <span class="n">expression2</span>
</pre>
<p>And using Java:</p>
<pre class="code java"><a name="rest_code_a8f4d5d5d4274ddbb81ae194eaf5f694-1"></a><span class="k">assert</span> <span class="n">expression</span><span class="o">;</span>
<a name="rest_code_a8f4d5d5d4274ddbb81ae194eaf5f694-2"></a><span class="k">assert</span> <span class="n">expression1</span> <span class="o">:</span> <span class="n">expression2</span><span class="o">;</span>
</pre>
<p>It is important to highlight that, if <em>expression1</em> is not evaluated as true, second one will not be executed. usually, this second expression must return a string.</p>
</div>
<div class="section" id="do-not-use-assert">
<h2>Do not use Assert!!</h2>
<p>You are not going to use a pneumatic hammer to tighten a screw, so you cannot use <em>assert</em> everywhere.</p>
<p>You must not use it in next cases:</p>
<ul class="simple">
<li>
<em>Public Methods</em>: This is an aesthetic point, because it would be horrible to find an "Assertion Error". It is better to find a "Some error happened", so it is better to use a comparation and an exception. In addition, you can <em>disable</em> asserts, so you can break off checking the public method input.</li>
<li>
<em>To do useful stuff</em> inside a method, because asserts can be disabled and it would break off doing that job.</li>
</ul>
</div>
<div class="section" id="use-assert">
<h2>Use Assert!!</h2>
<p>Usually, we tend to write comments like "Everything OK", "It must not get here", etc. This kind of comments is a problem because they can become lies and, in the other hand, nobody is checking them.</p>
<p>In addition, you need too much letters to say the same (comment compared with the equivalent <em>assert</em>):</p>
<pre class="code python"><a name="rest_code_303c8d9aa3504340bdb4699728047dcd-1"></a><span class="c"># value must be greater than five</span>
<a name="rest_code_303c8d9aa3504340bdb4699728047dcd-2"></a><span class="k">assert</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span>
</pre>
<pre class="code java"><a name="rest_code_3597abcbe67c47e5b4f9519c2e7121c4-1"></a><span class="c1">// value must be greater thatn five</span>
<a name="rest_code_3597abcbe67c47e5b4f9519c2e7121c4-2"></a><span class="k">assert</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">;</span>
</pre>
<p>When you have a switch, it is very common to forgive the default case, because you are not going to arrive that place. Maybe. What happens if anybody writes another option? We can be sure to manage them:</p>
<pre class="code java"><a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-1"></a><span class="k">switch</span> <span class="o">(</span><span class="n">var</span><span class="o">)</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-2"></a><span class="o">{</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-3"></a>    <span class="k">case</span> <span class="n">value1</span><span class="o">:</span> <span class="n">do_stuff_1</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-4"></a>    <span class="k">case</span> <span class="n">value2</span><span class="o">:</span> <span class="n">do_stuff_2</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-5"></a>    <span class="o">...</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-6"></a>    <span class="k">case</span> <span class="n">valueN</span><span class="o">:</span> <span class="n">do_stuff_N</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-7"></a>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-8"></a><span class="nl">   default:</span> <span class="k">assert</span> <span class="n">False</span><span class="o">,</span> <span class="s">"You must not be here!"</span><span class="o">;</span>
<a name="rest_code_1ee8757b844d4c7b9f5ea3d4b7b57fde-9"></a><span class="o">}</span>
</pre>
</div>
<div class="section" id="preconditions-and-postconditions">
<h2>Preconditions and Postconditions</h2>
<p>One of my favourite uses is to check inputs and outputs. For example, we have a function that returns the factorial of a given number, and it must be sure that input is bigger than 1 (and not negative). If it is not a public method:</p>
<pre class="code python"><a name="rest_code_36b3db8220a14825b62895d6ed749739-1"></a><span class="k">def</span> <span class="nf">factorial</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a name="rest_code_36b3db8220a14825b62895d6ed749739-2"></a>  <span class="k">assert</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"Invalid value:"</span> <span class="o">+</span> <span class="n">n</span><span class="p">;</span>
<a name="rest_code_36b3db8220a14825b62895d6ed749739-3"></a>
<a name="rest_code_36b3db8220a14825b62895d6ed749739-4"></a>  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
<a name="rest_code_36b3db8220a14825b62895d6ed749739-5"></a>  <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre>
<p>We can assure we didn't leave an invalid value:</p>
<pre class="code java"><a name="rest_code_736a4a98b631490a99190d294bee95e1-1"></a><span class="kd">protected</span> <span class="n">List</span> <span class="nf">method</span> <span class="o">()</span> <span class="o">{</span>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-2"></a>  <span class="n">ArrayList</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-3"></a>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-4"></a>  <span class="c1">// Do lots of stuff, with ifs, method calls, etc.</span>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-5"></a>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-6"></a>  <span class="k">assert</span> <span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">,</span> <span class="s">"Not initialized value"</span><span class="o">;</span>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-7"></a>  <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<a name="rest_code_736a4a98b631490a99190d294bee95e1-8"></a><span class="o">}</span>
</pre>
<p>With Java, you can have some <em>synchronized</em> and <em>no synchronized</em> methods calling between them. It may be the root of every <em>deathlock</em>, that are very difficult to detect, because they are waiting for themselves to leave the lock. It is like to search your glasses with your glasses put on.</p>
<p>This case is really easy to detect with an <em>assert</em>:</p>
<pre class="code java"><a name="rest_code_84bd62fcba404e0584114973f97af21e-1"></a><span class="kd">protected</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">synchronized_method</span><span class="o">()</span> <span class="o">{</span>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-2"></a>  <span class="n">not_syncronized_method</span><span class="o">();</span>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-3"></a><span class="o">}</span>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-4"></a>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-5"></a><span class="kd">protected</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">not_synchronized_method</span><span class="o">()</span> <span class="o">{</span>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-6"></a>  <span class="k">assert</span> <span class="n">Thread</span><span class="o">.</span><span class="na">holdsLock</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-7"></a>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-8"></a>  <span class="c1">// do some stuff</span>
<a name="rest_code_84bd62fcba404e0584114973f97af21e-9"></a><span class="o">}</span>
</pre>
</div>
<div class="section" id="disabling">
<h2>Disabling</h2>
<p>In the last term, this assertions can be deactivated when you have a production enviroment, so it does not mind if you do "expensive" stuff. When you disable them, it is like they are not written.</p>
<p>Python <em>ENABLEs</em> them by default. You need to use <em>-O</em> option to disable them:</p>
<pre class="code bash"><a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-1"></a><span class="nv">$ </span>cat assert.py
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-2"></a>assert False, <span class="s2">"Asserts enabled"</span>
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-3"></a><span class="nv">$ </span>python assert.py
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-4"></a>Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-5"></a>  File <span class="s2">"assert.py"</span>, line 1, in
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-6"></a>    assert False, <span class="s2">"Asserts enabled"</span>
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-7"></a>AssertionError: Asserts enabled
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-8"></a><span class="nv">$ </span>python -O assert.py
<a name="rest_code_68ab4d69ae1c49debdbf686c9eb1b61a-9"></a><span class="err">$</span>
</pre>
<p>Java <em>DISABLEs</em> them by default, so you can activate them by module, method, etc. The easiest way is using "<em>-ea</em>" option to enable every assertion.</p>
<p>Use them lovely!!</p>
</div>
</div>
          </div>
          <br><div>
            <nav><span class="author">
                <span class="glyphicon glyphicon-user"></span> 
                <span>Posted:Miguel Ángel García</span>
              </span>
               

              
              <span class="dateline">
                <span class="glyphicon glyphicon-calendar"></span> 
                <time class="published dt-published" datetime="2011-08-14T00:00:00+00:00" title="2011-08-14">2011-08-14</time></span>
               
              <span class="tags">
                <span class="glyphicon glyphicon-tags"></span> 
                <a class="label label-primary p-category" href="/en/categories/agile/" rel="tag">agile</a>
                <a class="label label-primary p-category" href="/en/categories/engineering/" rel="tag">engineering</a>
              </span>
                      <ul class="pager">
<li class="previous">
              <a href="/en/blog/netbeans-and-templates/" rel="prev" title="Netbeans and Templates">
                <span class="glyphicon glyphicon-arrow-left"></span>
                Previous post
              </a>
            </li>
            <li class="next">
              <a href="/en/blog/django-sitio-basico/" rel="next" title="Django: Building a basic site with Admin">
                Next post
                <span class="glyphicon glyphicon-arrow-right"></span>
              </a>
            </li>
        </ul></nav>
</div>
          <section class="comments"><h2>Comments</h2>
                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="magmax",
            disqus_url="http://magmax.org/en/blog/asegura/",
        disqus_title="Do not comment. Assert it!",
        disqus_identifier="cache/posts/asegura.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


          </section></article><script>var disqus_shortname="magmax";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
      <aside class="sidebar col-md-3"><div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">Last comments</h3>
  </div>
  <div class="panel-body">
    <div id="disqus_last_comments" class="dsq-widget">
      <script type="text/javascript" src="http://magmax.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=32&amp;excerpt_length=150">
      </script>
</div>
  </div>
</section>
</div>
          <div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="panel-body">
    <ul id="gh_repos" class="list-unstyled">
<li class="loading">Status updating…</li>
    </ul>
</div>
  <div class="panel-footer">
    <a href="https://github.com/magmax">@magmax</a> on GitHub
  </div>
</section>
</div>
      </aside>
</div>

    <footer>
      Contents © 2009-2020 <a href="mailto:">Miguel Ángel García</a> 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/es/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;width:80px;height:15px;vertical-align:middle" src="https://i.creativecommons.org/l/by-nc-sa/2.5/es/80x15.png"></a>; Using <a href="/stories/credits/">a lot of free software</a>
      
    </footer>
</div>
</div>




<a href="http://www.addthis.com/bookmark.php?v=250" id="addthisbox" class="addthis_button" src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" border="0" alt="Share">
<script data-main="/assets/js/main" src="/assets/js/libs/require/require.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9308241-3', 'auto');
  ga('send', 'pageview');

</script></a>
</body>
</html>
