<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Django lo hizo un mago | El blog de MagMax</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Tutorial de Django desde un punto de vista de alto nivel">
    <meta name="generator" content="Hugo 0.79.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      

    

    
    
    <meta property="og:title" content="Django lo hizo un mago" />
<meta property="og:description" content="Tutorial de Django desde un punto de vista de alto nivel" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/django-lo-hizo-un-mago/" />
<meta property="article:published_time" content="2015-02-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2015-02-23T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta itemprop="name" content="Django lo hizo un mago">
<meta itemprop="description" content="Tutorial de Django desde un punto de vista de alto nivel">
<meta itemprop="datePublished" content="2015-02-23T00:00:00+00:00" />
<meta itemprop="dateModified" content="2015-02-23T00:00:00+00:00" />
<meta itemprop="wordCount" content="1780">



<meta itemprop="keywords" content="django,python," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Django lo hizo un mago"/>
<meta name="twitter:description" content="Tutorial de Django desde un punto de vista de alto nivel"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        El blog de MagMax
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="" title="Inicio page">
              Inicio
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="../en" title="English page">
              English
            </a>
          </li>
          
        </ul>
      
      















    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://magmax.org/blog/django-lo-hizo-un-mago/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://magmax.org/blog/django-lo-hizo-un-mago/&amp;text=Django%20lo%20hizo%20un%20mago" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://magmax.org/blog/django-lo-hizo-un-mago/&amp;title=Django%20lo%20hizo%20un%20mago" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Django lo hizo un mago</h1>
      
      <p class="tracked">
          By <strong>
          
              Miguel Ángel García
          
          </strong>
      </p>
      
      
      <time class="f6 mv4 dib tracked" datetime="2015-02-23T00:00:00Z">February 23, 2015</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>En las películas, a menudo, se encuentran errores imposibles de explicar: un tarro que se derrama y aparece lleno, gafas que aparecen y desaparecen, espadas que se transforman en martillos&hellip; En esos casos decimos que &ldquo;lo hizo un mago&rdquo;.</p>
<p>En esta ocasión no es que un mago haya hecho <a href="https://www.djangoproject.com/">Django</a>, sino que hay un equipo
impresionante detrás. Pero sí es cierto que <a href="https://www.djangoproject.com/">Django</a> hace mucha <em>magia</em>.</p>
<p>Me gustaría comenzar aquí un pequeño tutorial rápido para usar <a href="https://www.djangoproject.com/">Django</a>, utilizando toda la magia. Este tutorial no valdrá en todos los casos, pero dará un buen punto de comienzo para aplicaciones más avanzadas.</p>
<p>Este artículo utiliza el mismo ejemplo que el que escribí hace tiempo <a href="https://magmax.org/blog/django-sitio-basico/">Django:
Creación de un sitio básico</a>, pero creo que lo encontraréis muy mejorado.</p>
<!-- raw HTML omitted -->
<figure>
    <img src="/images/django.jpg"
         alt="Django"/> 
</figure>

<h2 id="creación-de-un-blog">Creación de un blog</h2>
<p>Como ejemplo, vamos a crear un blog personal. No tendrá grandes cosas: nos basta con que sea funcional. Tendrá lo típico: posts, tags y paginación. Por no complicarnos la vida, no tendrá ni comentarios, aunque no sería difícil añadirlos.</p>
<p>Ése es nuestro objetivo, y vamos a conseguirlo lanzando &ldquo;balas trazadoras&rdquo;, es decir, definiendo una funcionalidad e implementándola de pincipio a fin. Veremos así cómo la aplicación va obteniendo la forma&hellip;</p>
<p>Me gustaría comenzar por la vista, pero en este caso creo que es mejor comenzar por el modelo. Empezar por la vista tiene sus ventajas: evita añadir cosas que uno no necesita. Sin embargo, en este caso, comenzar por el modelo nos va a dar mejor perspectiva de lo que estamos haciendo.</p>
<h3 id="1-entorno">1. Entorno</h3>
<p>Vamos a crear el entorno. Para ello voy a crear un entorno aislado:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>$ virtualenv venv
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>New python executable in venv/bin/python
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>Installing setuptools, pip...done.
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>$ . venv/bin/activate
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>$ pip install Django<span style="color:#f92672">==</span>1.7.1
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>Downloading/unpacking django
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>Installing collected packages: django
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>Successfully installed django
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>Cleaning up...
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>$
</code></pre></div><p>Con esto tenemos nuestro entorno aislado. No voy a hablar aquí sobre
<a href="https://virtualenv.pypa.io">Virtualenv</a>, <a href="https://pypi.python.org/pypi/pip">pip</a> ni otras herramientas. Voy a centrarme en <a href="https://www.djangoproject.com/">Django</a>.</p>
<p>Ahora voy a crear la estructura básica de la aplicación. Para evitar problemas, voy a llamar al proyecto <code>app</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>$ django-admin startproject app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>$ tree  app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>├── app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>│   ├── __init__.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>│   ├── settings.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>│   ├── urls.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>│   └── wsgi.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>└── manage.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#ae81ff">1</span> directory, <span style="color:#ae81ff">5</span> files
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>$
</code></pre></div><p>Bien. Con esto tenemos lo justo para empezar. A partir de ahora, todo lo que hagamos estará dentro del directorio <code>app</code> (el de nivel superior, se entiende).</p>
<p>No voy a generar más archivos. A partir de ahora todo lo escribiremos nosotros. De todas maneras, os dejo con &ldquo;los planos&rdquo; de lo que vamos a hacer:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span>app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>├── app
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>│   ├── __init__.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>│   ├── settings.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>│   ├── urls.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>│   └── wsgi.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>├── blog
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>│   ├── admin.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>│   ├── __init__.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>│   ├── models.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>│   └── views.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>├── db.sqlite3
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>├── manage.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>└── templates
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>    └── blog
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>        └── post_list.html
</code></pre></div><p>Si no os apetece ir creando los archivos, podéis descargaros el código así:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>$ git clone git@github.com:magmax/django-blog.git
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>$ git checkout 0.1.0
</code></pre></div><h3 id="2-aplicación">2. Aplicación</h3>
<p>Lo primero es crear una aplicación. En <a href="https://python.org/">Python</a> un paquete es cualquier
directorio con el fichero <code>__init__.py</code>. En <a href="https://www.djangoproject.com/">Django</a>, una aplicación es un paquete Python con un archivo <code>models.py</code>. Así que vamos a crear una aplicación <code>blog</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>app$ mkdir blog
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>app$ touch blog/__init__.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>app$ touch blog/models.py
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>app$
</code></pre></div><p>Y ahora hay que registrarla. Para ello se edita el archivo <code>app/settings.py</code>.
Veremos que es un archivo <a href="https://python.org/">Python</a> normal, definiendo variables. Buscamos
<code>INSTALLED_APPS</code> y añadimos <code>'blog'</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#e6db74">Django settings for app project.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#e6db74">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#e6db74">For more information on this file, see
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#e6db74">https://docs.djangoproject.com/en/1.6/topics/settings/
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#e6db74">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#e6db74">For the full list of settings and their values, see
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#e6db74">https://docs.djangoproject.com/en/1.6/ref/settings/
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#75715e"># Build paths inside the project like this: os.path.join(BASE_DIR, ...)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#f92672">import</span> os
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>BASE_DIR <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(__file__))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#75715e"># Quick-start development settings - unsuitable for production</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#75715e"># See https://docs.djangoproject.com/en/1.6/howto/deployment/checklist/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#75715e"># SECURITY WARNING: keep the secret key used in production secret!</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>SECRET_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*8l=t4nnb4ns)7d$ckxejxi&amp;i1%5knrwm9+sw6-p4-58q4d(p=&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#75715e"># SECURITY WARNING: don&#39;t run with debug turned on in production!</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>DEBUG <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>TEMPLATE_DEBUG <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>ALLOWED_HOSTS <span style="color:#f92672">=</span> []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#75715e"># Application definition</span>
<span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>INSTALLED_APPS <span style="color:#f92672">=</span> (
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>    <span style="color:#e6db74">&#39;django.contrib.admin&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>    <span style="color:#e6db74">&#39;django.contrib.auth&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>    <span style="color:#e6db74">&#39;django.contrib.contenttypes&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>    <span style="color:#e6db74">&#39;django.contrib.sessions&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>    <span style="color:#e6db74">&#39;django.contrib.messages&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>    <span style="color:#e6db74">&#39;django.contrib.staticfiles&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>    <span style="color:#e6db74">&#39;blog&#39;</span>,
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>)
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span>MIDDLEWARE_CLASSES <span style="color:#f92672">=</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span>    <span style="color:#e6db74">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span>    <span style="color:#e6db74">&#39;django.middleware.common.CommonMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span>    <span style="color:#e6db74">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span>    <span style="color:#e6db74">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span>    <span style="color:#e6db74">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span>    <span style="color:#e6db74">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span>ROOT_URLCONF <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;app.urls&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span>WSGI_APPLICATION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;app.wsgi.application&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span style="color:#75715e"># Database</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span style="color:#75715e"># https://docs.djangoproject.com/en/1.6/ref/settings/#databases</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span>DATABASES <span style="color:#f92672">=</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span>    <span style="color:#e6db74">&#39;default&#39;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span>        <span style="color:#e6db74">&#39;ENGINE&#39;</span>: <span style="color:#e6db74">&#39;django.db.backends.sqlite3&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span>        <span style="color:#e6db74">&#39;NAME&#39;</span>: os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(BASE_DIR, <span style="color:#e6db74">&#39;db.sqlite3&#39;</span>),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span style="color:#75715e"># Internationalization</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span style="color:#75715e"># https://docs.djangoproject.com/en/1.6/topics/i18n/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span>LANGUAGE_CODE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;en-us&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span>TIME_ZONE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;UTC&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span>USE_I18N <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75</span>USE_L10N <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77</span>USE_TZ <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80</span><span style="color:#75715e"># Static files (CSS, JavaScript, Images)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81</span><span style="color:#75715e"># https://docs.djangoproject.com/en/1.6/howto/static-files/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83</span>STATIC_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/static/&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85</span>TEMPLATE_DIRS <span style="color:#f92672">=</span> [
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86</span>    os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(BASE_DIR, <span style="color:#e6db74">&#39;templates&#39;</span>),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87</span>]</code></pre></div>
<p>Ya hemos creado una aplicación.</p>
<p>Podemos crear la base de datos mediante:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">$(</span>env<span style="color:#66d9ef">)</span>app$ python manage.py syncdb
</code></pre></div><p>Y siguiendo los pasos. Con eso vamos a crear una base de datos <a href="https://sqlite.org/">sqlite</a> con las tablas necesarias para las aplicaciones instaladas.</p>
<p>Veámoslo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">$(</span>env<span style="color:#66d9ef">)</span>app$ python manage.py runserver <span style="color:#ae81ff">8000</span>
</code></pre></div><p>Tendréis la app funcionando en https://localhost:8000 y también podréis acceder a la interfaz de administración en https://localhost:8000/admin (luego lo explico).</p>
<p>Bien&hellip; Suficiente para empezar.</p>
<h3 id="3-el-modelo">3. El modelo</h3>
<p>Al grano:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#f92672">from</span> django.db <span style="color:#f92672">import</span> models
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Tag</span>(models<span style="color:#f92672">.</span>Model):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>    name <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>    <span style="color:#66d9ef">def</span> __unicode__(self):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>name
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Post</span>(models<span style="color:#f92672">.</span>Model):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    title <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>CharField(max_length<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>    teaser <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>TextField()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>    body <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>TextField()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>    tags <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>ManyToManyField(Tag, related_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;posts&#34;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span>                                  null<span style="color:#f92672">=</span>True, blank<span style="color:#f92672">=</span>True)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>    created <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>DateTimeField(auto_now_add<span style="color:#f92672">=</span>True)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>    updated <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>DateTimeField(auto_now<span style="color:#f92672">=</span>True)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>    <span style="color:#66d9ef">def</span> __unicode__(self):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>title</code></pre></div>
<p>Lo explico: Tenemos dos clases que heredan de <code>django.db.models.Model</code>: <code>Tag</code> y <code>Post</code>.</p>
<p>La clase <code>Tag</code> se sencilla: tiene un único campo (<em>field</em>) llamado <code>name</code>, de longitud 100. Si trato de pintar la clase se ejecutará el método <code>__unicode__</code>, mostrando sólo el título.</p>
<p>La clase <code>Post</code> es más compleja: Tiene un título, un <em>teaser</em> y un <em>body</em>. Además puede contener cero o más <code>Tags</code>:</p>
<ul>
<li><code>related_name</code>: permite una relación inversa. En este caso, dado un objeto de tipo <code>Tag</code> podría acceder a todos los <code>Post</code> relacionados mediante <code>tag.posts</code>.</li>
<li><code>null</code>: Permite valores nulos.</li>
<li><code>blank</code>: Permite insertar valores vacíos (sutil diferencia con <code>null</code>).</li>
</ul>
<p>Además tenemos los campos <code>created</code> y <code>updated</code> de los que no nos preocuparemos. Son de tipo fecha y se gestionan automáticamente.</p>
<p>Aplicamos:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#f92672">(</span>venv<span style="color:#f92672">)</span>app$ python manage.py migrate
</code></pre></div><p>Pero yo quiero crear posts&hellip;.</p>
<h3 id="4-admin">4. Admin</h3>
<p>Ahora vamos a acrear el archivo <code>app/admin.py</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> models
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>register(models<span style="color:#f92672">.</span>Tag)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>register(models<span style="color:#f92672">.</span>Post)</code></pre></div>
<p>Y si volvemos a lanzar el servidor:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#66d9ef">$(</span>env<span style="color:#66d9ef">)</span>app$ python manage.py runserver <span style="color:#ae81ff">8000</span>
</code></pre></div><p>Y nos vamos a la interfaz de administración en https://localhost:8000/admin,
veremos que <a href="https://www.djangoproject.com/">Django</a> nos ha creado todo lo que necesitamos para añadir posts. Adelante, cread alguno :D</p>
<h3 id="5-enrutado">5. Enrutado</h3>
<p>Todo está funcionando, pero nos falta la interfaz de usuario. Temo que en este apartado vamos a romper lo poco que llevamos.</p>
<p>Editamos el archivo <code>app/urls.py</code> y añadimos una ruta nueva:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#f92672">from</span> django.conf.urls <span style="color:#f92672">import</span> patterns, include, url
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>admin<span style="color:#f92672">.</span>autodiscover()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#f92672">from</span> blog <span style="color:#f92672">import</span> views
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>urlpatterns <span style="color:#f92672">=</span> patterns(<span style="color:#e6db74">&#39;&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>    url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^$&#39;</span>, views<span style="color:#f92672">.</span>PostListView<span style="color:#f92672">.</span>as_view(), name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;home&#39;</span>),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>    url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^admin/&#39;</span>, include(admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>urls)),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>)</code></pre></div>
<p>(Ojo, que hay varios cambios). En general, se parece a una de las líneas que nos ofrecen&hellip;</p>
<p>En <a href="https://www.djangoproject.com/">Django</a> hay dos maneras de crear una vista: mediante una clase o mediante una función. En este caso he optado por la clase, ya que pretendo aprovechar el sistema de herencia.</p>
<p>Y esto no funciona porque aún no existe la clase <code>views.PostListView</code>, así que vamos a crearla:</p>
<h3 id="6-el-controlador-views">6. El controlador (Views)</h3>
<p>Por desgracia, en Django llaman &ldquo;view&rdquo; al controlador. Así que tenemos que escribir el archivo <code>blog/views.py</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span style="color:#f92672">from</span> django.views.generic.list <span style="color:#f92672">import</span> ListView
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span style="color:#f92672">from</span> . <span style="color:#f92672">import</span> models
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PostListView</span>(ListView):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>    model <span style="color:#f92672">=</span> models<span style="color:#f92672">.</span>Post</code></pre></div>
<p>Y podemos intentar acceder a https://localhost:8000/ para ver un bonito error: nos falta el archivo <code>blog/post_list.html</code>.</p>
<p>Lo primero será editar el archivo <code>app/settings.py</code> para indicar dónde estarán las plantillas (<em>templates</em>), por lo que añadiremos:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span style="color:#e6db74">Django settings for app project.
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span style="color:#e6db74">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span style="color:#e6db74">For more information on this file, see
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span style="color:#e6db74">https://docs.djangoproject.com/en/1.6/topics/settings/
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span style="color:#e6db74">
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span style="color:#e6db74">For the full list of settings and their values, see
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span style="color:#e6db74">https://docs.djangoproject.com/en/1.6/ref/settings/
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span style="color:#75715e"># Build paths inside the project like this: os.path.join(BASE_DIR, ...)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span style="color:#f92672">import</span> os
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>BASE_DIR <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>dirname(__file__))
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span style="color:#75715e"># Quick-start development settings - unsuitable for production</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#75715e"># See https://docs.djangoproject.com/en/1.6/howto/deployment/checklist/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span style="color:#75715e"># SECURITY WARNING: keep the secret key used in production secret!</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>SECRET_KEY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;*8l=t4nnb4ns)7d$ckxejxi&amp;i1%5knrwm9+sw6-p4-58q4d(p=&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span style="color:#75715e"># SECURITY WARNING: don&#39;t run with debug turned on in production!</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>DEBUG <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>TEMPLATE_DEBUG <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>ALLOWED_HOSTS <span style="color:#f92672">=</span> []
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span style="color:#75715e"># Application definition</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span>INSTALLED_APPS <span style="color:#f92672">=</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span>    <span style="color:#e6db74">&#39;django.contrib.admin&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span>    <span style="color:#e6db74">&#39;django.contrib.auth&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span>    <span style="color:#e6db74">&#39;django.contrib.contenttypes&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span>    <span style="color:#e6db74">&#39;django.contrib.sessions&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span>    <span style="color:#e6db74">&#39;django.contrib.messages&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span>    <span style="color:#e6db74">&#39;django.contrib.staticfiles&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span>    <span style="color:#e6db74">&#39;blog&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span>MIDDLEWARE_CLASSES <span style="color:#f92672">=</span> (
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span>    <span style="color:#e6db74">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span>    <span style="color:#e6db74">&#39;django.middleware.common.CommonMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span>    <span style="color:#e6db74">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span>    <span style="color:#e6db74">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span>    <span style="color:#e6db74">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span>    <span style="color:#e6db74">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span>)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span>ROOT_URLCONF <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;app.urls&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span>WSGI_APPLICATION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;app.wsgi.application&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span style="color:#75715e"># Database</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span style="color:#75715e"># https://docs.djangoproject.com/en/1.6/ref/settings/#databases</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span>DATABASES <span style="color:#f92672">=</span> {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span>    <span style="color:#e6db74">&#39;default&#39;</span>: {
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span>        <span style="color:#e6db74">&#39;ENGINE&#39;</span>: <span style="color:#e6db74">&#39;django.db.backends.sqlite3&#39;</span>,
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span>        <span style="color:#e6db74">&#39;NAME&#39;</span>: os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(BASE_DIR, <span style="color:#e6db74">&#39;db.sqlite3&#39;</span>),
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span>    }
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span>}
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span style="color:#75715e"># Internationalization</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span style="color:#75715e"># https://docs.djangoproject.com/en/1.6/topics/i18n/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69</span>LANGUAGE_CODE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;en-us&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71</span>TIME_ZONE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;UTC&#39;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73</span>USE_I18N <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75</span>USE_L10N <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77</span>USE_TZ <span style="color:#f92672">=</span> True
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80</span><span style="color:#75715e"># Static files (CSS, JavaScript, Images)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81</span><span style="color:#75715e"># https://docs.djangoproject.com/en/1.6/howto/static-files/</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83</span>STATIC_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/static/&#39;</span>
<span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84</span>
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85</span>TEMPLATE_DIRS <span style="color:#f92672">=</span> [
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86</span>    os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(BASE_DIR, <span style="color:#e6db74">&#39;templates&#39;</span>),
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87</span>]</span></code></pre></div>
<p>Y después editaremos el archivo <code>templates/blog/post_list.html</code> por algo muy básico:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-django" data-lang="django"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>&lt;ul&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  <span style="color:#75715e">{%</span> <span style="color:#66d9ef">for</span> post <span style="color:#66d9ef">in</span> post_list <span style="color:#75715e">%}</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>  &lt;li&gt;<span style="color:#75715e">{{</span> post.title <span style="color:#75715e">}}</span>&lt;/li&gt;
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  <span style="color:#75715e">{%</span> <span style="color:#66d9ef">endfor</span> <span style="color:#75715e">%}</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>&lt;/ul&gt;</code></pre></div>
<p>Magia. En este momento todo cuadra y funciona.</p>
<h2 id="el-truco">El truco</h2>
<p>Ahora es cuando contamos secretos de magos: ¿Dónde está el truco?</p>
<p>Bien&hellip; lo que hemos usado son un montón de convenciones.</p>
<p>Cuando en el navegador se indica una <em>URL</em>, <a href="https://www.djangoproject.com/">Django</a> comprueba cada expresión regular del archivo <strong>app/url.py</strong> hasta que una de ellas se cumple. Entonces invoca a la función que tenga asociada. En nuestro caso, esta función es el <em>wrapper</em> <code>.as_view()</code>, que devuelve una función.</p>
<p>Esta función <code>as_view()</code>, sabe que debe invocar ciertos métodos de esa clase. En nuestro caso hemos dejado las implementaciones por defecto de la clase <code>django.views.generic.list.ListView</code>. Ésta necesita un modelo, que le hemos indicado en la variable <code>PostListView.model</code> y con esto se pone a funcionar:</p>
<ul>
<li>obtiene la lista de elementos del modelo</li>
<li>genera una variable de &ldquo;contexto&rdquo;</li>
<li>asigna la lista de elementos a una variable <code>&lt;model&gt;_list</code> en el contexto</li>
<li>busca la plantilla <code>&lt;application&gt;/&lt;model&gt;_list.html</code></li>
<li><em>renderiza</em> la plantilla con el contexto.</li>
</ul>
<p><a href="https://www.djangoproject.com/">Django</a> nos ofrece la posibilidad de sobreescribir cualquiera de esos puntos,
pero estamos aprendiendo y, en este momento, lo mejor es dejarle hacer a él. Si
este tutorial tiene tirón, veremos cómo hacerlo.</p>
<h2 id="más-información">Más información</h2>
<p>Podéis encontrar toda la información en el <a href="https://docs.djangoproject.com/en/1.7/intro/tutorial01/">tutorial de Django</a>.</p>
<p>Este artículo continúa en <a href="https://magmax.org/blog/django-lo-hizo-un-mago-paginacion-y-detalle/">Django lo hizo un mago: paginación y detalle</a>, donde
creamos el detalle de cada <em>post</em> y paginamos la página de índice. Después sigue
en <a href="https://magmax.org/blog/django-lo-hizo-un-mago-plantillas-y-contextos/">Django lo hizo un mago: plantillas y contextos</a>, donde se crea un menú con
las categorías y se mejoran las plantillas.</p>
<ul class="pa0">
  
   <li class="list">
     <a href="/tags/django" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">django</a>
   </li>
  
   <li class="list">
     <a href="/tags/python" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">python</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "magmax" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Relacionado</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/blog/testing-en-django-mejoras/">Testing en django: mejoras</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/aprender-es-duro/">Aprender es duro (retrospectiva 2014)</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/pycones-2014-2/">Retrospectiva a la #PyConEs2014 (2)</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/pycones-2014/">Retrospectiva a la #PyConEs2014 (1)</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/publicando-artefactos-python/">Publicando artefactos Python</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/webviews-en-el-escritorio/">WebViews en el escritorio</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/micro-web-framework-en-python/">Micro-framework web en Python</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/webdriver-practico/">Webdriver: crackeando la web de Renfe</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/python-avanzado/">Python avanzado</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/python-basico/">Python básico</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/python-tornado-2/">Python Tornado: Web Testing</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/python-tornado/">Python Tornado</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/selenium-y-qa-automation/">Selenium y QA Automation</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/functional-programming/">Programación funcional</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/blog/python3-slow/">Python 3 es lento (I)</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://magmax.org/" >
    &copy;  El blog de MagMax 2021 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
