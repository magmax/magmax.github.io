<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Publicando artefactos Python - El blog de MagMax</title><meta name="Description" content="Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip."><meta property="og:title" content="Publicando artefactos Python" />
<meta property="og:description" content="Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/publicando-artefactos-python/" />
<meta property="og:image" content="https://magmax.org/icons/favicon.png"/>
<meta property="article:published_time" content="2014-05-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="Publicando artefactos Python"/>
<meta name="twitter:description" content="Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip."/>
<meta name="application-name" content="El blog de MagMax">
<meta name="apple-mobile-web-app-title" content="El blog de MagMax"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/publicando-artefactos-python/" /><link rel="prev" href="https://magmax.org/blog/elasticsearch-y-logstash/" /><link rel="next" href="https://magmax.org/blog/combinando-git-y-subversion/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Publicando artefactos Python",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/publicando-artefactos-python\/"
        },"genre": "posts","keywords": "python, package","wordcount":  1410 ,
        "url": "https:\/\/magmax.org\/blog\/publicando-artefactos-python\/","datePublished": "2014-05-14T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Miguel Ángel"},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": "Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip."
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/publicando-artefactos-python/" selected>Español</option></select>
                    </a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/publicando-artefactos-python/" selected>Español</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Publicando artefactos Python</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Miguel Ángel</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="14 May 2014">14 May 2014</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1410 palabras&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;7 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#antes-de-publicar">Antes de publicar</a>
      <ul>
        <li><a href="#creando-un-repositorio">Creando un repositorio</a></li>
        <li><a href="#readme">README</a></li>
        <li><a href="#estructura">Estructura</a></li>
      </ul>
    </li>
    <li><a href="#comenzando-el-proyecto">Comenzando el proyecto</a>
      <ul>
        <li><a href="#setuppy">setup.py</a></li>
        <li><a href="#paquete__init__py">&lt;paquete&gt;/__init__.py</a></li>
      </ul>
    </li>
    <li><a href="#probando">Probando</a>
      <ul>
        <li><a href="#travis">Travis</a></li>
        <li><a href="#coveralls">Coveralls</a></li>
      </ul>
    </li>
    <li><a href="#gestión">Gestión</a></li>
    <li><a href="#publicación">Publicación</a></li>
    <li><a href="#afinando">Afinando</a></li>
    <li><a href="#más-información">Más información</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Hace un par de semanas que comencé un proyectillo Python que se ha transformado en mi primer paquete <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a> serio. Bueno, realmente se ha transformado en dos paquetes, lo que me ha hecho darme cuenta de lo repetitivo de algunas tareas&hellip; Y cómo no, he decidido compartirlo aquí.</p>
<p>Así aprovecharé para contar algunas lecciones aprendidas, ahorrando así tiempo la próxima vez y ayudando a otros. De hecho, ya estoy preparando el siguiente XD</p>
<p>Comenzaré desde el principio del todo: la creación del repositorio.</p>
<figure>
    <img src="/images/python.png"
         alt="Python"/> 
</figure>

<h2 id="antes-de-publicar">Antes de publicar</h2>
<h3 id="creando-un-repositorio">Creando un repositorio</h3>
<p>Lo primero es crear un repositorio. No me voy a liar aquí a contar cómo hay que hacerlo, porque ya conté en su día <a href="https://magmax.org/blog/usando-git/" rel="">cómo crear un repositorio Git</a>. Baste decir que recomiendo <a href="https://git-scm.com/" target="_blank" rel="noopener noreffer">Git</a> en <a href="https://github.com/" target="_blank" rel="noopener noreffer">GitHub</a>, y más tarde veremos por qué.</p>
<h3 id="readme">README</h3>
<p>Lo primero en el repositorio es crear el archivo <strong>README</strong>. En principio, tenemos varios formatos a elegir&hellip; Pero si queremos reutilizarlo para que se muestre lo mismo en <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a> y en <a href="https://github.com/" target="_blank" rel="noopener noreffer">GitHub</a>, es recomendable usar <a href="https://docutils.sourceforge.net/rst.html" target="_blank" rel="noopener noreffer">ReStructured Text</a>, que es lo único que entiende <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a>. Por lo tanto, debería llamarse <strong>README.rst</strong>.</p>
<h3 id="estructura">Estructura</h3>
<p>Lo segundo a tener en cuenta es la estructura de directorios. Recomiendo la siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">.
├── .coveragerc
├── .travis.yml
├── .gitignore
├── Makefile
├── README.rst
├── requirements-dev.txt
├── setup.py
├── tests
│   ├── acceptance
│   │   └── __init__.py
│   ├── integration
│   │   └── __init__.py
│   └── unit
│       └── __init__.py
└── &lt;library name&gt;
    └── __init__.py
</code></pre></td></tr></table>
</div>
</div><p>En este tutorial me ha quedado muy largo porque tengo que mostrar casi todos ellos, pero podéis ver dos ejemplos funcionales: <a href="https://github.com/magmax/python-readchar/tree/master/" target="_blank" rel="noopener noreffer">python-readchar</a> y <a href="https://github.com/magmax/python-inquirer/tree/master/" target="_blank" rel="noopener noreffer">python-inquirer</a>. Recomiendo el primero por ser más sencillo.</p>
<p>Pues ya tenemos el repositorio y un archivo&hellip; ¡Comencemos!</p>
<h2 id="comenzando-el-proyecto">Comenzando el proyecto</h2>
<p>Lo mejor es comenzar por definir el proyecto, con el archivo <strong>setup.py</strong>. Para su concepción recomiendo echar un ojo a las <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="noopener noreffer">setuptools</a>. Como suelo hacerle algún hack, os muestro un ejemplo:</p>
<h3 id="setuppy">setup.py</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>
<span class="kn">from</span> <span class="nn">readchar</span> <span class="kn">import</span> <span class="n">__version__</span><span class="p">,</span> <span class="n">__description__</span>


<span class="k">def</span> <span class="nf">read_full_description</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;README.rst&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>


<span class="n">setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;&lt;PACKAGE&gt;&#39;</span><span class="p">,</span>
      <span class="n">version</span><span class="o">=</span><span class="n">__version__</span><span class="p">,</span>
      <span class="n">description</span><span class="o">=</span><span class="n">__description__</span><span class="p">,</span>
      <span class="n">long_description</span><span class="o">=</span><span class="n">read_full_description</span><span class="p">(),</span>
      <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
          <span class="s1">&#39;Development Status :: 4 - Beta&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Environment :: Console&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Intended Audience :: Developers&#39;</span><span class="p">,</span>
          <span class="s1">&#39;License :: OSI Approved :: MIT License&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Programming Language :: Python :: 3.3&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Topic :: Software Development&#39;</span><span class="p">,</span>
      <span class="p">],</span>
      <span class="n">keywords</span><span class="o">=</span><span class="s1">&#39;stdin,command line&#39;</span><span class="p">,</span>
      <span class="n">author</span><span class="o">=</span><span class="s1">&#39;MagMax&#39;</span><span class="p">,</span>
      <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;magmax@example.org&#39;</span><span class="p">,</span>
      <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://example.org/repository&#39;</span><span class="p">,</span>
      <span class="n">license</span><span class="o">=</span><span class="s1">&#39;Whatever&#39;</span><span class="p">,</span>
      <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;venv&#39;</span><span class="p">]),</span>
      <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
      <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
      <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
        <span class="p">],</span>
      <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Varias cosas aquí: como veis, importo la <strong>versión</strong> y la <strong>descripción</strong> del propio paquete  Eso me facilita tocar un único punto (más o menos) a la hora de crear el paquete. Luego veremos este archivo. El nombre de variable <code>__version__</code> es estándar, vamos, que se tiene que llamar así.</p>
<p>Además, la descripción larga la leo del propio archivo <strong>README.rst</strong> que comenté antes, de manera que se vea chulo en línea de órdenes y en <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a>. Tened cuidado, porque cualquier error y <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a> no lo renderizará como debe. <a href="https://github.com/" target="_blank" rel="noopener noreffer">GitHub</a> es bastante más permisivo.</p>
<p>Finalmente, en el apartado <code>install_requires</code> podéis añadir todas las dependencias de la misma manera que en el <strong>requirements.txt</strong>. Intenté un <em>hack</em> para leerlo, pero durante la instalación no me lo encontraba&hellip; Así que opté por eliminar el archivo y gestionar los requisitos desde aquí. Es un tema sobre el que tengo que volver.</p>
<h3 id="paquete__init__py">&lt;paquete&gt;/__init__.py</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;0.1&#39;</span>
<span class="n">__description__</span> <span class="o">=</span> <span class="s1">&#39;Loren Ipsum&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>Es necesario algo así para que lo lea bien nuestro programita <strong>setup.py</strong>. Para la versión hay mogollón de opiniones&hellip; La mía es que con dos ó tres números es suficiente. Tres como mucho si usais la fecha con formato YYYYMMDD (<code>mayor.fecha.minor</code>).</p>
<h2 id="probando">Probando</h2>
<p>Un paquetito que se precie debe estar acompañado de pruebas&hellip; Y a ser posible de porcentajes de cobertura. Pues podemos usar herramientas gratuitas para ello: <a href="https://travis-ci.org" target="_blank" rel="noopener noreffer">Travis</a> y <a href="https://coveralls.io" target="_blank" rel="noopener noreffer">Coveralls</a>.</p>
<h3 id="travis">Travis</h3>
<p>Es un sistema de integración continua gratuito para proyectos libres y de pago para los que no lo son. Permite ejecutar los tests de todos los <em>changesets</em>. Se configura mediante el archivo <strong>.travis.yml</strong>, situado en el directorio principal y con formato <a href="https://es.wikipedia.org/wiki/YAML" target="_blank" rel="noopener noreffer">YAML</a>. Veamos un ejemplo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l">python</span><span class="w">
</span><span class="w"></span><span class="nt">python</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="s2">&#34;2.6&#34;</span><span class="w">
</span><span class="w">  </span>- <span class="s2">&#34;2.7&#34;</span><span class="w">
</span><span class="w">  </span>- <span class="s2">&#34;3.2&#34;</span><span class="w">
</span><span class="w">  </span>- <span class="s2">&#34;3.3&#34;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="nt">install</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="l">pip install -r requirements-dev.txt</span><span class="w">
</span><span class="w">  </span>- <span class="l">if [[ $TRAVIS_PYTHON_VERSION == 2* ]]; then pip install unittest2; fi</span><span class="w">
</span><span class="w">  </span>- <span class="l">python setup.py install</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="nt">script</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="l">make pep8</span><span class="w">
</span><span class="w">  </span>- <span class="l">if [[ $TRAVIS_PYTHON_VERSION != &#39;2.6&#39; ]]; then make flakes; fi</span><span class="w">
</span><span class="w">  </span>- <span class="l">make test</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="nt">after_success</span><span class="p">:</span><span class="w">
</span><span class="w">  </span>- <span class="l">make coveralls</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="nt">notifications</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">email</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">on_success</span><span class="p">:</span><span class="w"> </span><span class="l">change</span><span class="w">
</span><span class="w">    </span><span class="nt">on_failure</span><span class="p">:</span><span class="w"> </span><span class="l">change</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Básicamente crea un ejecutor para cada versión de Python y ejecuta los scripts del <code>install</code> y <code>script</code>, y si todo va bien, el <code>after_success</code>. Hay más pasos en el ciclo de vida, pero podéis verlos en la documentación de <a href="https://travis-ci.org" target="_blank" rel="noopener noreffer">Travis</a>.</p>
<p>Para que funcione, tenéis que:</p>
<ol>
<li>daros de alta en <a href="https://travis-ci.org" target="_blank" rel="noopener noreffer">Travis</a>,</li>
<li>sincronizar vuestros proyectos <a href="https://github.com/" target="_blank" rel="noopener noreffer">GitHub</a> (ahora entendéis por qué lo recomendaba, ¿eh?),</li>
<li>dar permisos a <a href="https://travis-ci.org" target="_blank" rel="noopener noreffer">Travis</a> para instalar un <em>hook</em> en el repositorio,</li>
<li>y activarlo para el repositorio de vuestro proyecto.</li>
</ol>
<p>Los tres primeros se hacen sólo una vez y el último hay que repetirlo cada vez que comencemos un proyecto.</p>
<p>Como veis, el paso de <code>after_success</code> es llamar al plugin de <a href="https://coveralls.io" target="_blank" rel="noopener noreffer">Coveralls</a>.</p>
<h3 id="coveralls">Coveralls</h3>
<p>Requiere de un plugin para invocarlo. Yo suelo utilizar <a href="https://github.com/z4r/python-coveralls" target="_blank" rel="noopener noreffer">python-coveralls</a>, pero también está disponible <a href="https://github.com/coagulant/coveralls-python" target="_blank" rel="noopener noreffer">coveralls-python</a> (no, no me estoy quedando con vosotros). Se configura con el archivo <strong>.coverage</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ini" data-lang="ini"><span class="k">[run]</span>
<span class="na">omit</span> <span class="o">=</span> <span class="s">*/tests*</span>
</code></pre></td></tr></table>
</div>
</div><p>Además de instalar el paquete correspondiente, es necesario darse de alta en <a href="https://coveralls.io" target="_blank" rel="noopener noreffer">Coveralls</a>. Veréis información sobre claves SSL en la documentación y tal&hellip; pero eso sólo es para los proyectos privados.</p>
<p>Es necesario generar el archivo <strong>.coverage</strong> para que <a href="https://coveralls.io" target="_blank" rel="noopener noreffer">Coveralls</a> muestre los resultados correctamente. Si usais <a href="https://nose.readthedocs.org/en/latest/" target="_blank" rel="noopener noreffer">nose</a>, como yo, necesitaréis también <a href="https://pypi.python.org/pypi/nosexcover" target="_blank" rel="noopener noreffer">nosexcover</a>.</p>
<h2 id="gestión">Gestión</h2>
<p>Veamos cómo orquesto toda esta maraña de archivos: mediante <a href="https://virtualenv.readthedocs.org/en/latest/" target="_blank" rel="noopener noreffer">virtualenv</a>. Siempre me creo el entorno <code>venv</code> y lo añado al archivo <strong>.gitignore</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">*~
\#*
\.\#*
*.pyc
*.egg-info/
build/
dist/
venv/
.coverage
coverage.xml
</code></pre></td></tr></table>
</div>
</div><p>Claro&hellip; He mencionado mogollón de historias, pero no mis herramientas, que están en el requirements-dev.txt:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">pep8==1.5.1
flake8==2.1.0
nose==1.3.1
coverage==3.7.1
nosexcover==1.0.10
python-coveralls==2.4.2
doublex==1.8.1
pexpect==3.2
</code></pre></td></tr></table>
</div>
</div><p>Me gusta indicar las versiones, por si algo se rompe por sorpresa, tenerlo controlado.</p>
<p>Además de éstas, suelo instalarme siempre <a href="https://ipython.org/" target="_blank" rel="noopener noreffer">ipython</a>, pero no lo incluyo aquí porque es meter demasiada carga a <a href="https://travis-ci.org" target="_blank" rel="noopener noreffer">Travis</a> cuando no lo va a usar.</p>
<p>Y, finalmente, el director de la orquesta, el archivo <strong>Makefile</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-make" data-lang="make"><span class="nv">MODULES</span><span class="o">=</span>&lt;PACKAGE NAME&gt;

<span class="nf">all</span><span class="o">:</span> <span class="n">pep</span>8 <span class="n">flakes</span> <span class="n">test</span>

<span class="nf">test</span><span class="o">::</span> <span class="n">clear_coverage</span> <span class="n">run_unit_tests</span> <span class="n">run_acceptance_tests</span>

<span class="nf">unit_test</span><span class="o">::</span> <span class="n">run_unit_tests</span>

<span class="nf">acceptance_test</span><span class="o">::</span> <span class="n">run_acceptance_tests</span>

<span class="nf">analysis</span><span class="o">::</span> <span class="n">pep</span>8 <span class="n">flakes</span>

<span class="nf">pep8</span><span class="o">:</span>
	@echo Checking PEP8 style...
	@pep8 --statistics <span class="si">${</span><span class="nv">MODULES</span><span class="si">}</span> tests

<span class="nf">flakes</span><span class="o">:</span>
	@echo Searching <span class="k">for</span> static errors...
	@pyflakes <span class="si">${</span><span class="nv">MODULES</span><span class="si">}</span>

<span class="nf">coveralls</span><span class="o">::</span>
	coveralls

<span class="nf">run_unit_tests</span><span class="o">:</span>
	@echo Running Tests...
	@nosetests -dv --exe --with-xcoverage --cover-package<span class="o">=</span><span class="si">${</span><span class="nv">MODULES</span><span class="si">}</span> --cover-tests tests/unit

<span class="nf">run_acceptance_tests</span><span class="o">:</span>
	@echo Running Tests...
	@nosetests -dv --exe tests/acceptance

<span class="nf">clear_coverage</span><span class="o">:</span>
	@echo Cleaning previous coverage...
	@coverage erase
</code></pre></td></tr></table>
</div>
</div><h2 id="publicación">Publicación</h2>
<p>Ya sólo nos queda publicar el paquete en <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a>. Para ello seguiremos los siguientes pasos:</p>
<ol>
<li>Registrarse en la web de <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a></li>
<li>Registrar el paquete: <code>python setup.py register</code></li>
<li>Empaquetar y subir: <code>python setup.py sdist upload</code></li>
</ol>
<p>Como veis, yo distribuyo los fuentes, ya que los binarios me dieron problemas.</p>
<h2 id="afinando">Afinando</h2>
<p>Y sólo me queda contar cómo poner los iconos monos XD</p>
<p>Tanto <a href="https://travis-ci.org" target="_blank" rel="noopener noreffer">Travis</a> como <a href="https://pypi.python.org/pypi" target="_blank" rel="noopener noreffer">pypi</a> y <a href="https://coveralls.io" target="_blank" rel="noopener noreffer">Coveralls</a> disponen de unos iconos accesibles con la misma URL. Como hemos dicho, vamos a usar el formato <a href="https://docutils.sourceforge.net/rst.html" target="_blank" rel="noopener noreffer">ReStructured Text</a>, así que ésta es la manera más chula:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-rst" data-lang="rst"><span class="cp">.. Uso:
</span><span class="cp">
</span><span class="cp"></span>|pip version|<span class="err">
</span><span class="err"></span>|pip downloads|<span class="err">
</span><span class="err"></span>|travis|<span class="err">
</span><span class="err"></span>|coveralls|<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="cp">.. Al final del documento:
</span><span class="cp">
</span><span class="cp"></span><span class="p">..</span> <span class="nt">|travis|</span> <span class="ow">image</span><span class="p">::</span> https://travis-ci.org/&lt;USER&gt;/&lt;REPOSITORY&gt;.png<span class="err">
</span><span class="err"></span>  <span class="nc">:target:</span> <span class="nf">`Travis`_</span><span class="err">
</span><span class="err"></span>  <span class="nc">:alt:</span> <span class="nf">Travis results</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="p">..</span> <span class="nt">|coveralls|</span> <span class="ow">image</span><span class="p">::</span> https://coveralls.io/repos/&lt;USER&gt;/&lt;REPOSITORY&gt;/badge.png<span class="err">
</span><span class="err"></span>  <span class="nc">:target:</span> <span class="nf">`Coveralls`_</span><span class="err">
</span><span class="err"></span>  <span class="nc">:alt:</span> <span class="nf">Coveralls results_</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="p">..</span> <span class="nt">|pip version|</span> <span class="ow">image</span><span class="p">::</span> https://pypip.in/v/&lt;PIP_NAME&gt;/badge.png<span class="err">
</span><span class="err"></span>    <span class="nc">:target:</span> <span class="nf">https://pypi.python.org/pypi/&lt;PIP_NAME&gt;</span><span class="err">
</span><span class="err"></span>    <span class="nc">:alt:</span> <span class="nf">Latest PyPI version</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="p">..</span> <span class="nt">|pip downloads|</span> <span class="ow">image</span><span class="p">::</span> https://pypip.in/d/&lt;PIP_NAME&gt;/badge.png<span class="err">
</span><span class="err"></span>    <span class="nc">:target:</span> <span class="nf">https://pypi.python.org/pypi/&lt;PIP_NAME&gt;</span><span class="err">
</span><span class="err"></span>    <span class="nc">:alt:</span> <span class="nf">Number of PyPI downloads</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="p">..</span> <span class="nt">_Travis:</span> https://travis-ci.org/&lt;USER&gt;/&lt;REPOSITORY&gt;<span class="err">
</span><span class="err"></span><span class="p">..</span> <span class="nt">_Coveralls:</span> https://coveralls.io/r/&lt;USER&gt;/&lt;REPOSITORY&gt;<span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>Como véis, hay que cambiar <code>&lt;USER&gt;</code>, <code>&lt;REPOSITORY&gt;</code> y <code>&lt;PIP_NAME&gt;</code>, y vale para cualquier proyecto.</p>
<h2 id="más-información">Más información</h2>
<p>Hay muchas cosas en el tintero aún, como subir la documentación a <a href="https://readthedocs.org/" target="_blank" rel="noopener noreffer">read the docs</a>, pero este artículo ya tiene suficiente caña XD</p>
<p>Recomiendo indagar un poquito en cada herramienta si queréis ampliar funcionalidad.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/publicando-artefactos-python/" data-title="Publicando artefactos Python" data-hashtags="python,package"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/publicando-artefactos-python/" data-hashtag="python"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/publicando-artefactos-python/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/publicando-artefactos-python/" data-title="Publicando artefactos Python" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/publicando-artefactos-python/" data-title="Publicando artefactos Python" data-caption="Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip." data-tags="python,package"><i class="fab fa-tumblr fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/publicando-artefactos-python/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/publicando-artefactos-python/" data-title="Publicando artefactos Python" data-description="Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip."><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Compartir en Digg" data-sharer="digg" data-url="https://magmax.org/blog/publicando-artefactos-python/"><i class="fab fa-digg fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/publicando-artefactos-python/" data-title="Publicando artefactos Python" data-description="Muestro el proceso que he seguido para publicar artefactos Python en pypi, para poder descargarlos con pip."><i class="fab fa-blogger fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/python/">python</a>,&nbsp;<a href="/tags/package/">package</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/elasticsearch-y-logstash/" class="prev" rel="prev" title="ElasticSearch y Logstash"><i class="fas fa-angle-left fa-fw"></i>ElasticSearch y Logstash</a>
            <a href="/blog/combinando-git-y-subversion/" class="next" rel="next" title="Combinando Git y Subversion">Combinando Git y Subversion<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Provisto por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="https://magmax.disqus.com/embed.js" defer></script><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-9308241-3', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-9308241-3" async></script></body>
</html>
