<!DOCTYPE html>
<html prefix="
og: https://ogp.me/ns#
article: https://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Python service oriented by using message queues, using Celery">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="max-age=43200">
<meta http-equiv="ETag" content="b'1566322fc0722093b12eca5f1e9215a3ab6698c5'">
<title>Distributed Python: Celery | MagMax Blog</title>
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="/assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="/assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/magmax">
<link rel="canonical" href="http://magmax.org/en/blog/python-distribuido-celery/">
<link rel="icon" href="/favicon_330.png" sizes="330x330">
<link rel="icon" href="/favicon.ico" sizes="16x16">
<link rel="icon" href="/favicon.png" sizes="128x128">
<meta name="description" itemprop="description" content="Python service oriented by using message queues, using Celery">
<meta name="author" content="Miguel Ángel García">
<link rel="prev" href="/en/blog/gashlycode-tinies/" title="Gashlycode Tinies" type="text/html">
<link rel="next" href="/en/blog/is-code-coverage-irrelevant/" title="Is Code Coverage Irrelevant?" type="text/html">
<meta property="og:site_name" content="MagMax Blog">
<meta property="og:title" content="Distributed Python: Celery">
<meta property="og:url" content="http://magmax.org/en/blog/python-distribuido-celery/">
<meta property="og:description" content="Python service oriented by using message queues, using Celery">
<meta property="og:type" content="article">
<meta property="article:author" content="Miguel Ángel García">
<meta property="article:published_time" content="2015-03-20T00:00:00+00:00">
<meta property="article:updated" content="2015-03-20T00:00:00+00:00">
<meta property="article:tag" content="celery">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@magmax_en">
<meta name="twitter:creator" content="@magmax">
<meta name="twitter:title" content="MagMax Blog">
<meta name="twitter:description" content="Python service oriented by using message queues, using Celery">
<meta name="twitter:url" content="http://magmax.org//en/blog/python-distribuido-celery/">
<meta name="twitter:image" content="http://magmax.org/favicon.png">
<link rel="alternate" hreflang="es" href="/blog/python-distribuido-celery/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://magmax.org/en/">

        <span id="blog-title">MagMax Blog</span>
      </a>
    </div>
<!-- /.navbar-header -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav">
<li>
<a href="/">Home</a>
                </li>
<li>
<a href="/archive.html">Archives</a>
                </li>
<li>
<a href="/categories">Tags</a>
                </li>
<li>
<a href="/projects">Projects</a>
                </li>
<li>
<a href="/news">External Posts</a>

        
      </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
<form class="navbar-form navbar-left" role="search" action="http://google.com/search" method="get">
<div class="form-group">
<input type="hidden" name="sitesearch" value="magmax.org"><input type="text" name="q" class="form-control" placeholder="Search / Buscar">
</div>
</form>
</li>

        <li style="margin-left:0">
          <a href="http://feeds.feedburner.com/magmax">
            <img src="/assets/images/rss.png" style="width:22px;height:22px"></a>
        </li>

        
      </ul>
</div>
<!-- /.navbar-collapse -->
  </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
  <div class="body-content">
    <div class="row">
      <div class="page-content col-md-9">
        
        <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="https://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="/en/blog/python-distribuido-celery/" class="u-url">Distributed Python: Celery</a></h1>
            <div class="metadata text-muted">
              <i class="glyphicon glyphicon-calendar"></i>
              <p class="dateline">
                <time class="published dt-published updated dt-updated" datetime="2015-03-20T00:00:00+00:00" title="2015-03-20">2015-03-20</time></p>
              <p class="commentline">            <a href="/en/blog/python-distribuido-celery/#disqus_thread" data-disqus-identifier="cache/posts/python-distribuido-celery.html">Comments</a>

</p>
              <address class="vcard author"><a class="url fn" href="https://magmax.org">Miguel Ángel García</a></address>
            </div>
            <br><div class="metadata posttranslations translations">
              <h3 class="posttranslations-intro">Also available in:</h3>
              <p><a href="/blog/python-distribuido-celery/" rel="alternate" hreflang="es"><img src="/images/es.png"> Español</a></p>
            </div>
          </header><div class="e-content entry-content" itemprop="articleBody text">
            <div>
<p>Nowadays, <abbr title="Service Oriented Architectures">SOA</abbr> architectures is in fashion. These architectures use little and very specific services, so they interact each other.</p>
<p>In this post I'll show how to use <a class="reference external" href="http://www.celeryproject.org/">Celery</a> in order to create a SOA architecture.</p>
<!-- TEASER_END -->
<div class="section" id="about-celery">
<h2>About Celery</h2>
<p><a class="reference external" href="http://www.celeryproject.org/">Celery</a> is not a communication system, because it uses <a class="reference external" href="https://www.rabbitmq.com">RabbitMQ</a>, <a class="reference external" href="http://redis.io/">Redis</a>, etc. as communication system. The same applies to argue it is not a message queue system. Neither it is a protocol, because it uses <a class="reference external" href="https://www.amqp.org/">AMQP</a>. Neither it is an abstraction over all these, because <a class="reference external" href="https://kombu.readthedocs.org/en/latest/">Kombu</a> does that work, the communications library it uses under the hood.</p>
<p><a class="reference external" href="http://www.celeryproject.org/">Celery</a> is a set ot tools to work easily with several services, something like syntactic sugar. It allows to launch services as <strong>tasks</strong>.</p>
</div>
<div class="section" id="how-to-install-it">
<h2>How to install it</h2>
<p>It is very easy to install; with <cite>pip</cite>:</p>
<pre class="code bash"><a name="rest_code_2031db08cb09468b8dc46bea96a1cb3c-1"></a>pip install celery
</pre>
<p>or <cite>apt</cite>:</p>
<pre class="code bash"><a name="rest_code_3a83a7a7fbe54213917f76cc92241f60-1"></a>apt-get install python-celery
</pre>
<p>The problem here is we need a <strong>Broker</strong>. The <strong>Broker</strong> is the way to transport messages from a service to another. In this case, we need a message queue.</p>
<p>We will use two of them as example: <a class="reference external" href="https://www.rabbitmq.com">RabbitMQ</a> and <a class="reference external" href="http://redis.io/">Redis</a>. The first one is somehow... complicated, but very interesting if you already know and install the <a class="reference external" href="https://www.rabbitmq.com/management.html">management plugin</a>. The second one is easier to be installed, but more difficult to see what is happening internally. To use <a class="reference external" href="http://redis.io/">Redis</a> you will also require the library; with <cite>pip</cite>:</p>
<pre class="code bash"><a name="rest_code_607e92c7a07645c78052cbb9cfc8d979-1"></a>pip install redis
</pre>
<p>or with <cite>apt</cite>:</p>
<pre class="code bash"><a name="rest_code_36752b1d6fb141999343fca14b8e3a53-1"></a>apt-get install python-redis
</pre>
</div>
<div class="section" id="example">
<h2>Example</h2>
<div class="section" id="creating-services">
<h3>Creating services</h3>
<p>Let's start creating a little service to multiply two numbers:</p>
<p><a class="reference external" href="/listings/python-celery/001/tasks.py.html">python-celery/001/tasks.py</a></p>
<pre class="code python"><a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-1"></a><span class="c1"># Celery service example: task to multiply two numbers</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-2"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-3"></a>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-4"></a><span class="c1"># RabbitMQ</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-5"></a><span class="c1">#app = Celery('tasks', broker='amqp://guest@localhost//', backend='amqp')</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-6"></a><span class="c1"># Redis</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-7"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">'tasks'</span><span class="p">,</span> <span class="n">broker</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">)</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-8"></a>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-9"></a><span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-10"></a><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a name="rest_code_05640e006c414b3fbf64ea68a786e9c4-11"></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
</pre>
<p>The overhead added by <a class="reference external" href="http://www.celeryproject.org/">Celery</a> is quite small: importing the library, connecting (<tt class="docutils literal">app</tt>) and adding a decorator to our service.</p>
<p>It is already executable:</p>
<p><a class="reference external" href="/listings/python-celery/001/output.txt.html">python-celery/001/output.txt</a></p>
<pre class="code bash"><a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-1"></a>$ celery worker --loglevel<span class="o">=</span>info -A tasks
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-2"></a>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-3"></a> -------------- celery@nightcrawler v3.1.17 <span class="o">(</span>Cipater<span class="o">)</span>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-4"></a>---- **** -----
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-5"></a>--- * ***  * -- Linux-3.16.0-4-amd64-x86_64-with-debian-8.0
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-6"></a>-- * - **** ---
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-7"></a>- ** ---------- <span class="o">[</span>config<span class="o">]</span>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-8"></a>- ** ---------- .&gt; app:         tasks:0x7f3476eb9b90
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-9"></a>- ** ---------- .&gt; transport:   redis://localhost:6379/0
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-10"></a>- ** ---------- .&gt; results:     redis://localhost:6379/0
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-11"></a>- *** --- * --- .&gt; concurrency: <span class="m">4</span> <span class="o">(</span>prefork<span class="o">)</span>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-12"></a>-- ******* ----
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-13"></a>--- ***** ----- <span class="o">[</span>queues<span class="o">]</span>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-14"></a> -------------- .&gt; celery           <span class="nv">exchange</span><span class="o">=</span>celery<span class="o">(</span>direct<span class="o">)</span> <span class="nv">key</span><span class="o">=</span>celery
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-15"></a>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-16"></a>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-17"></a><span class="o">[</span>tasks<span class="o">]</span>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-18"></a>  . tasks.multiply
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-19"></a>
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-20"></a><span class="o">[</span><span class="m">2015</span>-03-20 <span class="m">21</span>:56:16,526: INFO/MainProcess<span class="o">]</span> Connected to redis://localhost:6379/0
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-21"></a><span class="o">[</span><span class="m">2015</span>-03-20 <span class="m">21</span>:56:16,541: INFO/MainProcess<span class="o">]</span> mingle: searching <span class="k">for</span> neighbors
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-22"></a><span class="o">[</span><span class="m">2015</span>-03-20 <span class="m">21</span>:56:17,780: INFO/MainProcess<span class="o">]</span> mingle: all alone
<a name="rest_code_8849ad7ee1e2423a84939f1b57955d49-23"></a><span class="o">[</span><span class="m">2015</span>-03-20 <span class="m">21</span>:56:17,791: WARNING/MainProcess<span class="o">]</span> celery@nightcrawler ready.
</pre>
<p>There is a lot of information here:</p>
<ul class="simple">
<li>Used versions</li>
<li>Created queues</li>
<li>Brokers used to transport and retrieve results</li>
<li>Number of workers, that is, processes available to process a request in a concurrent way.</li>
</ul>
<p>And more, but it can be ignored right now.</p>
<p>We will leave it running.</p>
</div>
<div class="section" id="running-services">
<h3>Running services</h3>
<p>That was the <em>subscriptor</em>. Let create the <em>publisher</em>.</p>
<p><a class="reference external" href="/listings/python-celery/001/subscriber.py.html">python-celery/001/subscriber.py</a></p>
<pre class="code python"><a name="rest_code_5d52d2a1527644559b54aab0194188a1-1"></a><span class="c1"># Celery client example: request for two numbers multiplication</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-2"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-3"></a>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-4"></a><span class="c1"># RabbitMQ</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-5"></a><span class="c1">#app = Celery('tasks', broker='amqp://guest@localhost//', backend='amqp')</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-6"></a><span class="c1"># Redis</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-7"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">'tasks'</span><span class="p">,</span> <span class="n">broker</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">)</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-8"></a>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-9"></a><span class="n">promise</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">send_task</span><span class="p">(</span><span class="s1">'tasks.multiply'</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-10"></a>
<a name="rest_code_5d52d2a1527644559b54aab0194188a1-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">promise</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre>
<p>This is more complicated... but quick to be explained:</p>
<ul class="simple">
<li>First part is the same than before, because we need to conect to the same server.</li>
<li>Second part runs the task with its name, passing the arguments. That returns a <em>promise</em>. At this point we have leaved a message in the queue.</li>
<li>Finally, the <em>promise</em> is resolved with <tt class="docutils literal">promise.get()</tt>. Whenever, the service had read and processed the message, and it has leaved the result in other queue and, with this method, it is read.</li>
</ul>
<p>So it seems complicated... but it could be even more.</p>
<p>Anyways, I've saved a video to see it all:</p>
<iframe width="425" height="344" src="//www.youtube.com/embed/Lf4Q7K6Ab_g?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
<div class="section" id="everything-together-is-easier">
<h3>Everything together is easier</h3>
<p>You can put it all together in the same file, and everything become easier. This is not always possible and can give problems (like every change implies to reboot both client and service), but is very educational:</p>
<p><a class="reference external" href="/listings/python-celery/002/tasks.py.html">python-celery/002/tasks.py</a></p>
<pre class="code python"><a name="rest_code_0593d76c66304829b43b9278873b7130-1"></a><span class="c1"># Celery full example: publisher/subscriber to request a multiplication</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-2"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-3"></a>
<a name="rest_code_0593d76c66304829b43b9278873b7130-4"></a><span class="c1"># RabbitMQ</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-5"></a><span class="c1">#app = Celery('tasks', broker='amqp://guest@localhost//', backend='amqp')</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-6"></a><span class="c1"># Redis</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-7"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">'tasks'</span><span class="p">,</span> <span class="n">broker</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">)</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-8"></a>
<a name="rest_code_0593d76c66304829b43b9278873b7130-9"></a><span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-10"></a><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-11"></a>    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-12"></a>
<a name="rest_code_0593d76c66304829b43b9278873b7130-13"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-14"></a>    <span class="n">promise</span> <span class="o">=</span> <span class="n">multiply</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">promise</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-16"></a>
<a name="rest_code_0593d76c66304829b43b9278873b7130-17"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
<a name="rest_code_0593d76c66304829b43b9278873b7130-18"></a>    <span class="n">main</span><span class="p">()</span>
</pre>
<p>Now we are running a task method directly, so we get the task.</p>
<p>And now we have a very complicated way to multiply two numbers :)</p>
</div>
</div>
<div class="section" id="tools">
<h2>Tools</h2>
<p>As I said before, <a class="reference external" href="http://www.celeryproject.org/">Celery</a> gives you tools and syntactic sugar.</p>
<p>First of all, we'll see <em>partials</em>. They are functions with some parameters already set.</p>
<p>It is very easy to create the <em>partial</em> <tt class="docutils literal">duplicate</tt> by forcing the first parameter of <tt class="docutils literal">multiply</tt>:</p>
<p><a class="reference external" href="/listings/python-celery/003/tasks.py.html">python-celery/003/tasks.py</a></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="/en/blog/python-distribuido-celery/#rest_code_bdbff9a9fc4542afa80170dcc3153d24-13">13</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_bdbff9a9fc4542afa80170dcc3153d24-14">14</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_bdbff9a9fc4542afa80170dcc3153d24-15">15</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_bdbff9a9fc4542afa80170dcc3153d24-16">16</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_bdbff9a9fc4542afa80170dcc3153d24-13"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<a name="rest_code_bdbff9a9fc4542afa80170dcc3153d24-14"></a>    <span class="n">duplicate</span> <span class="o">=</span> <span class="n">multiply</span><span class="o">.</span><span class="n">si</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_bdbff9a9fc4542afa80170dcc3153d24-15"></a>    <span class="n">promise</span> <span class="o">=</span> <span class="n">duplicate</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="rest_code_bdbff9a9fc4542afa80170dcc3153d24-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">promise</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre></td>
</tr></table>
<p>Yeah, partials are built with method <tt class="docutils literal">.si</tt>, despite we can use <tt class="docutils literal">.s</tt> too. The fist one is <em>immutable</em> (that explains the <tt class="docutils literal">i</tt>). It is very difficult to explain this before explaining another <a class="reference external" href="http://www.celeryproject.org/">Celery</a> tool: <tt class="docutils literal">Chains</tt>.</p>
<p><a class="reference external" href="http://www.celeryproject.org/">Celery</a> allows to chain tasks, so the result of one is the first parameter of the next one. Why the first one? It works so. It is a fucking shit, but works so.</p>
<p>Sometimes we will require chained tasks just to set an order, so we can ignore the previous result. Here is when we can use the immutable functions, because they won't use the previous task result.</p>
<p>I suppose you have noticed I use "functions" or "services" equally.</p>
<p>But too much talk; let's concat something:</p>
<p><a class="reference external" href="/listings/python-celery/004/tasks.py.html">python-celery/004/tasks.py</a></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-13">13</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-14">14</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-15">15</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-16">16</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-17">17</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-18">18</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-19">19</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_fcfe1163362545998c68954dfb6e90ad-20">20</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_fcfe1163362545998c68954dfb6e90ad-13"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">chain</span>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-14"></a>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-15"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-16"></a>    <span class="n">duplicate</span> <span class="o">=</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-17"></a>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-18"></a>    <span class="n">task</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-19"></a>    <span class="n">promise</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
<a name="rest_code_fcfe1163362545998c68954dfb6e90ad-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">promise</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre></td>
</tr></table>
<p>As I said before, <a class="reference external" href="http://www.celeryproject.org/">Celery</a> gives syntactic sugar, so it can be rewritten to:</p>
<p><a class="reference external" href="/listings/python-celery/005/tasks.py.html">python-celery/005/tasks.py</a></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="/en/blog/python-distribuido-celery/#rest_code_2491ff5f68194d9d805793271457c790-13">13</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_2491ff5f68194d9d805793271457c790-14">14</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_2491ff5f68194d9d805793271457c790-15">15</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_2491ff5f68194d9d805793271457c790-16">16</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_2491ff5f68194d9d805793271457c790-17">17</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_2491ff5f68194d9d805793271457c790-18">18</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_2491ff5f68194d9d805793271457c790-13"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<a name="rest_code_2491ff5f68194d9d805793271457c790-14"></a>    <span class="n">duplicate</span> <span class="o">=</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_2491ff5f68194d9d805793271457c790-15"></a>
<a name="rest_code_2491ff5f68194d9d805793271457c790-16"></a>    <span class="n">task</span> <span class="o">=</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_2491ff5f68194d9d805793271457c790-17"></a>    <span class="n">promise</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
<a name="rest_code_2491ff5f68194d9d805793271457c790-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">promise</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre></td>
</tr></table>
<p>And here is where fun starts: we have a <strong>canvas</strong>, that is, a task workflow. Believe ir or not, if you launch several <em>workers</em> in different hosts and all of them are connected to the same <em>broker</em>, each operation could run in a different host.</p>
<p>But... Why the <em>canvas</em> if all the operations run sequentially? Because we can process them concurrently with <tt class="docutils literal">Groups</tt>:</p>
<p><a class="reference external" href="/listings/python-celery/006/tasks.py.html">python-celery/006/tasks.py</a></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-13">13</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-14">14</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-15">15</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-16">16</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-17">17</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-18">18</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-19">19</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-20">20</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-21">21</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-22">22</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-23">23</a>
<a href="/en/blog/python-distribuido-celery/#rest_code_752f78a2b65740df83ae358baf65593c-24">24</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_752f78a2b65740df83ae358baf65593c-13"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">group</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-14"></a>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-15"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-16"></a>    <span class="n">duplicate</span> <span class="o">=</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-17"></a>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-18"></a>    <span class="n">task</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-19"></a>        <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-20"></a>        <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-21"></a>        <span class="n">multiply</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">duplicate</span><span class="p">,</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-22"></a>    <span class="p">)</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-23"></a>    <span class="n">promise</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
<a name="rest_code_752f78a2b65740df83ae358baf65593c-24"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">promise</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre></td>
</tr></table>
<p>There is even more syntactic sugar, like <tt class="docutils literal">chords</tt>, <tt class="docutils literal">maps</tt>, <tt class="docutils literal">starmaps</tt> and <tt class="docutils literal">chunks</tt>, but we won't browse them. This is an introductory post. <a class="reference external" href="http://celery.readthedocs.org/en/latest/userguide/canvas.html">You can read more about Canvas</a>.</p>
<div class="section" id="the-beat">
<h3>The Beat</h3>
<p>Other important tool in <a class="reference external" href="http://www.celeryproject.org/">Celery</a> is the <strong>Beat</strong>. It is a beat or a periodic signal. We can start it in the worker with <tt class="docutils literal"><span class="pre">--beat</span></tt> option. While <a class="reference external" href="https://github.com/celery/celery/issues/1495">Beat exclusiveness</a> is not added, it is important to run just one or we will receive more than one <em>beat</em>.</p>
<p>This <em>beat</em> allows us to run periodic tasks.</p>
<p>Let's see a small example: we are going to multiply the hour by 2 every 10 seconds:</p>
<p><a class="reference external" href="/listings/python-celery/007/tasks.py.html">python-celery/007/tasks.py</a></p>
<pre class="code python"><a name="rest_code_943fbf55e9584674b7cee2025811c5f8-1"></a><span class="c1"># Celery beat example: periodic date operation</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-2"></a><span class="kn">import</span> <span class="nn">datetime</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-3"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-4"></a><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">group</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-5"></a>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-6"></a><span class="c1"># RabbitMQ</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-7"></a><span class="c1">#app = Celery('tasks', broker='amqp://guest@localhost//', backend='amqp')</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-8"></a><span class="c1"># Redis</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-9"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">'tasks'</span><span class="p">,</span> <span class="n">broker</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">'redis://localhost:6379/0'</span><span class="p">)</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-10"></a>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-11"></a><span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-12"></a><span class="k">def</span> <span class="nf">add_days</span><span class="p">(</span><span class="n">days</span><span class="p">):</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-13"></a>    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-14"></a>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-15"></a><span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-16"></a>    <span class="n">CELERYBEAT_SCHEDULE</span><span class="o">=</span><span class="p">{</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-17"></a>        <span class="s1">'multiply-each-10-seconds'</span><span class="p">:</span> <span class="p">{</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-18"></a>            <span class="s1">'task'</span><span class="p">:</span> <span class="s1">'tasks.add_days'</span><span class="p">,</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-19"></a>            <span class="s1">'schedule'</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-20"></a>            <span class="s1">'args'</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">)</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-21"></a>        <span class="p">},</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-22"></a>    <span class="p">},</span>
<a name="rest_code_943fbf55e9584674b7cee2025811c5f8-23"></a><span class="p">)</span>
</pre>
<p>And here you have the video:</p>
<iframe width="425" height="344" src="//www.youtube.com/embed/qTXJUnV0oHU?rel=0&amp;hd=1&amp;wmode=transparent"></iframe><p>Again, I'm going to stop here; I can only show a little about it. You can read more about <a class="reference external" href="http://celery.readthedocs.org/en/latest/userguide/periodic-tasks.html">periodic tasks</a> if you are interested in.</p>
</div>
<div class="section" id="warning-pickle">
<h3>Warning: pickle</h3>
<p>Perhaps you see a warning like <tt class="docutils literal">warnings.warn(CDeprecationWarning(W_PICKLE_DEPRECATED))</tt>. This is because we are using the <a class="reference external" href="https://docs.python.org/3.4/library/pickle.html">pickle</a> serializer, which is deprecated. You can avoid it by adding:</p>
<p><a class="reference external" href="/listings/python-celery/008/tasks.py.html">python-celery/008/tasks.py</a></p>
<table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="/en/blog/python-distribuido-celery/#rest_code_6f5742086ae14d5bba77497b453a037f-23">23</a></pre></div></td>
<td class="code"><pre class="code python"><a name="rest_code_6f5742086ae14d5bba77497b453a037f-23"></a>    <span class="n">CELERY_ACCEPT_CONTENT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'json'</span><span class="p">],</span>
</pre></td>
</tr></table>
</div>
</div>
<div class="section" id="complex-environments">
<h2>Complex environments</h2>
<p>Obviously, I've talked just about basic <a class="reference external" href="http://www.celeryproject.org/">Celery</a>. We've used just a queue to communicate. As long as <a class="reference external" href="https://www.rabbitmq.com">RabbitMQ</a> allows queue operations, <a class="reference external" href="http://www.celeryproject.org/">Celery</a> too.</p>
<p>You can:</p>
<ul class="simple">
<li>assign different queues to perform different tasks, so not all workers listen all requests or to assign different workers to different queues.</li>
<li>route messages between queues.</li>
<li>send messages to all queues (<strong>topic</strong>).</li>
<li>...</li>
</ul>
<p>I'm not going to explain it deeply, but I'm going to describe the message path. This information is required to understand how routing works (found at <a class="reference external" href="http://celery.readthedocs.org/en/latest/userguide/routing.html#exchanges-queues-and-routing-keys">Exchanges, queues and routing keys</a>):</p>
<ol class="arabic simple">
<li>Message is sent. It is leaved in an <strong>EXCHANGE</strong>. If it doesn't exist, <a class="reference external" href="http://www.celeryproject.org/">Celery</a> will create it.</li>
<li>The <strong>EXCHANGE</strong> routes the message to one or more queues, depending on its configuration. If queues doesn't exist, <a class="reference external" href="http://www.celeryproject.org/">Celery</a> will care.</li>
<li>The message waits in the queue until a consumer takeExchanges it. At this moment, the message is blocked to avoid other consumers to take it.</li>
<li>After processing it, consumer sends an <strong>ACK</strong> and the message is finally removed.</li>
</ol>
<p>By default, <a class="reference external" href="http://www.celeryproject.org/">Celery</a> creates queues with the <em>exchange</em> name and binds them in a direct way, that is, every message that gets the <em>exchange</em> is routed to that queue.</p>
<p>You can play with routings and create really complex architectures, so any message arrives to its target depending on the operation.</p>
</div>
<div class="section" id="more-information">
<h2>More information</h2>
<p>The post <a class="reference external" href="http://abhishek-tiwari.com/post/amqp-rabbitmq-and-celery-a-visual-guide-for-dummies">AMQP, RabbitMQ and Celery - A Visual Guide For Dummies</a> has beginner level, but I like it a lot because it explains everything with images. <a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-use-celery-with-rabbitmq-to-queue-tasks-on-an-ubuntu-vps">How To Use Celery with RabbitMQ to Queue Tasks on an Ubuntu VPS</a> is good too, and the PyCon slides <a class="reference external" href="http://www.imankulov.name/posts/celery-for-internal-api.html">Celery for Internal API in SOA infrastructure</a> too.</p>
<p><a class="reference external" href="http://www.caktusgroup.com/blog/2014/06/23/scheduling-tasks-celery/">Getting Started Scheduling Tasks with Celery</a> is about configuring periodic tasks in a dynamic way by using <a class="reference external" href="https://pypi.python.org/pypi/django-celery">DJCelery</a>, quite interesting to use it with <a class="reference external" href="https://www.djangoproject.com/">Django</a>.</p>
<p>In order to understand it under the hood, I recommend <a class="reference external" href="http://www.rabbitmq.com/tutorials/amqp-concepts.html">AMQP 0-9-1 Model Explained</a>, where <a class="reference external" href="https://www.amqp.org/">AMQP</a> protocol is explained. It is very interesing to try complex routings. <a class="reference external" href="http://rajith.2rlabs.com/2007/10/13/amqp-in-10-mins-part3-flexible-routing-model/">AMQP in 10 mins : Part3 – Flexible Routing Model</a> talks about that too, but is easier and just explains the basic concepts.</p>
<p>If you want to participate in a project using <a class="reference external" href="http://www.celeryproject.org/">Celery</a>, I can cheer you to help me with <a class="reference external" href="https://github.com/djcron-project/">DJCron</a>, a wrapper over <a class="reference external" href="https://pypi.python.org/pypi/django-celery">DJCelery</a> that allows to configure distributed tasks dinamically, adding some extra features over  <a class="reference external" href="https://pypi.python.org/pypi/django-celery">DJCelery</a>.</p>
</div>
</div>
          </div>
          <br><div>
            <nav><span class="author">
                <span class="glyphicon glyphicon-user"></span> 
                <span>Posted:Miguel Ángel García</span>
              </span>
               

              
              <span class="dateline">
                <span class="glyphicon glyphicon-calendar"></span> 
                <time class="published dt-published" datetime="2015-03-20T00:00:00+00:00" title="2015-03-20">2015-03-20</time></span>
               
              <span class="tags">
                <span class="glyphicon glyphicon-tags"></span> 
                <a class="label label-primary p-category" href="/en/categories/celery/" rel="tag">celery</a>
                <a class="label label-primary p-category" href="/en/categories/python/" rel="tag">python</a>
              </span>
                      <ul class="pager">
<li class="previous">
              <a href="/en/blog/gashlycode-tinies/" rel="prev" title="Gashlycode Tinies">
                <span class="glyphicon glyphicon-arrow-left"></span>
                Previous post
              </a>
            </li>
            <li class="next">
              <a href="/en/blog/is-code-coverage-irrelevant/" rel="next" title="Is Code Coverage Irrelevant?">
                Next post
                <span class="glyphicon glyphicon-arrow-right"></span>
              </a>
            </li>
        </ul></nav>
</div>
          <section class="comments"><h2>Comments</h2>
                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="magmax",
            disqus_url="http://magmax.org/en/blog/python-distribuido-celery/",
        disqus_title="Distributed Python: Celery",
        disqus_identifier="cache/posts/python-distribuido-celery.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


          </section></article><script>var disqus_shortname="magmax";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
      <aside class="sidebar col-md-3"><div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">Last comments</h3>
  </div>
  <div class="panel-body">
    <div id="disqus_last_comments" class="dsq-widget">
      <script type="text/javascript" src="https://magmax.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=32&amp;excerpt_length=150">
      </script>
</div>
  </div>
</section>
</div>
          <div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="panel-body">
    <ul id="gh_repos" class="list-unstyled">
<li class="loading">Status updating…</li>
    </ul>
</div>
  <div class="panel-footer">
    <a href="https://github.com/magmax">@magmax</a> on GitHub
  </div>
</section>
</div>
      </aside>
</div>

    <footer>
      Contents © 2009-2020 <a href="mailto:">Miguel Ángel García</a> 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/es/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;width:80px;height:15px;vertical-align:middle" src="https://i.creativecommons.org/l/by-nc-sa/2.5/es/80x15.png"></a>; Using <a href="/stories/credits/">a lot of free software</a>
      
    </footer>
</div>
</div>




<script data-main="/assets/js/main" src="/assets/js/libs/require/require.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9308241-3', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
