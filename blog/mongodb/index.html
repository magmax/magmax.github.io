<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>MongoDB - El blog de MagMax</title><meta name="Description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ..."><meta property="og:title" content="MongoDB" />
<meta property="og:description" content="En este artículo voy a exponer un problema, como de costumbre, y a resolverlo de la manera más rápida posible. Una vez hecho esto, trataré de cambiarlo para que utilice MongoDB para la persistencia. Usaré YAGNI.
No soy un experto en MongoDB, sino que estoy comenzando mis primeros pinitos. Por eso voy a tratar de explicarlo como yo lo veo.
El problema es el siguiente: quiero un programa que me permita gestionar mi biblioteca. Algo sencillo: sólo libro y autor. Y quiero poder buscar un libro por el título.
La idea de este artículo partió del titulado &ldquo;Diseño emergente, también para la base de datos&rdquo;, por Carlos Blé.
Usaré python y freshen." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/mongodb/" />
<meta property="og:image" content="https://magmax.org/icons/favicon.png"/>
<meta property="article:published_time" content="2012-08-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="MongoDB"/>
<meta name="twitter:description" content="En este artículo voy a exponer un problema, como de costumbre, y a resolverlo de la manera más rápida posible. Una vez hecho esto, trataré de cambiarlo para que utilice MongoDB para la persistencia. Usaré YAGNI.
No soy un experto en MongoDB, sino que estoy comenzando mis primeros pinitos. Por eso voy a tratar de explicarlo como yo lo veo.
El problema es el siguiente: quiero un programa que me permita gestionar mi biblioteca. Algo sencillo: sólo libro y autor. Y quiero poder buscar un libro por el título.
La idea de este artículo partió del titulado &ldquo;Diseño emergente, también para la base de datos&rdquo;, por Carlos Blé.
Usaré python y freshen."/>
<meta name="application-name" content="El blog de MagMax">
<meta name="apple-mobile-web-app-title" content="El blog de MagMax"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/mongodb/" /><link rel="prev" href="https://magmax.org/blog/porque_c_mola/" /><link rel="next" href="https://magmax.org/blog/porque-ruby-mola/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "MongoDB",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/mongodb\/"
        },"genre": "posts","keywords": "nosql, mongodb","wordcount":  2396 ,
        "url": "https:\/\/magmax.org\/blog\/mongodb\/","datePublished": "2012-08-30T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Miguel Ángel"},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/mongodb/" selected>Español</option></select>
                    </a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/mongodb/" selected>Español</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">MongoDB</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Miguel Ángel</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="30 Aug 2012">30 Aug 2012</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2396 palabras&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;12 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#primeros-pasos">Primeros pasos</a>
      <ul>
        <li><a href="#comenzando-definir-lo-que-queremos">Comenzando: definir lo que queremos</a></li>
        <li><a href="#preparando-el-entorno-de-pruebas">Preparando el entorno de pruebas</a></li>
        <li><a href="#pasando-los-tests">Pasando los tests</a></li>
      </ul>
    </li>
    <li><a href="#avanzando">Avanzando</a>
      <ul>
        <li><a href="#creando-más-tests-de-aceptación">Creando más tests de aceptación</a></li>
        <li><a href="#pasando-los-tests-1">Pasando los tests</a></li>
      </ul>
    </li>
    <li><a href="#conclusiones">Conclusiones</a></li>
    <li><a href="#pasándolo-a-mongodb">Pasándolo a MongoDB</a></li>
    <li><a href="#mongodb">MongoDB</a>
      <ul>
        <li><a href="#conexiones-bases-de-datos-y-colecciones">Conexiones, bases de datos y colecciones</a></li>
        <li><a href="#el-lenguaje-javascript">El lenguaje: JavaScript</a></li>
      </ul>
    </li>
    <li><a href="#conclusión">Conclusión</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>En este artículo voy a exponer un problema, como de costumbre, y a resolverlo de la manera más rápida posible. Una vez hecho esto, trataré de cambiarlo para que utilice MongoDB para la persistencia. Usaré YAGNI.</p>
<p>No soy un experto en MongoDB, sino que estoy comenzando mis primeros pinitos. Por eso voy a tratar de explicarlo como yo lo veo.</p>
<p>El problema es el siguiente: quiero un programa que me permita gestionar mi biblioteca. Algo sencillo: sólo libro y autor. Y quiero poder buscar un libro por el título.</p>
<p>La idea de este artículo partió del titulado &ldquo;<a href="https://www.carlosble.com/2012/08/diseno-emergente-tambien-para-la-base-de-datos/" target="_blank" rel="noopener noreffer">Diseño emergente, también para la base de datos</a>&rdquo;, por <a href="https://twitter.com/carlosble" target="_blank" rel="noopener noreffer">Carlos Blé</a>.</p>
<p>Usaré python y freshen.</p>
<figure>
    <img src="/images/mongo.png"
         alt="Mongo DB"/> 
</figure>

<h2 id="primeros-pasos">Primeros pasos</h2>
<h3 id="comenzando-definir-lo-que-queremos">Comenzando: definir lo que queremos</h3>
<p>El primer paso es decidir qué es lo que quiero. Veamos&hellip; Lo que quiero es buscar un libro por el título. Eso es lo más importante. Pero no puedo buscar nada si no indico el título o el autor. Así que comenzaré por ahí:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-gherkin" data-lang="gherkin"><span class="c"># file: ./tests/library.feature</span><span class="nf">
</span><span class="nf"></span><span class="k">Feature:</span><span class="nf">
</span><span class="nf">  In order to store my library reference
</span><span class="nf">  As a book lover
</span><span class="nf">  I want to be sure my library works
</span><span class="nf">
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Author or title is necessary to search a book
</span><span class="nf"></span><span class="k">    When </span><span class="nf">I search a book without parameters
</span><span class="nf">    </span><span class="k">Then </span><span class="nf">output contains &#34;</span><span class="s">You should ask for a title or an author</span><span class="nf">&#34;
</span></code></pre></td></tr></table>
</div>
</div><p>Ahora trato de ejecutarlo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ nosetests --with-freshen tests/library.feature
</code></pre></td></tr></table>
</div>
</div><h3 id="preparando-el-entorno-de-pruebas">Preparando el entorno de pruebas</h3>
<p>Evidentemente tengo un error. <a href="https://github.com/rlisagor/freshen" target="_blank" rel="noopener noreffer">Freshen</a> me está diciendo que no encuentra la manera de ejecutar los pasos del escenario. Por eso tengo que escribir el archivo <em>steps.py</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># file ./tests/steps.py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">freshen</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">freshen.checks</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">DATABASE_FILE</span><span class="o">=</span><span class="s1">&#39;test_db&#39;</span>

<span class="k">def</span> <span class="nf">before</span><span class="p">(</span><span class="n">sc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATABASE_FILE</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">DATABASE_FILE</span><span class="p">)</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;./library.py&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="n">DATABASE_FILE</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">scc</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">process</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>


<span class="nd">@When</span><span class="p">(</span><span class="s1">&#39;^I search a book without parameters$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exec_search_without_parameters</span><span class="p">():</span>
    <span class="n">execute</span><span class="p">([</span><span class="s1">&#39;--action=show&#39;</span><span class="p">])</span>

<span class="nd">@Then</span><span class="p">(</span><span class="s1">&#39;^output contains &#34;(.*)&#34;$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">check_output_contains</span><span class="p">(</span><span class="n">expected</span><span class="p">):</span>
    <span class="n">assert_true</span><span class="p">(</span><span class="n">expected</span> <span class="ow">in</span> <span class="n">scc</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;Text &#34;{}&#34;, was not found in &#34;{}&#34;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">scc</span><span class="o">.</span><span class="n">output</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>Para leer este archivo es mejor comenzar por las claves básicas: el <em>When</em> y el
<em>Then</em>. Está claro que en el <em>When</em> lo que quiero es ejecutar mi aplicación; por
eso la función comienza por <code>exec_</code>. En el <em>Then</em> realizaré las
comprobaciones pertinentes, por lo que comienza por <code>check_</code>.</p>
<p>Llegados a este punto ya he tomado numerosas decisiones:</p>
<ul>
<li>he decidido que mi biblioteca se ejecuta desde línea de órdenes. Eso es así porque era lo más sencillo de probar.</li>
<li>he decidido que tenga un parámetro <code>action</code> que admita la variable <code>show</code> que mostrará la información del libro.</li>
<li>he decidido el nombre del programa principal, <code>library.py</code></li>
<li>he decidio que, de alguna manera, necesitaré un sitio donde guardar la información; claramente necesitaré limpiar ese sitio entre test y test.</li>
</ul>
<p>Todo esto&hellip; Y aún no he escrito una línea del programa.</p>
<h3 id="pasando-los-tests">Pasando los tests</h3>
<p>Vamos a por él:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#File: ./library.py</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">argparse</span>


<span class="k">class</span> <span class="nc">Library</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="n">db</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should ask for a title or an author&#39;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">parse_args</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;My library!&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--action&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;indicates the action to be performed&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--author&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&#34;store&#34;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The author of the book&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--title&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&#34;store&#34;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The title of the book&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--database&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&#34;store&#34;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;library.db&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the database file&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">args</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parse_args</span><span class="p">()</span>

    <span class="n">library</span> <span class="o">=</span> <span class="n">Library</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;show&#39;</span><span class="p">:</span>
        <span class="n">library</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Como veréis, he hecho un poco de trampa. He decidido especificar la interfaz más probable que voy a necesitar. Así no me voy a tener que preocupar después por pelearme con el párser. Podría cambiar cualquier cosa, ya que no está comprometida mediante un test.</p>
<p>Pruebo a volver a ejecutarlo y ahora&hellip; pasa. Claro. No hay mucho que hacer de momento.</p>
<h2 id="avanzando">Avanzando</h2>
<h3 id="creando-más-tests-de-aceptación">Creando más tests de aceptación</h3>
<p>Con el fin de no alargar mucho el artículo, voy a escribir todo el programa del tirón, aunque en realidad lo he ido escribiendo escenario a escenario.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-gherkin" data-lang="gherkin"><span class="c"># file: ./tests/library.feature</span><span class="nf">
</span><span class="nf"></span><span class="k">Feature:</span><span class="nf">
</span><span class="nf">  In order to store my library reference
</span><span class="nf">  As a book lover
</span><span class="nf">  I want to be sure my library works
</span><span class="nf">
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Author or title is necessary to search a book
</span><span class="nf"></span><span class="k">    When </span><span class="nf">I search a book without parameters
</span><span class="nf">    </span><span class="k">Then </span><span class="nf">output contains &#34;</span><span class="s">You should ask for a title or an author</span><span class="nf">&#34;
</span><span class="nf">
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Searching an inexistent book
</span><span class="nf"></span><span class="k">    When </span><span class="nf">I search the book &#34;</span><span class="s">inexistent</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">Then </span><span class="nf">output contains &#34;</span><span class="s">Book not found</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">And </span><span class="nf">my library do not contains the title &#34;</span><span class="s">inexistent</span><span class="nf">&#34;
</span><span class="nf">
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Adding a title
</span><span class="nf"></span><span class="k">    When </span><span class="nf">I add the book &#34;</span><span class="s">Fundation</span><span class="nf">&#34; written by &#34;</span><span class="s">Assimov, Isaac</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">Then </span><span class="nf">output contains &#34;</span><span class="s">Book added</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">And </span><span class="nf">my library contains the title &#34;</span><span class="s">Fundation</span><span class="nf">&#34;
</span><span class="nf">
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Searching an existent a title
</span><span class="nf"></span><span class="k">    Given </span><span class="nf">the book &#34;</span><span class="s">I, Robot</span><span class="nf">&#34;, written by &#34;</span><span class="s">Assimov, Isaac</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">When </span><span class="nf">I search the book &#34;</span><span class="s">I, Robot</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">Then </span><span class="nf">output contains &#34;</span><span class="s">Assimov, Isaac</span><span class="nf">&#34;
</span><span class="nf">
</span><span class="nf">  </span><span class="k">Scenario:</span><span class="nf"> Removing a title
</span><span class="nf"></span><span class="k">    Given </span><span class="nf">the book &#34;</span><span class="s">I, Robot</span><span class="nf">&#34;, written by &#34;</span><span class="s">Assimov, Isaac</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">When </span><span class="nf">I remove the book &#34;</span><span class="s">I, Robot</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">Then </span><span class="nf">output contains &#34;</span><span class="s">Book removed</span><span class="nf">&#34;
</span><span class="nf">    </span><span class="k">And </span><span class="nf">my library do not contains the title &#34;</span><span class="s">I, Robot</span><span class="nf">&#34;
</span></code></pre></td></tr></table>
</div>
</div><p>Lo que fallará estrepitosamente porque <em>freshen</em> no encuentra la mayoría de las frases. Vamos a solucionarlo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#File: ./tests/steps.py</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">freshen</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">freshen.checks</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>

<span class="n">DATABASE_FILE</span><span class="o">=</span><span class="s1">&#39;test.db&#39;</span>

<span class="k">def</span> <span class="nf">before</span><span class="p">(</span><span class="n">sc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATABASE_FILE</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">DATABASE_FILE</span><span class="p">)</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;./library.py&#39;</span><span class="p">,</span> <span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="n">DATABASE_FILE</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span>
    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
    <span class="n">output</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">scc</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">scc</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">process</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>


<span class="nd">@Given</span><span class="p">(</span><span class="s1">&#39;^the book &#34;(.*)&#34;, written by &#34;(.*)&#34;$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">initialize_library</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
    <span class="n">execute</span><span class="p">([</span><span class="s1">&#39;--action=add&#39;</span><span class="p">,</span> <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="n">author</span><span class="p">])</span>

<span class="nd">@When</span><span class="p">(</span><span class="s1">&#39;^I search the book &#34;(.*)&#34;$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exec_search_by_title</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">execute</span><span class="p">([</span><span class="s1">&#39;--action=show&#39;</span><span class="p">,</span> <span class="s1">&#39;--title&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">])</span>

<span class="nd">@When</span><span class="p">(</span><span class="s1">&#39;^I search a book without parameters$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exec_search_without_parameters</span><span class="p">():</span>
    <span class="n">execute</span><span class="p">([</span><span class="s1">&#39;--action=show&#39;</span><span class="p">])</span>

<span class="nd">@When</span><span class="p">(</span><span class="s1">&#39;I add the book &#34;(.*)&#34; written by &#34;(.*)&#34;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exec_add_book</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
    <span class="n">execute</span><span class="p">([</span><span class="s1">&#39;--action=add&#39;</span><span class="p">,</span> <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="n">author</span><span class="p">])</span>

<span class="nd">@When</span><span class="p">(</span><span class="s1">&#39;I remove the book &#34;(.*)&#34;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exec_remove_book</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">execute</span><span class="p">([</span><span class="s1">&#39;--action=remove&#39;</span><span class="p">,</span> <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">])</span>

<span class="nd">@Then</span><span class="p">(</span><span class="s1">&#39;^output contains &#34;(.*)&#34;$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">check_output_contains</span><span class="p">(</span><span class="n">expected</span><span class="p">):</span>
    <span class="n">assert_true</span><span class="p">(</span><span class="n">expected</span> <span class="ow">in</span> <span class="n">scc</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="s1">&#39;Text &#34;{}&#34;, was not found in &#34;{}&#34;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">scc</span><span class="o">.</span><span class="n">output</span><span class="p">))</span>

<span class="nd">@Then</span><span class="p">(</span><span class="s1">&#39;^my library( do not|) contains the title &#34;(.*)&#34;$&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">check_contains_title</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">rc</span> <span class="o">=</span> <span class="n">run</span><span class="p">([</span><span class="s1">&#39;--action=show&#39;</span><span class="p">,</span> <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
        <span class="n">assert_equals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="s1">&#39;The book &#34;{}&#34; is not in the collection&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">assert_equals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rc</span><span class="p">,</span> <span class="s1">&#39;The book &#34;{}&#34; is in the collection but it shouldnot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>Lo que provocará que los tests se lancen&hellip; pero fallen.</p>
<h3 id="pasando-los-tests-1">Pasando los tests</h3>
<p>Primero el código y luego lo comento.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>
<span class="c1">#File: ./library.py</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">shelve</span>


<span class="k">class</span> <span class="nc">Library</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="n">db</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should ask for a title or an author&#39;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db_file</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">db</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
            <span class="k">print</span> <span class="s1">&#39;Book not found&#39;</span>
            <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;{} -&gt; {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">db</span><span class="p">[</span><span class="n">title</span><span class="p">])</span>
        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should introduce the title and author&#39;</span>
            <span class="k">return</span>

        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db_file</span><span class="p">()</span>
        <span class="n">db</span><span class="p">[</span><span class="n">title</span><span class="p">]</span> <span class="o">=</span> <span class="n">author</span>
        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">print</span> <span class="s1">&#39;Book added&#39;</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should introduce the title to remove&#39;</span>
            <span class="k">return</span>

        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_db_file</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">db</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">db</span><span class="p">[</span><span class="n">title</span><span class="p">]</span>
        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">print</span> <span class="s1">&#39;Book removed&#39;</span>

    <span class="k">def</span> <span class="nf">_db_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">shelve</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">parse_args</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;My library!&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--action&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;indicates the action to be performed&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span> <span class="s1">&#39;--author&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&#34;store&#34;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The author of the book&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;--title&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&#34;store&#34;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The title of the book&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--database&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&#34;store&#34;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;library.db&#39;</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the database file&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">args</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parse_args</span><span class="p">()</span>

    <span class="n">library</span> <span class="o">=</span> <span class="n">Library</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">database</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;show&#39;</span><span class="p">:</span>
        <span class="n">library</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;add&#39;</span><span class="p">:</span>
        <span class="n">library</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">author</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;remove&#39;</span><span class="p">:</span>
        <span class="n">library</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Como puede observarse, al utilizar <a href="https://docs.python.org/library/shelve.html" target="_blank" rel="noopener noreffer">Shelve</a> estoy creando una tabla <em>Hash</em> que me permite enlazar el título con el autor. Mientras busque por título, todo irá bien&hellip; cuando intente buscar por autor, sufriré una penalización terrible, ya que tendré que recorrer todos los valores :D</p>
<p>Como primera aproximación me basta. Así que puedo decir que está terminado.</p>
<h2 id="conclusiones">Conclusiones</h2>
<p>Puedo asegurar que hasta el escenario &ldquo;<em>Searching an existent a title</em>&rdquo; no decidí qué tipo de persistencia iba a utilizar. Y decidí utilizar <strong>Shelve</strong> porque es muy sencilla y me pareció que se ajustaba a lo que yo necesitaba. Igualmente podría haber utilizado un fichero de texto plano o haber volcado una <em>hash</em> a disco con <em>pickle</em>. No importa. No es nada importante.</p>
<p>Como veis, me he ajustado al enunciado en todo lo que he podido. Por eso tardé en escribirlo media hora, más o menos. Eso era importante, porque quería algo rápido pero usable. Además, me permite añadir más &ldquo;columnas&rdquo;, aunque tendría que portar los datos viejos o tirarlos, directamente.</p>
<h2 id="pasándolo-a-mongodb">Pasándolo a MongoDB</h2>
<p>Vamos ahora a tratar de aprovechar todo lo aprovechable y a utilizar <a href="https://www.mongodb.org/" target="_blank" rel="noopener noreffer">MongoDB</a> en su lugar. Para ello utilizaremos la librería <a href="https://api.mongodb.org/python/current/" target="_blank" rel="noopener noreffer">pymongo</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># file: ./library.py</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">pymongo</span>


<span class="k">class</span> <span class="nc">Library</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db</span> <span class="o">=</span> <span class="n">db</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should ask for a title or an author&#39;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_books_collection</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">find_one</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;Book not found&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">author</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should introduce the title and author&#39;</span>
            <span class="k">return</span>

        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_books_collection</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">save</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span><span class="n">title</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">:</span><span class="n">author</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect</span><span class="p">()</span>
        <span class="k">print</span> <span class="s1">&#39;Book added&#39;</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;You should introduce the title to remove&#39;</span>
            <span class="k">return</span>

        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_books_collection</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">remove</span><span class="p">({</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disconnect</span><span class="p">()</span>
        <span class="k">print</span> <span class="s1">&#39;Book removed&#39;</span>

    <span class="k">def</span> <span class="nf">_db_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">shelve</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_books_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span> <span class="o">=</span> <span class="n">pymongo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">27017</span><span class="p">)</span>
        <span class="n">db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_db</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">db</span><span class="p">[</span><span class="s1">&#39;books&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span> <span class="o">=</span> <span class="bp">None</span>

<span class="c1"># ...</span>
</code></pre></td></tr></table>
</div>
</div><p>El resto de ficheros será igual, de la misma forma que no he necesitado tocar el pársing de los parámetros de entrada. Y los tests pasan.</p>
<h2 id="mongodb">MongoDB</h2>
<p>¿Cómo funciona MongoDB? Pues exactamente igual que la librería <em>Shelve</em>: como una tabla <em>hash</em>.</p>
<p>En este caso he utilizado el título del libro como índice, lo que es poco recomendable. Lo he hecho así para que sea lo más parecida posible a la primera implementación y, así, pueda explicarlo más fácilmente.</p>
<p>Hay algunas diferencias&hellip; Para comenzar, en la versión <em>Shelve</em> no se sabe lo que es el contenido. MongoDB sí sabe que es el autor. Eso nos permitirá poder añadir nuevas características sobre la marcha, sin tener que migrar nada. Añadir nuevas columnas es gratis, ya que funcionan como otra hash. Para que la versión <em>Shelve</em> funcione igual, sólo tenéis que guardar el autor como una hash de la forma &ldquo;<em>{&lsquo;author&rsquo;: author}</em>&rdquo;.</p>
<p>Veamos un poco de la organización interna.</p>
<h3 id="conexiones-bases-de-datos-y-colecciones">Conexiones, bases de datos y colecciones</h3>
<p>Resulta fácil entender MongoDB como una <strong>hash de hashes</strong>:</p>
<ul>
<li>Una <strong>conexión</strong> a MongoDB tiene los nombres de las bases de datos como claves.</li>
<li>La <strong>base de datos</strong>, tiene los nombres de las colecciones como claves.</li>
<li>Una <strong>colección</strong> es el equivalente en una base de datos relacional a una tabla (más o menos). Y tendrá como claves los nombres de las columnas, aunque tiene otra serie de métodos que nos permitirán realizar búsquedas.</li>
</ul>
<h3 id="el-lenguaje-javascript">El lenguaje: JavaScript</h3>
<p>Una vez que hemos obtenido una instancia de la colección que queremos tratar, podemos realizar consultas. El lenguaje interno de mongodb es JavaScript.</p>
<p>A nivel básico no es necesario conocer este lenguaje para realizar consultas, ya que éstas serán solo <em>hashes</em> o listas. Con un par de ejemplos será suficiente. Sin embargo, a nivel avanzado la cosa cambia, ya que entraremos en el maravilloso mundo del <strong>mapreduce</strong> que&hellip; bueno, no termino de entender :D</p>
<p>Por lo poco que lo he tratado, el <em>mapreduce</em> consiste en dos partes:</p>
<ul>
<li>La primera parte, el <strong>map</strong>, consiste en seleccionar, de cada fila, los campos que nos hacen falta.</li>
<li>La segunda parte, el <strong>reduce</strong>, permite agrupar los datos obtenidos en la primera fase.</li>
</ul>
<p>Estas dos etapas se realizan de forma paralela, dando unos rendimientos muy elevados.</p>
<p>El <em>mapreduce</em> suele utilizarse para obtener estadísticas de la base de datos, tales como contar elementos que cumplen ciertos criterios.</p>
<p>Pero insisto en que estoy comenzando y, seguramente, diga alguna burrada XD</p>
<h2 id="conclusión">Conclusión</h2>
<p>Probablemente existan muchos escenarios en los que una base de datos <a href="https://es.wikipedia.org/wiki/NoSQL" target="_blank" rel="noopener noreffer">No-SQL</a> no sea la solución, pero creo que existen muchos más escenarios donde son la solución, pero los desarrolladores se empeñan en encajarla en una base de datos relacional. A menudo, con resultados desastrosos.</p>
<p>Por extraño que parezca, No-SQL es muy intuitivo. No resulta muy diferente de lo que haríamos sin bases de datos convencionales. Sin embargo, utilizar un motor nos ofrece ciertas ventajas que no debemos despreciar.</p>
<p>Sinceramente, creo que hay todo un mundo a descubrir en este sentido.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/mongodb/" data-title="MongoDB" data-hashtags="nosql,mongodb"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/mongodb/" data-hashtag="nosql"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/mongodb/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/mongodb/" data-title="MongoDB" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/mongodb/" data-title="MongoDB" data-tags="nosql,mongodb"><i class="fab fa-tumblr fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/mongodb/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/mongodb/" data-title="MongoDB" data-description=""><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Compartir en Digg" data-sharer="digg" data-url="https://magmax.org/blog/mongodb/"><i class="fab fa-digg fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/mongodb/" data-title="MongoDB" data-description=""><i class="fab fa-blogger fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/nosql/">nosql</a>,&nbsp;<a href="/tags/mongodb/">mongodb</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/porque_c_mola/" class="prev" rel="prev" title="Por qué C mola"><i class="fas fa-angle-left fa-fw"></i>Por qué C mola</a>
            <a href="/blog/porque-ruby-mola/" class="next" rel="next" title="Por qué Ruby mola">Por qué Ruby mola<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Provisto por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-9308241-3', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-9308241-3" async></script></body>
</html>
