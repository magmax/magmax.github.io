<!DOCTYPE html>
<html prefix="
og: https://ogp.me/ns#
article: https://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Cache-Control" content="max-age=43200">
<meta http-equiv="ETag" content="b'43516d322f35b42f7136bc9e4ca4c9c80cc1466c'">
<title>No comentes: ¡Asegura! | MagMax Blog</title>
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="/assets/css/code.css" rel="stylesheet" type="text/css">
<link href="/assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="/assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="/assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/magmax">
<link rel="canonical" href="http://magmax.org/blog/asegura/">
<link rel="icon" href="/favicon.png" sizes="128x128">
<link rel="icon" href="/favicon_330.png" sizes="330x330">
<link rel="icon" href="/favicon.ico" sizes="16x16">
<meta name="author" content="Miguel Ángel García">
<link rel="prev" href="/blog/atheist-no-seas-credulo/" title="Atheist, No seas crédulo ¡¡Prueba!!" type="text/html">
<link rel="next" href="/blog/enumerados-java/" title="Enumerados Java: no sólo enumerados" type="text/html">
<meta property="og:site_name" content="MagMax Blog">
<meta property="og:title" content="No comentes: ¡Asegura!">
<meta property="og:url" content="http://magmax.org/blog/asegura/">
<meta property="og:description" content="Hoy he descubierto mucho de ese gran desconocido que es assert.
Resulta que tenía a mi alcance una herramienta de depuración bastante fuerte y aún no he hecho uso de ella.
Con el fin de solucionar est">
<meta property="og:type" content="article">
<meta property="article:author" content="Miguel Ángel García">
<meta property="article:published_time" content="2011-08-14T00:00:00+00:00">
<meta property="article:updated" content="2011-08-14T00:00:00">
<meta property="article:tag" content="java testing">
<meta property="article:tag" content="python testing">
<meta property="article:tag" content="test">
<meta property="article:tag" content="testing">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@magmax_en">
<meta name="twitter:creator" content="@magmax">
<meta name="twitter:title" content="MagMax Blog">
<meta name="twitter:description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ...">
<meta name="twitter:url" content="http://magmax.org//blog/asegura/">
<meta name="twitter:image" content="http://magmax.org/favicon.png">
<link rel="alternate" hreflang="en" href="/en/blog/asegura/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://magmax.org/">

        <span id="blog-title">MagMax Blog</span>
      </a>
    </div>
<!-- /.navbar-header -->
    <div class="collapse navbar-collapse navbar-ex1-collapse">
      <ul class="nav navbar-nav">
<li>
<a href="/">Inicio</a>
                </li>
<li>
<a href="/archive.html">Archivo</a>
                </li>
<li>
<a href="/categories">Categorías</a>
                </li>
<li>
<a href="/projects">Proyectos</a>
                </li>
<li>
<a href="/news">Posts Externos</a>

        
      </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
<form class="navbar-form navbar-left" role="search" action="http://google.com/search" method="get">
<div class="form-group">
<input type="hidden" name="sitesearch" value="magmax.org"><input type="text" name="q" class="form-control" placeholder="Search / Buscar">
</div>
</form>
</li>

        <li style="margin-left:0">
          <a href="http://feeds.feedburner.com/magmax">
            <img src="/assets/images/rss.png" style="width:22px;height:22px"></a>
        </li>

        
      </ul>
</div>
<!-- /.navbar-collapse -->
  </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
  <div class="body-content">
    <div class="row">
      <div class="page-content col-md-9">
        
        <article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="https://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="/blog/asegura/" class="u-url">No comentes: ¡Asegura!</a></h1>
            <div class="metadata text-muted">
              <i class="glyphicon glyphicon-calendar"></i>
              <p class="dateline">
                <time class="published dt-published" datetime="2011-08-14T00:00:00+00:00" title="2011-08-14">2011-08-14</time>
                // <time class="updated dt-updated" datetime="2011-08-14T00:00:00" title="2011-08-14">2011-08-14</time></p>
              <p class="commentline">            <a href="/blog/asegura/#disqus_thread" data-disqus-identifier="cache/posts/asegura.html">Comments</a>

</p>
              <address class="vcard author"><a class="url fn" href="https://magmax.org">Miguel Ángel García</a></address>
            </div>
            <br><div class="metadata posttranslations translations">
              <h3 class="posttranslations-intro">También disponible en:</h3>
              <p><a href="/en/blog/asegura/" rel="alternate" hreflang="en"><img src="/images/en.png"> English</a></p>
            </div>
          </header><div class="e-content entry-content" itemprop="articleBody text">
            <div>
<p>Hoy he descubierto mucho de ese gran desconocido que es <em>assert</em>.</p>
<p>Resulta que tenía a mi alcance una herramienta de depuración bastante fuerte y aún no he hecho uso de ella.</p>
<p>Con el fin de solucionar este problema, escribo este artículo, aunque no escribiré nada que no se encuentre en la <a class="reference external" href="http://download.oracle.com/javase/6/docs/technotes/guides/language/assert.html">Documentación de Java sobre Assert</a>  o la <a class="reference external" href="http://docs.python.org/release/2.5.2/ref/assert.html">documentación Python</a> .</p>
<!-- TEASER_END -->
<div class="section" id="lo-mas-basico">
<h2>Lo más básico</h2>
<p>Lo primero es saber cómo vamos a usarlo. Suele haber dos maneras de utilizarlo: con un parámetro o con dos. El segundo parámetro indicará el texto a acompañar la excepción cuando el primero de los parámetros no se cumpla.</p>
<p>En python:</p>
<pre class="code python"><a name="rest_code_933d39f8dd404e99b014d28730371d48-1"></a><span class="k">assert</span> <span class="n">expression</span>
<a name="rest_code_933d39f8dd404e99b014d28730371d48-2"></a><span class="k">assert</span> <span class="n">expression1</span><span class="p">,</span> <span class="n">expression2</span>
</pre>
<p>y en java:</p>
<pre class="code java"><a name="rest_code_c1e99ccc6b4f4e89a1c6d9251daee751-1"></a><span class="k">assert</span> <span class="n">expression</span><span class="p">;</span>
<a name="rest_code_c1e99ccc6b4f4e89a1c6d9251daee751-2"></a><span class="k">assert</span> <span class="n">expression1</span> <span class="p">:</span> <span class="n">expression2</span><span class="p">;</span>
</pre>
<p>Es importante destacar que, si la <em>expresion1</em> no se cumple, la <em>expression2</em> no se evaluará. A menudo, esta segunda expresión debe generar una cadena.</p>
</div>
<div class="section" id="no-utilices-assert">
<h2>¡¡No utilices Assert!!</h2>
<p>De la misma manera que no utilizarías un martillo neumático para apretar un tornillo, no podemos utilizar <em>assert</em> en todos los casos.</p>
<p>Donde no debemos usarlo es en los siguientes supuestos:</p>
<ul class="simple">
<li>
<em>Métodos públicos</em>: Cuestión estética, ya que queda horrible recibir un "Assertion Error". Será mejor recibir un "Se ha producido un error", por lo que en métodos públicos es mejor utilizar una comparación y una excepción. Además, existe la posibilidad de <em>desactivar</em> las aseveraciones, por lo que corremos el riesgo de dejar de comprobar la entrada de un método público.</li>
<li>
<em>Para hacer trabajo útil</em> en un método, ya que las aseveraciones se pueden desactivar y, por tanto, dejaría de realizarse ese trabajo.</li>
</ul>
</div>
<div class="section" id="utiliza-assert">
<h2>¡¡Utiliza Assert!!</h2>
<p>A menudo nos sentimos tentados de escribir comentarios del tipo "Todo bien", "no debería llegar aquí", etc. Este tipo de comentario es un problema ya que, por un lado, pueden dejar de ser ciertos y por otro, nadie los está comprobando.</p>
<p>Además, se requieren demasiadas letras para dar la misma semántica (comparo el comentario con su equivalente con <em>assert</em>):</p>
<pre class="code python"><a name="rest_code_762c3f3a16a943718b3ceb6dc9202f2e-1"></a><span class="c1"># el valor de i debe ser mayor que 5</span>
<a name="rest_code_762c3f3a16a943718b3ceb6dc9202f2e-2"></a><span class="k">assert</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span>
</pre>
<pre class="code java"><a name="rest_code_018d8470fb1f432780c1b4526b928f60-1"></a><span class="c1">// el valor de i debe ser mayor que 5</span>
<a name="rest_code_018d8470fb1f432780c1b4526b928f60-2"></a><span class="k">assert</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">;</span>
</pre>
<p>Cuando tenemos un switch, en ocasiones dejamos el caso por defecto sin gestionar, ya que nunca se llegará allí. ¿O tal vez sí? ¿Qué ocurrirá el día que añadamos una nueva opción? Podemos asegurarnos de contemplarlas:</p>
<pre class="code java"><a name="rest_code_a1bf0baeaa434329987d583832da279d-1"></a><span class="k">switch</span> <span class="p">(</span><span class="n">var</span><span class="p">)</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-2"></a><span class="p">{</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-3"></a>    <span class="k">case</span> <span class="n">value1</span><span class="p">:</span> <span class="n">hacer_cosas1</span><span class="p">();</span> <span class="k">break</span><span class="p">;</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-4"></a>    <span class="k">case</span> <span class="n">value2</span><span class="p">:</span> <span class="n">hacer_cosas2</span><span class="p">();</span> <span class="k">break</span><span class="p">;</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-5"></a>    <span class="p">...</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-6"></a>    <span class="k">case</span> <span class="n">valueN</span><span class="p">:</span> <span class="n">hacer_cosasN</span><span class="p">();</span> <span class="k">break</span><span class="p">;</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-7"></a>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-8"></a><span class="nl">   default:</span> <span class="k">assert</span> <span class="n">False</span><span class="p">,</span> <span class="s">"Valor no contemplado"</span><span class="p">;</span>
<a name="rest_code_a1bf0baeaa434329987d583832da279d-9"></a><span class="p">}</span>
</pre>
</div>
<div class="section" id="precondiciones-y-postcondiciones">
<h2>Precondiciones y postcondiciones</h2>
<p>Uno de mis usos favoritos es el de comprobar entradas y salidas. Por ejemplo: tenemos la función que devuelve el factorial de un número, y que debe exigir que la entrada sea mayor que 1 (y que no sea negativa, claro). Asumiendo que no sea un método público:</p>
<pre class="code python"><a name="rest_code_70d4361f08fa401dbea62c29d8053418-1"></a><span class="k">def</span> <span class="nf">factorial</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a name="rest_code_70d4361f08fa401dbea62c29d8053418-2"></a>  <span class="k">assert</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Valor inválido:"</span> <span class="o">+</span> <span class="n">n</span><span class="p">;</span>
<a name="rest_code_70d4361f08fa401dbea62c29d8053418-3"></a>
<a name="rest_code_70d4361f08fa401dbea62c29d8053418-4"></a>  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
<a name="rest_code_70d4361f08fa401dbea62c29d8053418-5"></a>  <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre>
<p>También podemos asegurarnos de no haber dejado algo con un valor inválido:</p>
<pre class="code java"><a name="rest_code_000bb56ed9574c73b23b3090d9718150-1"></a><span class="kd">protected</span> <span class="n">List</span> <span class="nf">metodo</span> <span class="p">()</span> <span class="p">{</span>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-2"></a>  <span class="n">ArrayList</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-3"></a>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-4"></a>  <span class="c1">// Hacer muchas cosas con ifs, llamadas a métodos, etc.</span>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-5"></a>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-6"></a>  <span class="k">assert</span> <span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">,</span> <span class="s">"valor no inicializado"</span><span class="p">;</span>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-7"></a>  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<a name="rest_code_000bb56ed9574c73b23b3090d9718150-8"></a><span class="p">}</span>
</pre>
<p>En Java, es muy común tener en una clase funciones <em>synchronized</em> y no <em>synchronized</em> que se llaman entre ellas. Eso es un foco de <em>deathlocks</em> dificilísimos de detectar, ya que estamos esperando a que nosotros mismos soltemos el bloqueo. Es como buscar las gafas con las gafas puestas.</p>
<p>Este caso es realmente sencillo de detectar con un <em>assert</em>:</p>
<pre class="code java"><a name="rest_code_e265d37b84914bf39afe8660cc7bd100-1"></a><span class="kd">protected</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">metodo_sincronizado</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-2"></a>  <span class="n">metodo_no_sincronizado</span><span class="p">();</span>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-3"></a><span class="p">}</span>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-4"></a>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-5"></a><span class="kd">protected</span> <span class="kd">synchronized</span> <span class="kt">void</span> <span class="nf">metodo_no_sincronizado</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-6"></a>  <span class="k">assert</span> <span class="n">Thread</span><span class="p">.</span><span class="na">holdsLock</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-7"></a>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-8"></a>  <span class="c1">// hacer cosas</span>
<a name="rest_code_e265d37b84914bf39afe8660cc7bd100-9"></a><span class="p">}</span>
</pre>
</div>
<div class="section" id="desactivacion">
<h2>Desactivación</h2>
<p>Por último, indicar que estas aseveraciones (por favor, no uséis "aserciones") se pueden desactivar en un entorno de producción, por lo que no importa si hacéis cosas "caras". Cuando las desactivéis será como si nunca las hubierais escrito.</p>
<p>En python están <em>ACTIVADAS</em> por defecto. Se debe usar la opción <em>-O</em> para desactivarlas:</p>
<pre class="code bash"><a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-1"></a>$ cat assert.py
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-2"></a>assert False, <span class="s2">"Aseveraciones activadas"</span>
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-3"></a>$ python assert.py
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-4"></a>Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-5"></a>  File <span class="s2">"assert.py"</span>, line <span class="m">1</span>, in &lt;module&gt;
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-6"></a>    assert False, <span class="s2">"Aseveraciones activadas"</span>
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-7"></a>AssertionError: Aseveraciones activadas
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-8"></a>$ python -O assert.py
<a name="rest_code_d9b0ff0713ad494bae1d4abe321d20e4-9"></a>$
</pre>
<p>En Java estarán <em>DESACTIVADAS</em> por defecto, aunque se pueden activar por módulo, por método, etc. Aunque lo más útil es utilizar "<em>-ea</em>" para activarlas todas.</p>
<p>¡¡Empleadlo con cariño!!</p>
</div>
</div>
          </div>
          <br><div>
            <nav><span class="author">
                <span class="glyphicon glyphicon-user"></span> 
                <span>Publicado:Miguel Ángel García</span>
              </span>
               

              
              <span class="dateline">
                <span class="glyphicon glyphicon-calendar"></span> 
                <time class="published dt-published" datetime="2011-08-14T00:00:00+00:00" title="2011-08-14">2011-08-14</time></span>
               
              <span class="tags">
                <span class="glyphicon glyphicon-tags"></span> 
                <a class="label label-primary p-category" href="/categories/java-testing/" rel="tag">java testing</a>
                <a class="label label-primary p-category" href="/categories/python-testing/" rel="tag">python testing</a>
                <a class="label label-primary p-category" href="/categories/test/" rel="tag">test</a>
                <a class="label label-primary p-category" href="/categories/testing/" rel="tag">testing</a>
              </span>
                      <ul class="pager">
<li class="previous">
              <a href="/blog/atheist-no-seas-credulo/" rel="prev" title="Atheist, No seas crédulo ¡¡Prueba!!">
                <span class="glyphicon glyphicon-arrow-left"></span>
                Publicación anterior
              </a>
            </li>
            <li class="next">
              <a href="/blog/enumerados-java/" rel="next" title="Enumerados Java: no sólo enumerados">
                Siguiente publicación
                <span class="glyphicon glyphicon-arrow-right"></span>
              </a>
            </li>
        </ul></nav>
</div>
          <section class="comments"><h2>Comentarios</h2>
                            <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="magmax",
            disqus_url="http://magmax.org/blog/asegura/",
        disqus_title="No comentes: \u00a1Asegura!",
        disqus_identifier="cache/posts/asegura.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


          </section></article><script>var disqus_shortname="magmax";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
      <aside class="sidebar col-md-3"><div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">Last comments</h3>
  </div>
  <div class="panel-body">
    <div id="disqus_last_comments" class="dsq-widget">
      <script type="text/javascript" src="https://magmax.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=32&amp;excerpt_length=150">
      </script>
</div>
  </div>
</section>
</div>
          <div>
<section class="panel panel-default"><div class="panel-heading">
    <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="panel-body">
    <ul id="gh_repos" class="list-unstyled">
<li class="loading">Status updating…</li>
    </ul>
</div>
  <div class="panel-footer">
    <a href="https://github.com/magmax">@magmax</a> on GitHub
  </div>
</section>
</div>
      </aside>
</div>

    <footer>
      Contents © 2009-2020 <a href="mailto:">Miguel Ángel García</a> 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/es/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;width:80px;height:15px;vertical-align:middle" src="https://i.creativecommons.org/l/by-nc-sa/2.5/es/80x15.png"></a>; Using <a href="/stories/credits/">a lot of free software</a>
      
    </footer>
</div>
</div>




<script data-main="/assets/js/main" src="/assets/js/libs/require/require.min.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9308241-3', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
