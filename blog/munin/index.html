<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Munin - El blog de MagMax</title><meta name="Description" content="Vista general de la herramienta &#39;munin&#39;, utilizada para monitorizar máquinas
"><meta property="og:title" content="Munin" />
<meta property="og:description" content="Vista general de la herramienta &#39;munin&#39;, utilizada para monitorizar máquinas
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/munin/" />
<meta property="og:image" content="https://magmax.org/icons/favicon.png"/>
<meta property="article:published_time" content="2013-08-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="Munin"/>
<meta name="twitter:description" content="Vista general de la herramienta &#39;munin&#39;, utilizada para monitorizar máquinas
"/>
<meta name="application-name" content="El blog de MagMax">
<meta name="apple-mobile-web-app-title" content="El blog de MagMax"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/munin/" /><link rel="prev" href="https://magmax.org/blog/usando-bootstrap/" /><link rel="next" href="https://magmax.org/blog/munin-plugins/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Munin",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/munin\/"
        },"genre": "posts","keywords": "munin, sysadmin, monitor","wordcount":  718 ,
        "url": "https:\/\/magmax.org\/blog\/munin\/","datePublished": "2013-08-26T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Miguel Ángel"},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": "Vista general de la herramienta 'munin', utilizada para monitorizar máquinas\n"
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/munin/" selected>Español</option></select>
                    </a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/munin/" selected>Español</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Munin</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Miguel Ángel</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="26 Aug 2013">26 Aug 2013</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;718 palabras&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;4 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#monitorización">Monitorización</a></li>
    <li><a href="#alternativas">Alternativas</a></li>
    <li><a href="#funcionamiento">Funcionamiento</a></li>
    <li><a href="#configuración">Configuración</a>
      <ul>
        <li><a href="#configuración-de-java">Configuración de Java</a></li>
      </ul>
    </li>
    <li><a href="#algunos-problemas">Algunos problemas</a>
      <ul>
        <li><a href="#los-gráficos-me-desaparecen">Los gráficos me desaparecen</a></li>
        <li><a href="#las-alertas-me-llegan-demasiado-tarde">Las alertas me llegan demasiado tarde</a></li>
      </ul>
    </li>
    <li><a href="#más-documentación">Más documentación</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Cuando manejamos un servidor, tarde o temprano echaremos de menos una herramienta de monitorización del mismo. Hay muchas y de muchos estilos, pero en esta ocasión he elegido <a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a>.</p>
<p>Primero haré una pequeña revisión general a las herramientas de monitorización y luego me centraré en cómo utilizar <a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a>, tarea que me ha costado llegar a entender.</p>
<p>Este artículo no abordará la creación de plugins propios, sino sólo la gestión de máquinas. Eso lo dejo para otro artículo.</p>
<!-- raw HTML omitted -->
<figure>
    <img src="/images/munin.png"
         alt="Munin"/> 
</figure>

<h2 id="monitorización">Monitorización</h2>
<p>Si un servidor está funcionando contínuamente, todo va bien. ¿Por qué molestarse en monitorizar nada? Pero si, de pronto, el servidor se cae&hellip; ¿Qué es lo que ha pasado? ¿Qué ha cambiado?</p>
<p>Es justamente cuando las cosas van mal que echamos en falta tener datos de lo que es una situación &ldquo;normal&rdquo;. De esta manera, se puede intentar ver qué ha cambiado: hemos ido consumiendo más y más memoria, el servidor se reinició sin avisarnos, se murió un servicio, comenzamos a <em>swappear</em>,&hellip;</p>
<p>Además, hay muchas situaciones que se pueden prever con alertas, de manera que sepamos con antelación que nos estamos quedando sin disco o que la máquina se está quedando sin RAM.</p>
<h2 id="alternativas">Alternativas</h2>
<p>Hay otras herramientas semejantes o mejores:</p>
<ul>
<li><a href="https://pandorafms.com/" title="Pandora FMS page" target="_blank" rel="noopener noreffer">Pandora</a>: la gestión de alertas es muy detallada, pero las gráficas son bastante pobres. Además, la gestión hay que realizarla mediante una interfaz web que puede ser más compleja de automatizar y de crear copias de seguridad.</li>
<li><a href="https://www.zabbix.com/" title="Zabbix page" target="_blank" rel="noopener noreffer">Zabbix</a>: Una herramienta de monitorización mucho más completa que <a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a>, pero muy compleja de utilizar.</li>
</ul>
<p><a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a> es una herramienta bastante mediocre, pero es sencilla de utilizar y rápida de instalar. Puede solucionarnos la papeleta llegado el momento.</p>
<h2 id="funcionamiento">Funcionamiento</h2>
<p>Internamente utiliza <a href="https://es.wikipedia.org/wiki/RRDtool" title="RRD Tool on Wikipedia" target="_blank" rel="noopener noreffer">rdd</a>, que es una base de datos Round Robin. Las ventajas son que siempre ocupa lo mismo y que es rápida; la desventaja, que requiere agrupación de datos y perdemos granularidad.</p>
<p>La visualización se puede realizar mediante una interfaz web que realiza un pre-renderizado de los gráficos para así mostrarlos más rápido (cuando están listos). Estos gráficos se vuelven a generar de nuevo cuando están obsoletos.</p>
<p>La arquitectura es un servidor que recibe los datos y los almacena, y nodos que le envían la información. Esta información se recoge mediante <em>plugins</em>, que son programas de línea de órdenes que escriben en un formato determinado por la salida estándar (por lo que son muy sencillos de implementar). Realmente, el servidor funciona con un &ldquo;cron&rdquo; y solicita los datos a los clientes, que están ejecutándose de forma contínua, agrupando los datos.</p>
<h2 id="configuración">Configuración</h2>
<p>La documentación es bastante mala, ya que es difícil encontrar información sobre <em>cómo configurar los plugins de <a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a> de manera automática</em>. Debería ser lo más fácil de encontrar, pero no es así.</p>
<p>Para configurar los plugins basta con ejecutar lo siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ munin-node-configure --suggest --remove-also --shell <span class="p">|</span> bash
</code></pre></td></tr></table>
</div>
</div><p>¿Que es complicado? Pensad que <a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a> está hecho en Perl y entenderéis muchas cosas.</p>
<p>Si queremos ver qué plugins hay disponibles y por qué no se están activando, podemos ejecutar lo siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ munin-node-configure --suggest
</code></pre></td></tr></table>
</div>
</div><p>Una vez configurado, será necesario reiniciar el servicio <em>munin-node</em>.</p>
<p>Hay muchas cosas configurables: alertas, gráficos, etc. Pero eso no lo veremos aquí.</p>
<h3 id="configuración-de-java">Configuración de Java</h3>
<p>Algo con lo que me he tenido que pelear a brazo partido es la configuración de los módulos de Java (*jmx_*). No es trivial, pero es sencillo. El problema es que hay que activar esta monitorización en los propios procesos Java. Para ello, hay que añadir los siguientes parámetros en la línea de ejecución de Java, pero tened cuidado porque en mi ejemplo estoy usando seguridad mínima con el fin de que os funcione fácilmente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">-Dcom.sun.management.jmxremote.port<span class="o">=</span>&lt;PORT&gt;
-Dcom.sun.management.jmxremote.ssl<span class="o">=</span><span class="nb">false</span>
-Dcom.sun.management.jmxremote.authenticate<span class="o">=</span><span class="nb">false</span>
</code></pre></td></tr></table>
</div>
</div><p>Después de esto, basta con reconfigurar munin automáticamente de nuevo como se explica en el apartado de Configuración.</p>
<h2 id="algunos-problemas">Algunos problemas</h2>
<p>Hay algunos problemas con los que ya me he peleado y no me gustaría tener que volver a hacerlo, así que me los voy a apuntar:</p>
<h3 id="los-gráficos-me-desaparecen">Los gráficos me desaparecen</h3>
<p>Seguramente estés usando el <em>modo cgi</em> de generación de gráficos. Basta con ir a la máquina donde está montado y reiniciar los servicios <em>spawn-munin-fast-cgi-graph</em> y <em>spawn-munin-fast-cgi-html</em></p>
<h3 id="las-alertas-me-llegan-demasiado-tarde">Las alertas me llegan demasiado tarde</h3>
<p>Ya os dije que <a href="https://munin-monitoring.org/" title="Munin page" target="_blank" rel="noopener noreffer">Munin</a> no era muy bueno en esto. No he sido capaz de arreglarlo aún.</p>
<h2 id="más-documentación">Más documentación</h2>
<p>Para más consultas, podéis dirigiros a la <a href="https://munin-monitoring.org/wiki/Documentation" title="Munin documentation" target="_blank" rel="noopener noreffer">documentación de Munin</a></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/munin/" data-title="Munin" data-hashtags="munin,sysadmin,monitor"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/munin/" data-hashtag="munin"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/munin/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/munin/" data-title="Munin" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/munin/" data-title="Munin" data-caption="Vista general de la herramienta &#39;munin&#39;, utilizada para monitorizar máquinas
" data-tags="munin,sysadmin,monitor"><i class="fab fa-tumblr fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/munin/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/munin/" data-title="Munin" data-description="Vista general de la herramienta &#39;munin&#39;, utilizada para monitorizar máquinas
"><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Compartir en Digg" data-sharer="digg" data-url="https://magmax.org/blog/munin/"><i class="fab fa-digg fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/munin/" data-title="Munin" data-description="Vista general de la herramienta &#39;munin&#39;, utilizada para monitorizar máquinas
"><i class="fab fa-blogger fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/munin/">munin</a>,&nbsp;<a href="/tags/sysadmin/">sysadmin</a>,&nbsp;<a href="/tags/monitor/">monitor</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/usando-bootstrap/" class="prev" rel="prev" title="Bootstrap en 5 minutos"><i class="fas fa-angle-left fa-fw"></i>Bootstrap en 5 minutos</a>
            <a href="/blog/munin-plugins/" class="next" rel="next" title="Munin: creando plugins">Munin: creando plugins<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Provisto por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
