<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>El compilador de Python desde dentro - El blog de MagMax</title><meta name="Description" content="El blog de un Ingeniero Informático: tutoriales, manuales, opiniones, comparativas, ..."><meta property="og:title" content="El compilador de Python desde dentro" />
<meta property="og:description" content="Los viernes hay formación en la oficina. El viernes pasado le tocó dar una charla a Goran, y nos estuvo contando cómo funciona PHP por dentro.
No he podido quitarme la charla de la cabeza en todo el fin de semana, y he investigado cómo funciona Python por dentro. Goran se quejaba de que hay muy poca información sobre PHP, y tampoco hay tanta sobre Python. Pero encontré este artículo, me gustó y he tenido que traducirlo. Lo mejor es que todos los lenguajes que están de moda (PHP, Python, Ruby, Java, &hellip;) se basan en los mismos principios, aunque algunos de ellos tienen mayor acierto que otros, y la implementación, que es completamente diferente.
El artículo original, &lsquo;Python Compiler Internals&rsquo;  lo escribió Thomas Lee  (@tglee ) en el 2008, pero es perfectamente válido hoy en día. Me gustó por lo sencillo y por lo acertado del ejemplo.
Espero que también os guste:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/python-compiler-internals/" /><meta property="og:image" content="https://magmax.org/icons/favicon.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2012-05-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="My cool site" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="El compilador de Python desde dentro"/>
<meta name="twitter:description" content="Los viernes hay formación en la oficina. El viernes pasado le tocó dar una charla a Goran, y nos estuvo contando cómo funciona PHP por dentro.
No he podido quitarme la charla de la cabeza en todo el fin de semana, y he investigado cómo funciona Python por dentro. Goran se quejaba de que hay muy poca información sobre PHP, y tampoco hay tanta sobre Python. Pero encontré este artículo, me gustó y he tenido que traducirlo. Lo mejor es que todos los lenguajes que están de moda (PHP, Python, Ruby, Java, &hellip;) se basan en los mismos principios, aunque algunos de ellos tienen mayor acierto que otros, y la implementación, que es completamente diferente.
El artículo original, &lsquo;Python Compiler Internals&rsquo;  lo escribió Thomas Lee  (@tglee ) en el 2008, pero es perfectamente válido hoy en día. Me gustó por lo sencillo y por lo acertado del ejemplo.
Espero que también os guste:"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/python-compiler-internals/" /><link rel="prev" href="https://magmax.org/blog/vagrant-puppet/" /><link rel="next" href="https://magmax.org/blog/como-funcionan-las-cosas/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "El compilador de Python desde dentro",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/python-compiler-internals\/"
        },"genre": "posts","keywords": "compilers, python","wordcount":  1970 ,
        "url": "https:\/\/magmax.org\/blog\/python-compiler-internals\/","datePublished": "2012-05-20T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/posts"> Posts </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/python-compiler-internals/" selected>Español</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/posts" title="">Posts</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/python-compiler-internals/" selected>Español</option></select>
                </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">El compilador de Python desde dentro</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Miguel Ángel</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="20 May 2012">20 May 2012</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1970 palabras&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;10 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#resumen">Resumen</a></li>
    <li><a href="#1-vista-general">1. Vista general</a></li>
    <li><a href="#2-análisis-léxico">2. Análisis léxico</a></li>
    <li><a href="#3-análisis-sintáctico">3. Análisis sintáctico</a></li>
    <li><a href="#4-generación-de-código">4. Generación de código</a></li>
    <li><a href="#5-ejecución-de-código">5. Ejecución de código</a></li>
    <li><a href="#6-conclusión">6. Conclusión</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Los viernes hay formación en la oficina. El viernes pasado le tocó dar una charla a Goran, y nos estuvo contando cómo funciona PHP por dentro.</p>
<p>No he podido quitarme la charla de la cabeza en todo el fin de semana, y he investigado cómo funciona Python por dentro. Goran se quejaba de que hay muy poca información sobre PHP, y tampoco hay tanta sobre Python. Pero encontré este artículo, me gustó y he tenido que traducirlo. Lo mejor es que todos los lenguajes que están de moda (PHP, Python, Ruby, Java, &hellip;) se basan en los mismos principios, aunque algunos de ellos tienen mayor acierto que otros, y la implementación, que es completamente diferente.</p>
<p>El artículo original, <a href="https://tomlee.co/wp-content/uploads/2008/12/python-language-internals.pdf" target="_blank" rel="noopener noreffer ">&lsquo;Python Compiler Internals&rsquo;</a>  lo escribió <a href="https://tomlee.co" target="_blank" rel="noopener noreffer ">Thomas Lee</a>  (<a href="https://twitter.com/#!/tglee" target="_blank" rel="noopener noreffer ">@tglee</a> ) en el 2008, pero es perfectamente válido hoy en día. Me gustó por lo sencillo y por lo acertado del ejemplo.</p>
<p>Espero que también os guste:</p>
<figure><img src="/images/python.png"
         alt="Python"/>
</figure>

<hr>
<h2 id="resumen">Resumen</h2>
<p>En este artículo se introduce una nueva instrucción del lenguaje para demostrar cómo se puede comenzar a modificar el compilador del lenguaje Python. El lenguaje Python en sí mismo es un lenguaje potente, dinámicamente tipado que corre en gran variedad de sistemas operativos y plataformas. Los entresijos del propio compilador siguen un patrón común en las implementaciones de muchos lenguajes, con fases de análisis léxico, sintáctico y generación de código. Esto hace del código fuente de Python un buen lugar para aprender cómo deberían implementarse los lenguajes en su sentido más general. Tras leer el artículo, se espera que el lector vea que contribuir al núcleo del lenguaje Python no es tan complejo como puede parecer.</p>
<h2 id="1-vista-general">1. Vista general</h2>
<p>Aquéllos que ven a Python como un lenguaje de <em>scripting</em> pueden sorprenderse al descubrir que el núcleo del intérprete Python realmente tiene la estructura de un compilador clásico. Cuando se invoca la orden &ldquo;python&rdquo;, el código fuente se escanea buscando <em>tokens</em>, estos <em>tokens</em> se procesan en una representación arbórea de la estructura lógica del programa, que finalmente se transforma en <em>bytecode</em>. Finalmente, este <em>bytecode</em> se procesa por la máquina virtual.</p>
<p>Con el fin de demostrar cómo encajan entre sí los distintos componentes del compilador de Python, usaremos como base el código de Python 2.6 caminando hacia la agregación de una nueva estructura del lenguaje: la instrucción <em>&ldquo;unless&rdquo;</em>, mostrada en el listado siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">passwd</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">unless</span> <span class="n">passwd</span> <span class="o">==</span> <span class="s1">&#39;tehsecret&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="nb">print</span> <span class="s1">&#39;Password do not match. Exiting!&#39;</span>
</span></span><span class="line"><span class="cl">       <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Todo el código de este artículo se ha escrito y probado con Python 2.6 beta 3, cuyo repositorio Subversion puede encontrarse aquí: <a href="https://svn.python.org/projects/python/tags/r26b3/" target="_blank" rel="noopener noreffer ">https://svn.python.org/projects/python/tags/r26b3/</a> . La única cosa que debería cambiar en la versión 2.6 final son los números de línea referenciados en los listados de fuentes aquí presentes.</p>
<h2 id="2-análisis-léxico">2. Análisis léxico</h2>
<p>En lugar de tratar de procesar un flujo de texto directamente, a menudo es más sencillo &ndash; y rápido &ndash; desglosar la entrada de texto en una serie de &ldquo;tokens&rdquo;, que deberían incluir palabras reservadas, literales, operadores y/o identificadores. Estos <em>tokens</em> pueden inspeccionarse por el procesador de forma más eficiente que un flujo de texto plano. El proceso de transformar la entra de texto en <em>tokens</em> se conoce como &ldquo;análisis léxico&rdquo;, &ldquo;tokenizado&rdquo; (<code>tokenizing</code>) o, simplemente, &ldquo;escaneo&rdquo; (<code>scanning</code>).</p>
<p>El punto de entrada del analizador léxico es la función <code>PyTokenizer_Get</code> en <a href="https://svn.python.org/projects/python/tags/r26b3/Parser/tokenizer.c" target="_blank" rel="noopener noreffer ">Parser/tokenizer.c</a> . Esta función se llama repetidamente desde la función principal de procesado, <code>parsetok</code> en <a href="https://svn.python.org/projects/python/tags/r26b3/Parser/parsetok.c" target="_blank" rel="noopener noreffer ">Parser/parsetok.c</a> , que a su vez se utiliza por por alguna de las distintas funciones de proceso de más alto nivel.</p>
<p>Para implementar nuestra instrucción &ldquo;unless&rdquo;, no es necesario realizar nada explícito en el código del <code>tokenizer</code> &ndash; sólo es necesario modificar la descripción de la gramática, como se verá en la siguiente sección.</p>
<h2 id="3-análisis-sintáctico">3. Análisis sintáctico</h2>
<p>Para que el compilador obtenga algún significado del programa fuente, el flujo de tokens emitido por el analizador léxico debe estar organizado en algún tipo de estructura. Éste es el trabajo del analizador sintáctico de Python, que toma como entrada un flujo de tokens y &ndash; basado en las reglas declaradas en la gramática de Python &ndash; produce un Árbol Sintáctico Abstracto (AST, <em>&ldquo;Abstract Syntax Tree&rdquo;</em>).</p>
<p>Python utiliza un generador de análisis sintáctico a medida que genera automáticamente su analizador sintáctico a partir de una descripción gramatical. La salida del análisis sintáctico es el árbol sintáctico, que puede verse como una representación de bajo nivel del programa analizado en la estructura definida por la descripción gramatical.</p>
<p>En Python 2.5, se añade un paso adicional a la fase de análisis sintáctico: la construcción de un Árbol Sintáctico Abstracto (AST) del árbol analizado. El AST, como el árbol analizado, es una representación en memoria del programa que se está procesando, aunque de una forma de más alto nivel y por tanto más sencilla de manipular.</p>
<p>Ahora, para añadir nuestra nueva instrucción <code>unless</code> al lenguaje Python, primero tenemos que modificar el archivo de gramática (<a href="https://svn.python.org/projects/python/tags/r26b3/Grammar/Grammar" target="_blank" rel="noopener noreffer ">Grammar/Grammar</a>)  para describir la sintaxis de esta característica, como en el listado siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/* Grammar/Grammar:78 */</span>
</span></span><span class="line"><span class="cl"><span class="nl">if_stmt</span><span class="p">:</span> <span class="err">&#39;</span><span class="k">if</span><span class="err">&#39;</span> <span class="n">test</span> <span class="sc">&#39;:&#39;</span> <span class="n">suite</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">elif</span><span class="err">&#39;</span> <span class="n">test</span> <span class="sc">&#39;:&#39;</span> <span class="n">suite</span><span class="p">)</span><span class="o">*</span> <span class="p">[</span><span class="err">&#39;</span><span class="k">else</span><span class="sc">&#39; &#39;</span><span class="o">:</span><span class="err">&#39;</span> <span class="n">suite</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">while_stmt</span><span class="p">:</span> <span class="err">&#39;</span><span class="k">while</span><span class="err">&#39;</span> <span class="n">test</span> <span class="sc">&#39;:&#39;</span> <span class="n">suite</span> <span class="p">[</span><span class="err">&#39;</span><span class="k">else</span><span class="sc">&#39; &#39;</span><span class="o">:</span><span class="err">&#39;</span> <span class="n">suite</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">unless_stmt</span><span class="p">:</span> <span class="err">&#39;</span><span class="n">unless</span><span class="err">&#39;</span> <span class="n">test</span> <span class="sc">&#39;:&#39;</span> <span class="n">suite</span>
</span></span><span class="line"><span class="cl"><span class="nl">for_stmt</span><span class="p">:</span> <span class="err">&#39;</span><span class="k">for</span><span class="err">&#39;</span> <span class="n">exprlist</span> <span class="err">&#39;</span><span class="n">in</span><span class="err">&#39;</span> <span class="n">testlist</span> <span class="sc">&#39;:&#39;</span> <span class="n">suite</span> <span class="p">[</span><span class="err">&#39;</span><span class="k">else</span><span class="sc">&#39; &#39;</span><span class="o">:</span><span class="err">&#39;</span> <span class="n">suite</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Dado que nuesta instrucción <code>unless</code> es realmente una instrucción &ldquo;if&rdquo; con la lógica invertida, para implementarlo <em>podríamos</em> utilizar los nodos AST del &ldquo;if&rdquo; y el &ldquo;Not&rdquo; existentes. De hecho, así es como se introdujo la sintaxis el try&hellip;except&hellip;finally en Python 2.5. De todas formas, para los propósitos de este artículo se modificará la estructura AST para poder demostrar cómo generar <em>bytecode</em> para nuestra nueva construcción. Con tal fin, se modifica <a href="https://svn.python.org/projects/python/tags/r26b3/Parser/Python.asdl" target="_blank" rel="noopener noreffer ">Parser/Python.asdl</a>  &ndash; que contiene la definición del AST &ndash; como en el listado siguiente:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/* Parser/Python.asdl:25 */</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="n">For</span><span class="p">(</span><span class="n">expr</span> <span class="n">target</span><span class="p">,</span> <span class="n">expr</span> <span class="n">iter</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">body</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">orelse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="n">While</span><span class="p">(</span><span class="n">expr</span> <span class="n">test</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">body</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">orelse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="n">Unless</span><span class="p">(</span><span class="n">expr</span> <span class="n">test</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="n">If</span><span class="p">(</span><span class="n">expr</span> <span class="n">test</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">body</span><span class="p">,</span> <span class="n">stmt</span><span class="o">*</span> <span class="n">orelse</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Finalmente, necesitamos añadir algo de código para manejar la transformación de la gramática al AST en <a href="https://svn.python.org/projects/python/tags/r26b3/Python/ast.c" target="_blank" rel="noopener noreffer ">Python/ast.c</a> . Aquí añadimos <code>ast_for_unless_stmt</code>, como se muestra a continuación:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/* Python/ast.c:2805 */</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="n">stmt_ty</span>
</span></span><span class="line"><span class="cl"><span class="nf">ast_for_unless_stmt</span><span class="p">(</span><span class="k">struct</span> <span class="nc">compiling</span><span class="o">*</span> <span class="n">c</span><span class="p">,</span> <span class="k">const</span> <span class="n">node</span> <span class="o">*</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">expr_ty</span> <span class="n">test_expr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">asdl_seq</span> <span class="o">*</span><span class="n">suite_seq</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* unless_stmt: &#39;unless&#39; test &#39;:&#39; suite */</span>
</span></span><span class="line"><span class="cl">    <span class="n">REQ</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">unless_stmt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_expr</span> <span class="o">=</span> <span class="n">ast_for_expr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">CHILD</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">test_expr</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">suite_seq</span> <span class="o">=</span> <span class="n">ast_for_suite</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">CHILD</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">suite_seq</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Unless</span><span class="p">(</span><span class="n">test_expr</span><span class="p">,</span> <span class="n">suite_seq</span><span class="p">,</span> <span class="n">LINENO</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">-&gt;</span><span class="n">n_col_offset</span><span class="p">,</span> <span class="n">c</span><span class="o">-&gt;</span><span class="n">c_arena</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ... &lt;snip&gt; ... */</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* Python/ast.c:3125 */</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">while_stmt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ast_for_while_stmt</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ch</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">unless_stmt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ast_for_unless_stmt</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ch</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>El código de transformación del árbol sintáctico al AST sigue un popular patrón Visitor. En la línea 3123, se añade un <em>hook</em> para llamar al código de transformación apropiado si se encuentra un nodo <code>unless_stmt</code> en el árbol sintáctico. Una vez dentro de la función de transformación, se construye un nodo Unless analizando recursivamente la condición y el cuerpo.</p>
<p>Note que puede necesitar regenerar explícitamente algunos ficheros tras realizar estos cambios:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ rm -f Python/graminit.c <span class="o">&amp;&amp;</span> make Python/graminit.c
</span></span><span class="line"><span class="cl">$ rm -f Python/Python-ast.c <span class="o">&amp;&amp;</span> make Python/Python-ast.c
</span></span></code></pre></td></tr></table>
</div>
</div><p>En este punto, el compilador podrá escanear y analizar nuestra nueva instrucción &ldquo;unless&rdquo;. Lo único que falta es añadir código para generar el <em>bytecode</em> para nuestro nuevo nodo AST.</p>
<h2 id="4-generación-de-código">4. Generación de código</h2>
<p>La siguiente fase de compilación &ndash; generación de código &ndash; toma el AST construído en la fase anterior y produce un PyCodeObject como salida. Un PyCodeObject es una unidad independiente de código ejecutable, que contiene toda la información y código para la ejecución independiente por parte del intérprete de <em>bytecode</em> de Python.</p>
<p>Antes de ver más código fuente, es importante comprender que el intérprete de <em>bytecode</em> de Python es una máquina virtual basada en pila. Esto significa que el proceso de ejecutar <em>bytecode</em> manipula una pila de datos, con instrucciones que añaden, eliminan y operan sobre el par de elementos de la cima de la pila. Con esto en mente, veamos cómo generar <em>bytecode</em> desde nuestro nuevo nodo AST Unless en el listado siguiente (veremos lo que hace realmente el <em>bytecode</em> en la sección siguiente):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cm">/* Python/compile.c:1623 */</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl"><span class="nf">compiler_unless</span><span class="p">(</span><span class="k">struct</span> <span class="nc">compiler</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">stmt_ty</span> <span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">basicblock</span> <span class="o">*</span><span class="n">end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">basicblock</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">assert</span><span class="p">(</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">kind</span> <span class="o">==</span> <span class="n">Unless_kind</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="n">compiler_new_block</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">end</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">next</span> <span class="o">=</span> <span class="n">compiler_new_block</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">next</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">VISIT</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">s</span><span class="o">-&gt;</span><span class="n">v</span><span class="p">.</span><span class="n">Unless</span><span class="p">.</span><span class="n">test</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ADDOP_JREL</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">JUMP_IF_TRUE</span><span class="p">,</span> <span class="n">next</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ADDOP</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">POP_TOP</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">VISIT_SEQ</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">stmt</span><span class="p">,</span> <span class="n">s</span><span class="o">-&gt;</span><span class="n">v</span><span class="p">.</span><span class="n">Unless</span><span class="p">.</span><span class="n">body</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ADDOP_JREL</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">JUMP_FORWARD</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">compiler_use_next_block</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">next</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">ADDOP</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">POP_TOP</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">compiler_use_next_block</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* ... &lt;snip&gt; ... */</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* Python/compile.c:2167 */</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="nl">If_kind</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">compiler_if</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="nl">Unless_kind</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">compiler_unless</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>En este punto, nuestra implementación de la instrucción &ldquo;Unless&rdquo; está terminada. Recompile Python y pruébelo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./configure <span class="o">&amp;&amp;</span> make clean <span class="o">&amp;&amp;</span> make
</span></span><span class="line"><span class="cl">$ ./python <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; dv = False
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; unless v:
</span></span></span><span class="line"><span class="cl"><span class="s">&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">print &#39;test&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">&gt; EOF</span>
</span></span><span class="line"><span class="cl"><span class="nb">test</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Vea <a href="https://svn.python.org/projects/python/tags/r26b3/Python/compile.c" target="_blank" rel="noopener noreffer ">Python/compile.c</a>  para más detalles sobre el generador de <em>bytecode</em> de Python.</p>
<h2 id="5-ejecución-de-código">5. Ejecución de código</h2>
<p>La ejecución del <em>bytecode</em> de Python se maneja por el intérprete de <em>bytecode</em>. Como se mencionó en la sección anterior, el intérprete es una máquina virtual basada en pila que ejecuta las instrucciones <em>bytecode</em> de Python que actúan sobre una única pila de datos. No se requiere realizar ningún cambio adicional al propio intérprete de <em>bytecode</em> para que nuestra instrucción &ldquo;Unless&rdquo; funcione, pero veamos con más detenimiento cómo interpreta el <em>bytecode</em> que generamos en la sección anterior.</p>
<p>Primero se ejecuta la expresión de la condición, y se añade el resultado de la misma a la pila. A continuación, el <em>opcode</em> <code>JUMP_IF_TRUE</code> inspeccionará el valor en la cima de la pila y determinará si contiene un valor que representa la verdad.  Si es así, se salta todo el cuerpo y continúa la ejecución a partir del final de la instrucción &ldquo;unless&rdquo;. Si la expresión se evalúa como un valor <em>falso</em>, el compilador ejecutará el cuerpo de la instrucción <code>unless</code>.</p>
<p>Se aprecia que la primera instrucción a ejecutar en cualquiera de las ramas es desapilar el elemento de encima de la pila de datos (POP_TOP). Es así porque la expresión JUMP_IF_TRUE deja la expresión comprobada en la pila. En nuestro caso ya no se necesita el valor de la expresión de comprobación, por lo que simplemente se descarta con la ejecución de la instrucción POP_TOP.</p>
<p>Si está interesado en los detalles de lo que hacen los <em>bytecodes</em> individuales, puede encontrar información sobre todos los <em>bytecodes</em> en <a href="https://docs.python.org/lib/bytecodes.html" target="_blank" rel="noopener noreffer ">https://docs.python.org/lib/bytecodes.html</a> . También puede ver <code>PyEval_CodeEvalEx</code> y <code>PyEval_EvalFrame_ex</code>  en <a href="https://svn.python.org/projects/python/tags/r26b3/Python/ceval.c" target="_blank" rel="noopener noreffer ">Python/ceval.c</a>  si está interesado en investigar con mayor detalle el intérprete de <em>bytecode</em>.</p>
<h2 id="6-conclusión">6. Conclusión</h2>
<p>Debería quedar claro que no es necesario ser un científico de la Nasa para contribuir en el núcleo del lenguaje Python. Si le interesan realmente los entresijos del trabajo de un intérprete del mundo real, Python es un buen lugar para comenzar. Si no está seguro de por dónde debe continuar, aquí tiene un par de ideas tanto alcanzables como educativas para el nivel iniciado del <em>hacker</em> de Python:</p>
<ol>
<li>Reescriba la instrucción &ldquo;unless&rdquo; usando sólo nodos AST ya existentes.</li>
<li>Añada un nuevo operador al lenguaje modificando el <code>tokenizer</code>.</li>
<li>Investigue cómo funcionan por dentro las funciones embebidas en el lenguaje.</li>
<li>Investigue el uso de la tabla de símbolos (symtable).</li>
</ol>
<p>Hay mucho que aprender jugando con el código, y aún más realizando contribuciones activas al proyecto mediante el arreglo de errores, contribuyendo a la documentación o respondiendo las preguntas de novatos en la lista de correo de usuarios. Anímese &ndash; y puede que se sorprenda usted mismo.</p>
<hr>
<p>Artículo original: <a href="https://tomlee.co/wp-content/uploads/2008/12/python-language-internals.pdf" target="_blank" rel="noopener noreffer ">Python Compiler Internals</a>
Autor original: <a href="https://tomlee.co" target="_blank" rel="noopener noreffer ">Thomas Lee</a> / (<a href="https://twitter.com/#!/tglee" target="_blank" rel="noopener noreffer ">@tglee</a> )
Traducción: <a href="https://magmax.org" target="_blank" rel="noopener noreffer ">Miguel Ángel García</a>  (<a href="https://twitter.com/#!/magmax_en" target="_blank" rel="noopener noreffer ">@magmax_en</a> )</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/python-compiler-internals/" data-title="El compilador de Python desde dentro" data-via="magmax_en" data-hashtags="compilers,python"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/python-compiler-internals/" data-hashtag="compilers"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/python-compiler-internals/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/python-compiler-internals/" data-title="El compilador de Python desde dentro" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/python-compiler-internals/" data-title="El compilador de Python desde dentro" data-tags="compilers,python"><i class="fab fa-tumblr fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/python-compiler-internals/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/python-compiler-internals/" data-title="El compilador de Python desde dentro" data-description=""><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/instapaper.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en 微博" data-sharer="weibo" data-url="https://magmax.org/blog/python-compiler-internals/" data-title="El compilador de Python desde dentro"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/python-compiler-internals/" data-title="El compilador de Python desde dentro" data-description=""><i class="fab fa-blogger fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/compilers/">compilers</a>,&nbsp;<a href="/tags/python/">python</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/vagrant-puppet/" class="prev" rel="prev" title="Vagrant y Puppet"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Vagrant y Puppet</a>
            <a href="/blog/como-funcionan-las-cosas/" class="next" rel="next" title="Cómo funcionan las cosas">Cómo funcionan las cosas<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Con la tecnología de <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.119.0">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://magmax.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":50},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-X5FEBMGR06', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-X5FEBMGR06" async></script></body>
</html>
