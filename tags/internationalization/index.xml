<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>internationalization on El blog de MagMax</title>
    <link>https://magmax.org/tags/internationalization/</link>
    <description>Recent content in internationalization on El blog de MagMax</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 26 May 2010 00:00:00 +0000</lastBuildDate><atom:link href="https://magmax.org/tags/internationalization/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Aplicaciones multilingües, gettext</title>
      <link>https://magmax.org/blog/aplicaciones-multilingues-gettext/</link>
      <pubDate>Wed, 26 May 2010 00:00:00 +0000</pubDate>
      
      <guid>https://magmax.org/blog/aplicaciones-multilingues-gettext/</guid>
      <description>
        
          &lt;p&gt;A menudo se piensa que una aplicación estaría mucho mejor si se encontrara en varios idiomas. Podemos pensar en distintas formas de soportar esto, pero otros ya lo han pensado por nosotros y han creado las fabulosas herramientas gettext. Este documento pretende ser una guía para el uso rápido (rápido de verdad) de estas herramientas.&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;figure&gt;
    &lt;img src=&#34;https://magmax.org/images/i18n.png&#34;
         alt=&#34;Internacionalización&#34;/&gt; 
&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;Notas&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Esta receta se publicó por primera vez en &lt;a href=&#34;http://crysol.org/es/node/203&#34;&gt;Crysol&lt;/a&gt;, pero a partir de ahora
estará aquí la última versión, si decido modificarla.&lt;/p&gt;
&lt;p&gt;Como yo fui el autor de la receta original, no estoy haciendo plagio :-D&lt;/p&gt;
&lt;h2 id=&#34;ingredientes&#34;&gt;Ingredientes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;gettext&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;modificaciones-en-el-código&#34;&gt;Modificaciones en el código&lt;/h2&gt;
&lt;p&gt;Lo primero es acordarse de evitar cadenas sin más (al menos las que se muestran)
en nuestro código. Ahora importaremos la librería gettext y utilizaremos la
función gettext. Se encuentra disponible para numerosos lenguajes, aunque aquí
se explicará con ejemplos en python (las diferencias serán mínimas en el resto
de lenguajes).&lt;/p&gt;
&lt;p&gt;En Python queda así:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gettext
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2&lt;/span&gt;gettext&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;textdomain(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;programita&amp;#34;&lt;/span&gt;)
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3&lt;/span&gt;gettext&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;bindtextdomain(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;programita&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./mo&amp;#34;&lt;/span&gt;)
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4&lt;/span&gt;gettext&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;gettext(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;hello, world!&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;No os asustéis: Las funciones &lt;code&gt;textdomain&lt;/code&gt; y &lt;code&gt;bindtextdomain&lt;/code&gt;
sirven para decirle a gettext dónde se encuentran las traducciones. Aquí se está
poniendo un ejemplo, así que sustituid &lt;code&gt;programita&lt;/code&gt; por el nombre de vuestro
programa, y &lt;code&gt;./mo&lt;/code&gt; por el directorio donde vamos a meter las traducciones.&lt;/p&gt;
&lt;p&gt;A menudo, además, se suele importar la función gettext cambiándole el nombre a
algo más sencillo como la barra baja. De esta manera, nos evitamos tener que
escribir &lt;code&gt;gettext.gettext&lt;/code&gt; cada vez. Para hacer esto hay distintas
maneras, una de ellas es durante la importación:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; gettext &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gettext &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; _
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;generación-de-la-plantilla-de-traducción-pot&#34;&gt;Generación de la plantilla de traducción (.pot)&lt;/h2&gt;
&lt;p&gt;Podemos obtener la plantilla del código en casi cualquier lenguaje: C, C++, Python, Perl, Glade, Java, &amp;hellip; Y se hace así:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;xgettext --language&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Python -j programita.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Las opciones son: &lt;code&gt;--language&lt;/code&gt; indicando el lenguaje del código, y &lt;code&gt;-j&lt;/code&gt; que
indica que, si hay ya un .pot existente, se deben mezclar los mensajes.&lt;/p&gt;
&lt;p&gt;Si hemos usado algún cambio y no aparece la función como &amp;ldquo;gettext&amp;rdquo;, será
necesario usar también la opción &lt;code&gt;--keyword&lt;/code&gt;. Por ejemplo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;xgettext --language&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Python -j -k _ programita.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ale, ya tenemos el messages.pot.&lt;/p&gt;
&lt;h2 id=&#34;generar-el-fichero-de-traducciones-po&#34;&gt;Generar el fichero de traducciones (*.po)&lt;/h2&gt;
&lt;p&gt;Ahora se utiliza el messages.pot para generar cada plantilla. Nosotros queremos
la traducción al castellano, así que será es.po:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;msginit -i messages.pot -o es.po
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ahora viene la parte en la que editamos el fichero es.po (yo suelo usar
gtranslator o kbabel) y demás.&lt;/p&gt;
&lt;h2 id=&#34;mezclar-el-fichero-de-traducciones-po-con-una-nueva-plantilla-pot&#34;&gt;Mezclar el fichero de traducciones (*.po) con una nueva plantilla (*.pot)&lt;/h2&gt;
&lt;p&gt;Este sistema sería poco eficiente si tuviéramos que traducirlo todo de nuevo
cada vez que se cambie el fuente. Por ello, hay un sistema por el que se mezcla
el fichero ya traducido con la plantilla nueva (es decir: volvemos al paso de
creación de plantilla y después ejecutamos esto):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;msgmerge -U es.po messages.pot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Y, nuevamente, volvemos a traducir :-D&lt;/p&gt;
&lt;h2 id=&#34;creación-del-fichero-de-equivalencias-mo&#34;&gt;Creación del fichero de equivalencias (*.mo)&lt;/h2&gt;
&lt;p&gt;Realmente, el ficherito &lt;code&gt;.po&lt;/code&gt; no se utiliza en el ejecutable. Es necesario
utilizar un ficherito &lt;code&gt;.mo&lt;/code&gt;. Aquí crearemos nuestro &lt;code&gt;es.mo&lt;/code&gt;, como es lógico:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;msgfmt es.po mo/es/LC_MESSAGES/programita.mo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Como podéis observar, el resultado lo dejamos en &lt;code&gt;mo/es/LC_MESSAGES/&lt;/code&gt;. Eso lo
hacemos así porque en el código fuente dijimos que las traducciones colgarían
del directorio &lt;code&gt;mo&lt;/code&gt;, el idioma es Español (las locales son &amp;ldquo;es&amp;rdquo;), y porque todos
los &lt;code&gt;.mo&lt;/code&gt; deben colgar de un directorio &lt;code&gt;LC_MESSAGES&lt;/code&gt; dentro de las locales para
que sea encontrado correctamente.&lt;/p&gt;
&lt;h2 id=&#34;utilización&#34;&gt;Utilización&lt;/h2&gt;
&lt;p&gt;Ya está. No hay nada más que contar. Si las locales son &lt;code&gt;es&lt;/code&gt;, escribirá nuestra
traducción, y si son &lt;code&gt;en&lt;/code&gt;, lo escribirá en inglés. Eso es todo.&lt;/p&gt;
&lt;h2 id=&#34;ejemplo&#34;&gt;Ejemplo&lt;/h2&gt;
&lt;p&gt;Veamos un ejemplo, &lt;a href=&#34;http://crysol.org/es/node/203#comment-4473&#34;&gt;sugerencia hecha por david.villa&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#!/usr/bin/python&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gettext
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5&lt;/span&gt;APP &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7&lt;/span&gt;gettext&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;textdomain ( APP )
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8&lt;/span&gt;gettext&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;bindtextdomain ( APP, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./mo&amp;#34;&lt;/span&gt; )
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10&lt;/span&gt;_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; gettext&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;gettext
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11&lt;/span&gt;
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; _(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;hello, world!&amp;#34;&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Como requisito, necesitaremos el directorio donde vamos adejar las cosas. En el
código hemos puesto &lt;code&gt;./mo&lt;/code&gt;, así que hay que ser consecuentes:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;mkdir -p  mo/es_ES/LC_MESSAGES
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ahora inicializamos (llamaremos al &lt;code&gt;.pot&lt;/code&gt; &amp;ldquo;messages.pot&amp;rdquo;):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;xgettext --language&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Python --keyword&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_ -o messages.pot hello.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Y generamos nuestro primer .po:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;$ msginit -i messages.pot -l es_ES
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Editamos el archivo es.po que se nos habrá creado, traduciendo la única cadena. Mi archivo pinta así:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-po&#34; data-lang=&#34;po&#34;&gt;# Spanish translations for PACKAGE package.
# Copyright (C) 2010 THE PACKAGE&#39;&#39;S COPYRIGHT HOLDER
# This file is distributed under the same license as the PACKAGE package.
# miguel &amp;lt;miguelangel.garcia@gmail.com&amp;gt;, 2010.
#
msgid &amp;quot;&amp;quot;
msgstr &amp;quot;&amp;quot;
&amp;quot;Project-Id-Version: PACKAGE VERSION\
&amp;quot;
&amp;quot;Report-Msgid-Bugs-To: \
&amp;quot;
&amp;quot;POT-Creation-Date: 2010-05-25 07:31+0200\
&amp;quot;
&amp;quot;PO-Revision-Date: 2010-05-25 07:32+0200\
&amp;quot;
&amp;quot;Last-Translator: miguel &amp;lt;miguelangel.garcia@gmail.com&amp;gt;\
&amp;quot;
&amp;quot;Language-Team: Spanish &amp;lt;&amp;gt;\
&amp;quot;
&amp;quot;MIME-Version: 1.0\
&amp;quot;
&amp;quot;Content-Type: text/plain; charset=ASCII\
&amp;quot;
&amp;quot;Content-Transfer-Encoding: 8bit\
&amp;quot;
&amp;quot;Plural-Forms: nplurals=2; plural=(n != 1);\
&amp;quot;

#: hello.py:12
msgid &amp;quot;hello, world!&amp;quot;
msgstr &amp;quot;hola, mundo!&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Por ahora no nos fijaremos mucho en las cosa que deberíamos cambiar, como el PACKAGE y demás. Sólo nos queda compilar:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;msgfmt -o mo/es_ES/LC_MESSAGES/hello.mo es.po
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;y probarlo:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1&lt;/span&gt;LANG&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;es_ES ./hello.py
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2&lt;/span&gt;hola, mundo!
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3&lt;/span&gt;LANG&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;en_US ./hello.py
&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4&lt;/span&gt;hello, world!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;¡¡Gracias, David, por tu propuesta!!&lt;/p&gt;
&lt;h2 id=&#34;referencias&#34;&gt;Referencias&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.gnu.org/software/gettext/manual/&#34;&gt;Manual de gettext&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.pipiten.com.ar/archives/7&#34;&gt;Traducir aplicaciones PyGTK/Glade&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

        
      </description>
    </item>
    
  </channel>
</rss>
