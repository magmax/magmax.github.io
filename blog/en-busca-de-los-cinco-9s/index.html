<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos - El blog de MagMax</title><meta name="Description" content="Traducción del artículo &#34;In search of five 9s: Calculating Availability of Complex Systems&#34;"><meta property="og:title" content="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos" />
<meta property="og:description" content="Traducción del artículo &#34;In search of five 9s: Calculating Availability of Complex Systems&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://magmax.org/blog/en-busca-de-los-cinco-9s/" />
<meta property="og:image" content="https://magmax.org/icons/favicon.png"/>
<meta property="article:published_time" content="2015-06-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-28T00:00:00+00:00" /><meta property="og:site_name" content="El blog de MagMax" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://magmax.org/icons/favicon.png"/>

<meta name="twitter:title" content="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos"/>
<meta name="twitter:description" content="Traducción del artículo &#34;In search of five 9s: Calculating Availability of Complex Systems&#34;"/>
<meta name="application-name" content="El blog de MagMax">
<meta name="apple-mobile-web-app-title" content="El blog de MagMax"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://magmax.org/blog/en-busca-de-los-cinco-9s/" /><link rel="prev" href="https://magmax.org/blog/peewee-un-orm-para-python/" /><link rel="next" href="https://magmax.org/blog/monitorizacion-y-alertado/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos",
        "inLanguage": "es",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/magmax.org\/blog\/en-busca-de-los-cinco-9s\/"
        },"genre": "posts","keywords": "devops, engineering","wordcount":  2633 ,
        "url": "https:\/\/magmax.org\/blog\/en-busca-de-los-cinco-9s\/","datePublished": "2015-06-13T00:00:00+00:00","dateModified": "2021-01-28T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Miguel Ángel"},"author": {
                "@type": "Person",
                "name": "Miguel Ángel"
            },"description": "Traducción del artículo \"In search of five 9s: Calculating Availability of Complex Systems\""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/"> Inicio </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/blog/en-busca-de-los-cinco-9s/" selected>Español</option></select>
                    </a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="El blog de MagMax"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/icons/favicon.png"
        data-srcset="/icons/favicon.png, /icons/favicon.png 1.5x, /icons/favicon.png 2x"
        data-sizes="auto"
        alt="/icons/favicon.png"
        title="/icons/favicon.png" />MagMax Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/" title="">Inicio</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Cambia el tema">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Selecciona el lenguage">Español<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/blog/en-busca-de-los-cinco-9s/" selected>Español</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contenido</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Miguel Ángel</a></span>&nbsp;<span class="post-category">incluido en <a href="/categories/translations/"><i class="far fa-folder fa-fw"></i>translations</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="13 Jun 2015">13 Jun 2015</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2633 palabras&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;13 minutos&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contenido</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#disponibilidad-y-sla">Disponibilidad y SLA</a></li>
    <li><a href="#sistemas-compuestos">Sistemas compuestos</a>
      <ul>
        <li><a href="#ejemplo">Ejemplo</a></li>
      </ul>
    </li>
    <li><a href="#mejorar-la-disponibilidad">Mejorar la disponibilidad</a>
      <ul>
        <li><a href="#ejemplo-1">Ejemplo</a></li>
        <li><a href="#generalizando-la-fórmula">Generalizando la fórmula</a></li>
        <li><a href="#ejemplo-2">Ejemplo</a></li>
      </ul>
    </li>
    <li><a href="#redundando-el-cpd">Redundando el CPD</a>
      <ul>
        <li><a href="#excel">Excel</a></li>
      </ul>
    </li>
    <li><a href="#conclusión">Conclusión</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>Este artículo es la traducción del artículo <a href="https://www.edgeblog.net/2007/in-search-of-five-9s/" target="_blank" rel="noopener noreffer">In search of five 9s: Calculating
Availability of Complex Systems</a>, publicado por Bill el 29 de Octubre de 2007.
Dado que el artículo original tiene demasiado texto, me he visto obligado a
modificar la maquetación y añadir títulos.</p>
<p>Puede parecer un poco largo, pero es realmente interesante. Aunque tiene muchas
fórmulas es sencillo de entender, gracias a los ejemplos.</p>
<p>Y he elegido este artículo porque con el <strong>cloud</strong> que está tan de moda resulta
sencillo y relativamente barato redundar máquinas.</p>
<p>Además, éste es el tipo de artículos que realmente me hacen sentir como Ingeniero.</p>
<hr>
<figure>
    <img src="/images/uptime.jpg"
         alt="Uptime"/> 
</figure>

<h2 id="disponibilidad-y-sla">Disponibilidad y SLA</h2>
<p>He pasado los últimos días tratando de desarrollar un modelo matemático simple para predecir la disponibilidad esperada en sistemas complejos. En IT se nos suele pedir que desarrollemos y cumplamos acuerdos de nivel de servicio
(<abbr title="Acuerdos de Nivel de Servicio o Server Level Agreements">SLAs</abbr>
).
Si no se analizan los puntos de fallo de un sistema, y después se calcula la
disponibilidad del sistema, el
(<abbr title="Acuerdo de Nivel de Servicio o Server Level Agreement">SLA</abbr>
).
es defectuoso desde el principio. Para
complicar aún más las cosas, diferentes personas tienen diferentes definiciones
de disponibilidad. Por ejemplo: ¿cuenta un <em>downtime</em> planificado de
mantenimiento en sus cálculos de disponibilidad del sistema?</p>
<p>Definiciones de Disponibilidad Comunes:</p>
<ol>
<li>
<p>Disponibilidad =
<abbr title="Media del tiempo entre fallos">MTBF</abbr>
 / (
<abbr title="Media del tiempo de recuperación">MTTR</abbr>
 +
<abbr title="Media del tiempo entre fallos">MTBF</abbr>

). Ésta es una definición clásica de disponibilidad y es frecuentemente usada por fabricantes de hardware cuando publican una métrica de disponibilidad para un determinado servidor.</p>
</li>
<li>
<p>Disponibilidad = (Uptime + Scheduled Maintenance)/(Unscheduled Downtime + Uptime + Scheduled Maintenance). Consiste en una métrica centrada en IT donde el negocio puede permitirse <em>downtimes</em> durante horas. Este modelo funciona para determinados sistemas, como un servidor de ficheros que no se necesita durante la noche, pero no funciona bien para servicios web, a pesar de que muchas compañías aún lo usan para sus
<abbr title="SLAs (Acuerdos de Nivel de Servicio o Server Level Agreement)">SLAs</abbr>
.</p>
</li>
<li>
<p>Disponibilidad = Uptime/(Uptime + Downtime). Es la métrica que mejor aplica para servicios que se necesitan 24x7, como sitios de comercio electrónico.</p>
</li>
</ol>
<p>Normalmente se expresa la disponibilidad como un porcentaje. En ocasiones, la gente hace referencia a los <em>&ldquo;cuatro nueves&rdquo;</em> (99.99%) o los <em>&ldquo;cinco nueves&rdquo;</em> (99.999%). Para simplificar las cosas, en la siguiente tabla se muestran los minutos de <em>downtime</em> al año permitidos para un nivel determinado:</p>
<table>
<thead>
<tr>
<th>Disponiblidad</th>
<th>Min Downtime/Año</th>
<th>HorasDowntime/Año</th>
</tr>
</thead>
<tbody>
<tr>
<td>95.000%</td>
<td>26,298</td>
<td>438</td>
</tr>
<tr>
<td>98.000%</td>
<td>10,519</td>
<td>175</td>
</tr>
<tr>
<td>98.500%</td>
<td>7,889</td>
<td>131</td>
</tr>
<tr>
<td>99.000%</td>
<td>5,260</td>
<td>88</td>
</tr>
<tr>
<td>99.500%</td>
<td>2,630</td>
<td>44</td>
</tr>
<tr>
<td>99.900%</td>
<td>526</td>
<td>8.8</td>
</tr>
<tr>
<td>99.990%</td>
<td>52.6</td>
<td>.88</td>
</tr>
<tr>
<td>99.999%</td>
<td>5.26</td>
<td>.088</td>
</tr>
</tbody>
</table>
<p>Basándose en la tabla anterior, se puede comprobar que hay una gran diferencia entre un
<abbr title="Acuerdo de Nivel de Servicio o Server Level Agreement">SLA</abbr>

que especifique  un 99% de disponibilidad (88 horas de <em>downtime</em> al año) y 99.9% de disponibilidad (8.8 horas de <em>downtime</em> al año). Pero ¿cómo se puede estar seguro de cuál es el <em>downtime</em> esperado de un sistema? En su form más simplista, la disponibilidad esperada de un sistema es la disponibilidad esperada de cada una de sus partes multiplicadas entre sí. De esta manera, si el sistema tiene dos servidores, y cada servidor tiene una disponibilidad esperada del 99%, entonces la disponibilidad del sistema sería \(99\% * 99\% = 98.01\%\). Nota: He usado la expresión &ldquo;disponibilidad esperada&rdquo;. Estamos calculando el futuro esperado de un sistema sobre un periodo de tiempo, no la disponibilidad histórica. Para el resto de este artículo, eliminaré el término &ldquo;esperada&rdquo; por brevedad, pero está siempre implícito.</p>
<h2 id="sistemas-compuestos">Sistemas compuestos</h2>
<p>El modelo simplista de más arriba es útil para mostrar que el <em>downtime</em> es acumulativo. En otras palabras, si se espera que un componente esté fuera de línea 88 horas/año, y un fallo de cualquier componente es un fallo del sistema, entonces el sistema tiene un <em>downtime</em> esperado de 174 horas. ¿Por qué no 176 horas? Bueno, ocasionalmente ambos componentes estarán caídos al mismo tiempo.</p>
<p>Los sistemas del mundo real nunca son tan simples. Típicamente el sistema estará compuesto de múltiples componentes, con redundancia, y cada uno con distinto nivel de disponibilidad por componente. Modelar esto requiere fórmulas algo más complicadas, pero en cuanto se tengan claros los conceptos, los nuevos cálculos pueden hacerse rápidamente en una hoja Excel. Antes de continuar necesitamos algo de notación básica para simplificar nuestras fórmulas:</p>
<ul>
<li>Disponibilidad del componente 1: \(Ac_1\)</li>
<li>Disponibilidad del componente 2: \(Ac_2\)</li>
<li>Disponibilidad del componente 3: \(Ac_3\)</li>
<li>Disponibilidad del componente N: \(Ac_N\)</li>
<li>Sistema de disponibilidad: \(As\)</li>
</ul>
<p>Y dicho esto, estamos listos para nuestra primera fórmula. Cuando un sistema está constituído por N componentes que son puntos únicos de fallo, la disponibilidad del sistema se puede calcular como:</p>
<p>$$
As = Ac_1 * Ac_2 * Ac_3 * &hellip; Ac_n
$$</p>
<h3 id="ejemplo">Ejemplo</h3>
<p>Consideremos un sitio de comercio electrónico 24x7 con muchos puntos únicos de fallo. Se podría modelar el sistema con los 8 componentes siguientes:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Availability</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web</td>
<td>85%</td>
</tr>
<tr>
<td>Application</td>
<td>90%</td>
</tr>
<tr>
<td>Database</td>
<td>99.9%</td>
</tr>
<tr>
<td>DNS</td>
<td>98%</td>
</tr>
<tr>
<td>Firewall</td>
<td>85%</td>
</tr>
<tr>
<td>Switch</td>
<td>99%</td>
</tr>
<tr>
<td>Data Center</td>
<td>99.99%</td>
</tr>
<tr>
<td>ISP</td>
<td>95%</td>
</tr>
</tbody>
</table>
<p>Si cualquiera de estos componentes falla, el sistema caerá. La disponibilidad esperada del sistema sería \(85\%*90\%*99.9\%*98\%*85\%*99\%*99.99\%*95\% = 59.87\%\). Nótese que se modela cada componente como un todo, en lugar de mirar cada una de sus partes. Se podría dividir el servicio web en el software (Apache), el código (nuestra web) y el hardware (placa base, discos duros, etc). Para nuestros propósitos, la complejidad no mejora necesariamente el modelo, así que trabajaremos con el servicio como un todo. Además, para esta discusión se utilizará la tercera definición de disponibilidad de arriba. Para nuestros usuarios, no importa si el sistema está caído por mantenimiento o por un disco duro roto.</p>
<h2 id="mejorar-la-disponibilidad">Mejorar la disponibilidad</h2>
<p>Si queremos conservar nuestros trabajos, necesitamos encontrar una manera de mejorar esta disponibilidad. Los objetivos obvios para mejorar la estabilidad del sitio son la web y el firewall. La pregunta es qué efecto tendría en la disponibilidad de la web añadir otro servidor. Con esto llegamos a la segunda ecuación. Cuando un sistema está compuesto por dos componentes redundantes, la disponibilidad del sistema se puede calcular como:</p>
<p>$$
As = Ac_1 + ((1 – Ac_1) * Ac_2)
$$</p>
<h3 id="ejemplo-1">Ejemplo</h3>
<p>Usando nuestro ejemplo del servidor web con disponibilidad de 85%, añadir un segundo servidor incrementaría la disponibilidad a \(85\% + (1-85\%)*85\% = 97.75\%\). La lógica detrás de esto es que mientras el primer servidor está caído (15% del tiempo) el segundo servidor estará arriba el 85% del tiempo. Esto podría traducirse o no a la disponibilidad en el mundo real. Por ejemplo, si el servicio web está caído tan a menudo porque necesitamos desplegar nuestro código constantemente, añadir un segundo servidor debería traducirse en un incremento de la disponibilidad, ya que se puede desplegar código en el servidor fuera de línea mientras el otro servidor continúa funcionando. En este caso, el incremento de nuestra disponibilidad real debería ser mayor del 12.75%. En caso contrario, si el servicio se cae por errores de código, añadir un segundo servidor podría empeorar la disponibilidad debido al desesperante error.</p>
<p>La idea es que, en general, si has calculado rigurosamente la disponibilidad del componente, la ecuación funcionará. Nótese que la ecuación funcionará igualmente si los componentes tienen distinta estimación de disponibilidad. Supongamos que el servidor web tiene un problema de disponibilidad porque el hardware está subdimensionado. Ahora supongamos que el segundo servidor que hemos comprado tiene el doble de capacidad y determinamos que por sí mismo daría una disponibilidad del 90%, por lo que la ecuación cambia a \(85\% + (1-85\%)*90\% = 98.5\%\).</p>
<p>Volvamos al cálculo del sistema anterior y añadamos esto. Asumiendo que se ha añadido un segundo servidor web y un segundo firewall, incrementando la disponibilidad de estos componentes del sistema a 97.75%. Ahora la disponibilidad de nuestro nuevo sistema sería \(97.75\%*90\%*99.9\%*98\%*97.75\%*99\%*99.99\%*95\% = 79.10\%\). Mejor, pero aún no es buena. Es difícil conseguir cualquier nivel de alta disponibilidad cuando se tienen puntos únicos de fallo. Así que asumamos que añadimos componentes redundantes en todos nuestros servidores y equipos de red. Asumamos un segundo ISP para diversificar el transporte, pero aún estamos en un único
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>
.
Nuestra ecuación sería ahora: \(97.75\%*99\%*99.9999\%*99.96\%*97.75\%*99.99\%*99.99\%*99.75\% = 94.3\%\). Mejorando. Eliminando los puntos únicos de fallo se mejoró la disponibilidad del sistema del 60% (3506 horas de downtime/año) a 94.3% (500 horas de downtime/año).</p>
<h3 id="generalizando-la-fórmula">Generalizando la fórmula</h3>
<p>La ecuación #2 de más arriba modelaba cómo añadir un único componente. En algunos casos es necesario añadir más de un componente redundante. Por ejemplo, se podrían tener más de dos servidores web. En este caso es necesario iterar la ecuación #2 varias veces para agrupar el efecto de los componentes adicionales, lo que implica una tercera ecuación. Cuando se intenta calcular la disponibilidad de un servicio con n componentes redundantes, se calcula:</p>
<p>$$
As = Ac_{n-1} + ((1 – Ac_{n-1}) * Ac_n)
$$</p>
<h3 id="ejemplo-2">Ejemplo</h3>
<p>En el caso de nuestro servidor web, añadir un tercer servidor cambia la disponibilidad a: \(97.75\% + (1-97.75\%)*85\% = 99.6625\%\). Añadiendo un cuarto servidor incrementaría la disponibilidad a: \(99.6625\% + (1-99.6625\%)*85\% = 99.949\%\). Nótese que hay una disminución de ganancia. Añadiendo el segundo servidor incrementó la disponibilidad en un 12.75%. Añadir el tercero sólo hizo ganar 1.9125%. El cuarto servidor nos da un insignificante .2865%. E incluso con 3 servidores más para distribuir nuestra carga, aún no se han conseguido los elusivos cuatro nueves de disponibilidad. Diseñar un sistema altamente disponible requiere que cada componente individual sea altamente disponible Y añadir redundancia en los componentes. Si el servidor web individual de nuestro sistema tuviera una disponibilidad del 90% en lugar del 85%, entonces la disponibilidad de los dos servidores sería del 99% y los tres servidores tendrían un 99.99%.</p>
<p>Las ecuaciones #2 y #3 tienen un defecto, ya que asumen que cada componente independiente puede manejar la carga, y que la carga es constante. ¿Qué ocurre si bajo operativa normal un servidor web puede manejar la carga, pero en pico se necesitan tres servidores? En ese caso la disponibilidad de los tres servidores en carga normal sería de 99.775%, mientras que en pico bajaría hasta el 85%. En un pico de carga, la caída de uno de los servidores podría significar una pérdida de servicio, por lo que se transforma a la disponibilidad de una única caja. ¿Y si el pico de carga requiere 2 servidores? En este caso la disponibilidad en pico sería del 97.75%. Si el pico require dos servidores y tenemos tres, la disponibilidad sería equivalente a tener dos servidores. El concepto importante aquí es que <strong>hay una relación inversa entre la carga y la disponibilidad</strong>.</p>
<h2 id="redundando-el-cpd">Redundando el CPD</h2>
<p>Debería ser obvio a estas alturas unos verdaderos altos niveles de disponibilidad (99.9% - 99.999%) es muy difícil y muy caro. Uno de los puntos únicos de fallo más caros a eliminar es el propio
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>
.
En la mayoría de los casos, doblará el coste de la infraestructura, e incluso podría ser más del doble, ya que será necesario invertir en tecnologías para sincronizar ambos
<abbr title="Centros de Proceso de Datos, o DataCenters">CPDs</abbr>
.</p>
<p>De todas formas consideremos añadir un nuevo
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>
.
En el ejemplo de arriba, la disponibilidad de nuestro sistema con servidores e
ISPs redundantes era del 94.3%. Añadir un segundo
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>

con la tecnología
necesaria para permitir que ambos trabajen de forma activo-activo (ambos centros
reciben tráfico al mismo tiempo) incrementaría nuestra disponibilidad a
\(94.3\% + (1-94.3\%)*94.3\% = 99.675\%\). ¡Añadir un nuevo
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>

puede ahorrar hasta 471 horas de downtime al año!</p>
<p>En este ejemplo se asume que cada
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>

es un sistema independiente, por lo que el fallo de un sistema en un
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>

sería un fallo de todo el sistema en ese centro. No siempre es así. Por ejemplo,
si se diseña correctamente, un servidor web podría conectarse a la base de datos
del otro
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>
.
En este caso la disponibilidad sería mayor del 99.675%. Si se pudiera diseñar el
<em>site</em> de manera que cada sistema operara de forma independiente al resto de
servicios, la disponibilidad en el ejemplo se incrementaría del 99.675% al
99.888% (cada servicio tendría 3 componentes redundantes, excepto el
<abbr title="Centro de Proceso de Datos, o DataCenter">CPD</abbr>

que sólo tendría uno).</p>
<h3 id="excel">Excel</h3>
<p>Estas fórmulas son mucho más sencillas de mostrar en Excel. Pegue la siguiente tabla en una hoja de cálculo, comenzando en la casilla A1:</p>
<table>
<thead>
<tr>
<th>Avail %</th>
<th>1 Component</th>
<th>2 Components</th>
<th>3 Components</th>
<th>4 Components</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web</td>
<td>85%</td>
<td>=B2+((1-B2)*$B2)</td>
<td>=C2+((1-C2)*$B2)</td>
<td>=D2+((1-D2)*$B2)</td>
</tr>
<tr>
<td>Application</td>
<td>90%</td>
<td>=B3+((1-B3)*$B3)</td>
<td>=C3+((1-C3)*$B3)</td>
<td>=D3+((1-D3)*$B3)</td>
</tr>
<tr>
<td>Database</td>
<td>99.9%</td>
<td>=B4+((1-B4)*$B4)</td>
<td>=C4+((1-C4)*$B4)</td>
<td>=D4+((1-D4)*$B4)</td>
</tr>
<tr>
<td>DNS</td>
<td>98%</td>
<td>=B5+((1-B5)*$B5)</td>
<td>=C5+((1-C5)*$B5)</td>
<td>=D5+((1-D5)*$B5)</td>
</tr>
<tr>
<td>Firewall</td>
<td>85%</td>
<td>=B6+((1-B6)*$B6)</td>
<td>=C6+((1-C6)*$B6)</td>
<td>=D6+((1-D6)*$B6)</td>
</tr>
<tr>
<td>Switch</td>
<td>99%</td>
<td>=B7+((1-B7)*$B7)</td>
<td>=C7+((1-C7)*$B7)</td>
<td>=D7+((1-D7)*$B7)</td>
</tr>
<tr>
<td>Data Center</td>
<td>99.99%</td>
<td>?</td>
<td>=B8+((1-B8)*$B8)</td>
<td>?</td>
</tr>
<tr>
<td>ISP</td>
<td>95%</td>
<td>=B9+((1-B9)*$B9)</td>
<td>=C9+((1-C9)*$B9)</td>
<td>=D9+((1-D9)*$B9)</td>
</tr>
<tr>
<td>System Avail %</td>
<td>=b2<em>b3</em>b4<em>b5</em>b6<em>b7</em>b8*b9</td>
<td>=c2<em>c3</em>c4<em>c5</em>c6<em>c7</em>b8*c9</td>
<td>=d2<em>d3</em>d4<em>d5</em>d6<em>d7</em>d8*d9</td>
<td>=e2<em>e3</em>e4<em>e5</em>e6<em>e7</em>d8*e9</td>
</tr>
</tbody>
</table>
<p>Ahora que tiene los conceptos claros y el principio de una hoja de cálculo para calcular los cambios de premisas, se puede centrar en aplicar estas teorías a su situación particular. Comenzando por descomponer su sistema, sea una web simple, un sistema de contabilidad o un sistema de ficheros, en servicios de componentes independientes. Para cada servicio, determine el número mínimo de unidades necesarias para trabajar, y la disponibilidad necesaria de cada unidad.</p>
<p>Estimar la disponibilidad puede ser un reto. Una manera es mirar datos históricos. Si no se tiene acceso a buenos datos, se puede formar una estimación basada en los parámetros de su operativa estándar. Por ejemplo, si se despliega código nuevo del servicio web dos veces al mes y cada una causa un <em>downtime</em> de 2 horas, se traduce en 48 horas de parada al año. Si se espera realizar labores de mantenimiento del sistema operativo una vez por trimestre, con un <em>downtime</em> estimado de 2 horas por trimestre, serían otras 8 horas más al año. Si además se anticipa a un fallo hardware al año, con garantía de entrega el siguiente día hábil, se traduciría en 41 horas de <em>downtime</em> al año (fallos en viernes se repararían el lunes, los sábados y domingos en martes). Sumando estos números obtenemos \(48 + 8 + 41 = 98\) horas de <em>downtime</em> al año, o una disponibilidad estimada del 98.882%.</p>
<p>Con un poco de esfuerzo, se puede estimar un nivel de disponibilidad realista
para su sistema. Éste es el pilar para crear
<abbr title="Acuerdos de Nivel de Servicio o Server Level Agreements">SLAs</abbr>

realistas y cumplibles. Estas fórmulas pueden ayudar a IT a negociar los
<abbr title="Acuerdos de Nivel de Servicio o Server Level Agreements">SLAs</abbr>

con negocio, y puede ayudar a comparar el
<abbr title="Retorno Sobre la Inversión">RSI</abbr>

de diferentes soluciones. Por ejemplo, digamos que se está
intentando elegir una solución para el servidor web, y se tienen dos elecciones:</p>
<ul>
<li>La opción 1 consiste en 4 servidores usando hardware barato sin redundancia interna. Cada servidor cuesta 3.000 €. Estimamos la disponibilidad en un 75%.</li>
<li>La opción 2 consiste en 2 servidores usando hardware caro con discos duros y fuentes de alimentación redundantes. Cada servidor cuesta 20.000 €. Estimas la disponibilidad de cada servidor en un 99%.</li>
</ul>
<p>Se estima que el coste por <em>downtime</em> es de 500€/hora, y se espera que estos servidores aguanten la carga del sistema los próximos 3 años, tras los cuales se reemplazarán. Usando los números de arriba, la solución #1 tiene una disponibilidad esperada del 99.6% a un coste de 12.000€. La solución #2 tiene una disponibilidad esperada del 99.99%, a un coste de $40.000€. La solución #1 experimentaría 34 horas/año, o 102 horas en los tres años, de <em>downtime</em> más que la solución #2. En tres años, este <em>downtime</em> extra costaría $51.000€. Por lo que el gasto de 28.000€ previo proporcionará un
<abbr title="Retorno Sobre la Inversión">RSI</abbr>

en 3 años del 182%. Nótese que el modelo es tan bueno como lo sean las estimaciones. Si los servidores de la solución #2 sólo tuvieran el 95% de disponibilidad, la disponibilidad combinada sería del 99.75%, lo que sólo proporciona 13 horas menos de <em>downtime</em> anual. En este caso sólo se ahorrarían 20,000€ en los 3 años por la inversión de 28.000€, por lo que podría ser mejor la opción #1.</p>
<h2 id="conclusión">Conclusión</h2>
<p>Diseñar y operar sistemas de alta disponibilidad es un trabajo complicado, pero con unas pocas fórmulas sencillas, es posible entender y predecir su comportamiento general. Esto permitirá realizar mejores decisiones al elegir entre múltiples opciones, y hacer predicciones más realistas a la hora de negociar los
<abbr title="Acuerdos de Nivel de Servicio o Server Level Agreement">SLAs</abbr>
.</p>
<hr>
<p><strong>Artículo original</strong>: <a href="https://www.edgeblog.net/2007/in-search-of-five-9s/" target="_blank" rel="noopener noreffer">In search of five 9s: Calculating Availability of Complex Systems</a></p>
<p><a href="https://magmax.org/blog/en-busca-de-los-cinco-9s/" rel="">Traducido por Miguel Ángel García</a>.</p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Actualizado el 28 Jan 2021</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Compartir en Twitter" data-sharer="twitter" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/" data-title="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos" data-hashtags="devops,engineering"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Facebook" data-sharer="facebook" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/" data-hashtag="devops"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Linkedin" data-sharer="linkedin" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en WhatsApp" data-sharer="whatsapp" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/" data-title="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Tumblr" data-sharer="tumblr" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/" data-title="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos" data-caption="Traducción del artículo &#34;In search of five 9s: Calculating Availability of Complex Systems&#34;" data-tags="devops,engineering"><i class="fab fa-tumblr fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Reddit" data-sharer="reddit" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Instapaper" data-sharer="instapaper" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/" data-title="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos" data-description="Traducción del artículo &#34;In search of five 9s: Calculating Availability of Complex Systems&#34;"><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Compartir en Digg" data-sharer="digg" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/"><i class="fab fa-digg fa-fw"></i></a><a href="javascript:void(0);" title="Compartir en Blogger" data-sharer="blogger" data-url="https://magmax.org/blog/en-busca-de-los-cinco-9s/" data-title="En busca de los cinco 9s: Calculando la disponibilidad de sistemas complejos" data-description="Traducción del artículo &#34;In search of five 9s: Calculating Availability of Complex Systems&#34;"><i class="fab fa-blogger fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/devops/">devops</a>,&nbsp;<a href="/tags/engineering/">engineering</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Regresar</a></span>&nbsp;|&nbsp;<span><a href="/">Inicio</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/peewee-un-orm-para-python/" class="prev" rel="prev" title="Peewee, un ORM para Python"><i class="fas fa-angle-left fa-fw"></i>Peewee, un ORM para Python</a>
            <a href="/blog/monitorizacion-y-alertado/" class="next" rel="next" title="Monitorización y alertado">Monitorización y alertado<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Provisto por <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.1">Hugo</a> | Tema - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Miguel Ángel</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Volver arriba">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="Ver comentarios">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copiar al portapapeles","maxShownLines":10},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-9308241-3', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-9308241-3" async></script></body>
</html>
